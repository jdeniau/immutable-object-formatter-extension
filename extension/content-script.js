var s = document.createElement('script');
// If we load the script with s.src="bundle.js" other code may run on the page before our the devtoolsFormatters are installed
// In that case the ImmutableJS objects would appear unformatted
s.textContent = decodeURI("function%20_arrayLikeToArray(r,%20a)%20%7B%0A%20%20(null%20==%20a%20%7C%7C%20a%20%3E%20r.length)%20&&%20(a%20=%20r.length);%0A%20%20for%20(var%20e%20=%200,%20n%20=%20Array(a);%20e%20%3C%20a;%20e++)%20n%5Be%5D%20=%20r%5Be%5D;%0A%20%20return%20n;%0A%7D%0Afunction%20_arrayWithoutHoles(r)%20%7B%0A%20%20if%20(Array.isArray(r))%20return%20_arrayLikeToArray(r);%0A%7D%0Afunction%20_iterableToArray(r)%20%7B%0A%20%20if%20(%22undefined%22%20!=%20typeof%20Symbol%20&&%20null%20!=%20r%5BSymbol.iterator%5D%20%7C%7C%20null%20!=%20r%5B%22@@iterator%22%5D)%20return%20Array.from(r);%0A%7D%0Afunction%20_nonIterableSpread()%20%7B%0A%20%20throw%20new%20TypeError(%22Invalid%20attempt%20to%20spread%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable,%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D()%20method.%22);%0A%7D%0Afunction%20_toConsumableArray(r)%20%7B%0A%20%20return%20_arrayWithoutHoles(r)%20%7C%7C%20_iterableToArray(r)%20%7C%7C%20_unsupportedIterableToArray(r)%20%7C%7C%20_nonIterableSpread();%0A%7D%0Afunction%20_unsupportedIterableToArray(r,%20a)%20%7B%0A%20%20if%20(r)%20%7B%0A%20%20%20%20if%20(%22string%22%20==%20typeof%20r)%20return%20_arrayLikeToArray(r,%20a);%0A%20%20%20%20var%20t%20=%20%7B%7D.toString.call(r).slice(8,%20-1);%0A%20%20%20%20return%20%22Object%22%20===%20t%20&&%20r.constructor%20&&%20(t%20=%20r.constructor.name),%20%22Map%22%20===%20t%20%7C%7C%20%22Set%22%20===%20t%20?%20Array.from(r)%20:%20%22Arguments%22%20===%20t%20%7C%7C%20/%5E(?:Ui%7CI)nt(?:8%7C16%7C32)(?:Clamped)?Array$/.test(t)%20?%20_arrayLikeToArray(r,%20a)%20:%20void%200;%0A%20%20%7D%0A%7D%0Avar%20orange%20=%20'light-dark(rgb(232,98,0),%20rgb(255,%20150,%2050))';%0Avar%20purple%20=%20'light-dark(%20#881391,%20#D48CE6)';%0Avar%20gray%20=%20'light-dark(rgb(119,119,119),%20rgb(201,%20201,%20201))';%0Avar%20listStyle%20=%20%7B%0A%20%20style:%20'list-style-type:%20none;%20padding:%200;%20margin:%200%200%200%2012px;%20font-style:%20normal;%20position:%20relative'%0A%7D;%0Avar%20immutableNameStyle%20=%20%7B%0A%20%20style:%20%22color:%20%22.concat(orange,%20%22;%20position:%20relative%22)%0A%7D;%0Avar%20keyStyle%20=%20%7B%0A%20%20style:%20%22color:%20%22.concat(purple)%0A%7D;%0Avar%20defaultValueKeyStyle%20=%20%7B%0A%20%20style:%20%22color:%20%22.concat(gray)%0A%7D;%0Avar%20alteredValueKeyStyle%20=%20%7B%0A%20%20style:%20%22color:%20%22.concat(purple,%20%22;%20font-weight:%20bolder%22)%0A%7D;%0Avar%20inlineValuesStyle%20=%20%7B%0A%20%20style:%20%22color:%20%22.concat(gray,%20%22;%20font-style:%20italic;%20position:%20relative%22)%0A%7D;%0Avar%20nullStyle%20=%20%7B%0A%20%20style:%20%22color:%20%22.concat(gray)%0A%7D;%0Afunction%20createFormatter(Immutable)%20%7B%0A%20%20var%20isRecord%20=%20function%20isRecord(maybeRecord)%20%7B%0A%20%20%20%20if%20(maybeRecord%20&&%20maybeRecord._values%20===%20undefined%20//%20in%20v3%20record%0A%20%20%20%20&&%20maybeRecord._map%20===%20undefined%20//%20in%20v4%20record%0A%20%20%20%20)%20%7B%0A%20%20%20%20%20%20//%20don't%20detect%20Immutable.Record.prototype%20as%20a%20Record%20instance%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%20%20%20%20//%20Immutable%20v4%0A%20%20%20%20if%20(maybeRecord%5B'@@__IMMUTABLE_RECORD__@@'%5D)%20%7B%0A%20%20%20%20%20%20//%20There's%20also%20a%20Immutable.Record.isRecord%20we%20could%20use,%20but%20then%20the%0A%20%20%20%20%20%20//%20Immutable%20instance%20passed%20into%20createFormatter%20has%20to%20be%20the%20same%0A%20%20%20%20%20%20//%20version%20as%20the%20one%20used%20to%20create%20the%20Immutable%20object.%0A%20%20%20%20%20%20//%20That's%20especially%20a%20problem%20for%20the%20Chrome%20extension.%0A%20%20%20%20%20%20return%20true;%0A%20%20%20%20%7D%0A%20%20%20%20//%20Immutable%20v3%0A%20%20%20%20return%20!!(maybeRecord%5B'@@__IMMUTABLE_KEYED__@@'%5D%20&&%20maybeRecord%5B'@@__IMMUTABLE_ITERABLE__@@'%5D%20&&%20maybeRecord._defaultValues%20!==%20undefined);%0A%20%20%7D;%0A%20%20var%20reference%20=%20function%20reference(object,%20config)%20%7B%0A%20%20%20%20if%20(typeof%20object%20===%20'undefined')%20return%20%5B'span',%20nullStyle,%20'undefined'%5D;else%20if%20(object%20===%20null)%20return%20%5B'span',%20nullStyle,%20'null'%5D;%0A%20%20%20%20return%20%5B'object',%20%7B%0A%20%20%20%20%20%20object:%20object,%0A%20%20%20%20%20%20config:%20config%0A%20%20%20%20%7D%5D;%0A%20%20%7D;%0A%20%20var%20renderIterableHeader%20=%20function%20renderIterableHeader(iterable)%20%7B%0A%20%20%20%20var%20name%20=%20arguments.length%20%3E%201%20&&%20arguments%5B1%5D%20!==%20undefined%20?%20arguments%5B1%5D%20:%20'Iterable';%0A%20%20%20%20return%20%5B'span',%20%5B'span',%20immutableNameStyle,%20name%5D,%20%5B'span',%20%22%5B%22.concat(iterable.size,%20%22%5D%22)%5D%5D;%0A%20%20%7D;%0A%20%20var%20getKeySeq%20=%20function%20getKeySeq(collection)%20%7B%0A%20%20%20%20return%20collection.toSeq().map(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20return%20k;%0A%20%20%20%20%7D).toIndexedSeq();%0A%20%20%7D;%0A%20%20var%20hasBody%20=%20function%20hasBody(collection,%20config)%20%7B%0A%20%20%20%20return%20getKeySeq(collection).size%20%3E%200%20&&%20!(config%20&&%20config.noPreview);%0A%20%20%7D;%0A%20%20var%20renderIterableBody%20=%20function%20renderIterableBody(collection,%20mapper)%20%7B%0A%20%20%20%20var%20options%20=%20arguments.length%20%3E%202%20&&%20arguments%5B2%5D%20!==%20undefined%20?%20arguments%5B2%5D%20:%20%7B%7D;%0A%20%20%20%20if%20(options.sorted)%20%7B%0A%20%20%20%20%20%20collection%20=%20collection.sortBy(function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20%20%20return%20key;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%20%20var%20children%20=%20collection.map(mapper).toList();%0A%20%20%20%20var%20jsList%20=%20%5B%5D;%0A%20%20%20%20//%20Can't%20just%20call%20toJS%20because%20that%20will%20also%20call%20toJS%20on%20children%20inside%20the%20list%0A%20%20%20%20children.forEach(function%20(child)%20%7B%0A%20%20%20%20%20%20return%20jsList.push(child);%0A%20%20%20%20%7D);%0A%20%20%20%20return%20%5B'ol',%20listStyle%5D.concat(_toConsumableArray(children));%0A%20%20%7D;%0A%20%20var%20RecordFormatter%20=%20%7B%0A%20%20%20%20header:%20function%20header(record,%20config)%20%7B%0A%20%20%20%20%20%20if%20(!isRecord(record))%20return%20null;%0A%20%20%20%20%20%20var%20defaults%20=%20record.clear();%0A%20%20%20%20%20%20var%20changed%20=%20!Immutable.is(defaults,%20record);%0A%20%20%20%20%20%20if%20(config%20&&%20config.noPreview)%20return%20%5B'span',%20changed%20?%20immutableNameStyle%20:%20nullStyle,%20record._name%20%7C%7C%20record.constructor.name%20%7C%7C%20'Record'%5D;%0A%20%20%20%20%20%20var%20inlinePreview;%0A%20%20%20%20%20%20if%20(!changed)%20%7B%0A%20%20%20%20%20%20%20%20inlinePreview%20=%20%5B'span',%20inlineValuesStyle,%20'%7B%7D'%5D;%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20var%20preview%20=%20getKeySeq(record).reduce(function%20(preview,%20key)%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20(Immutable.is(defaults.get(key),%20record.get(key)))%20return%20preview;%0A%20%20%20%20%20%20%20%20%20%20if%20(preview.length)%20preview.push(',%20');%0A%20%20%20%20%20%20%20%20%20%20preview.push(%5B'span',%20%7B%7D,%20%5B'span',%20keyStyle,%20key%20+%20':%20'%5D,%20reference(record.get(key),%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20noPreview:%20true%0A%20%20%20%20%20%20%20%20%20%20%7D)%5D);%0A%20%20%20%20%20%20%20%20%20%20return%20preview;%0A%20%20%20%20%20%20%20%20%7D,%20%5B%5D);%0A%20%20%20%20%20%20%20%20inlinePreview%20=%20%5B'span',%20inlineValuesStyle,%20'%7B'%5D.concat(_toConsumableArray(preview),%20%5B'%7D'%5D);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%5B'span',%20%7B%7D,%20%5B'span',%20immutableNameStyle,%20record._name%20%7C%7C%20record.constructor.name%20%7C%7C%20'Record'%5D,%20'%20',%20inlinePreview%5D;%0A%20%20%20%20%7D,%0A%20%20%20%20hasBody:%20hasBody,%0A%20%20%20%20body:%20function%20body(record)%20%7B%0A%20%20%20%20%20%20var%20defaults%20=%20record.clear();%0A%20%20%20%20%20%20var%20children%20=%20getKeySeq(record).toJS().map(function%20(key)%20%7B%0A%20%20%20%20%20%20%20%20var%20style%20=%20Immutable.is(defaults.get(key),%20record.get(key))%20?%20defaultValueKeyStyle%20:%20alteredValueKeyStyle;%0A%20%20%20%20%20%20%20%20return%20%5B'li',%20%7B%7D,%20%5B'span',%20style,%20key%20+%20':%20'%5D,%20reference(record.get(key))%5D;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20return%20%5B'ol',%20listStyle%5D.concat(_toConsumableArray(children));%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20var%20ListFormatter%20=%20%7B%0A%20%20%20%20header:%20function%20header(o)%20%7B%0A%20%20%20%20%20%20if%20(!Immutable.List.isList(o))%20return%20null;%0A%20%20%20%20%20%20return%20renderIterableHeader(o,%20'List');%0A%20%20%20%20%7D,%0A%20%20%20%20hasBody:%20hasBody,%0A%20%20%20%20body:%20function%20body(o)%20%7B%0A%20%20%20%20%20%20return%20renderIterableBody(o,%20function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20%20%20return%20%5B'li',%20%5B'span',%20keyStyle,%20key%20+%20':%20'%5D,%20reference(value)%5D;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20var%20StackFormatter%20=%20%7B%0A%20%20%20%20header:%20function%20header(o)%20%7B%0A%20%20%20%20%20%20if%20(!Immutable.Stack.isStack(o))%20return%20null;%0A%20%20%20%20%20%20return%20renderIterableHeader(o,%20'Stack');%0A%20%20%20%20%7D,%0A%20%20%20%20hasBody:%20hasBody,%0A%20%20%20%20body:%20function%20body(o)%20%7B%0A%20%20%20%20%20%20return%20renderIterableBody(o,%20function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20%20%20return%20%5B'li',%20%5B'span',%20keyStyle,%20key%20+%20':%20'%5D,%20reference(value)%5D;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20var%20MapFormatter%20=%20%7B%0A%20%20%20%20header:%20function%20header(o)%20%7B%0A%20%20%20%20%20%20if%20(!Immutable.Map.isMap(o))%20return%20null;%0A%20%20%20%20%20%20return%20renderIterableHeader(o,%20'Map');%0A%20%20%20%20%7D,%0A%20%20%20%20hasBody:%20hasBody,%0A%20%20%20%20body:%20function%20body(o)%20%7B%0A%20%20%20%20%20%20return%20renderIterableBody(o,%20function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20%20%20return%20%5B'li',%20%7B%7D,%20'%7B',%20reference(key),%20'%20=%3E%20',%20reference(value),%20'%7D'%5D;%0A%20%20%20%20%20%20%7D,%20%7B%0A%20%20%20%20%20%20%20%20sorted:%20true%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20var%20OrderedMapFormatter%20=%20%7B%0A%20%20%20%20header:%20function%20header(o)%20%7B%0A%20%20%20%20%20%20if%20(!Immutable.OrderedMap.isOrderedMap(o))%20return%20null;%0A%20%20%20%20%20%20return%20renderIterableHeader(o,%20'OrderedMap');%0A%20%20%20%20%7D,%0A%20%20%20%20hasBody:%20hasBody,%0A%20%20%20%20body:%20function%20body(o)%20%7B%0A%20%20%20%20%20%20return%20renderIterableBody(o,%20function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20%20%20return%20%5B'li',%20%7B%7D,%20'%7B',%20reference(key),%20'%20=%3E%20',%20reference(value),%20'%7D'%5D;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20var%20SetFormatter%20=%20%7B%0A%20%20%20%20header:%20function%20header(o)%20%7B%0A%20%20%20%20%20%20if%20(!Immutable.Set.isSet(o))%20return%20null;%0A%20%20%20%20%20%20return%20renderIterableHeader(o,%20'Set');%0A%20%20%20%20%7D,%0A%20%20%20%20hasBody:%20hasBody,%0A%20%20%20%20body:%20function%20body(o)%20%7B%0A%20%20%20%20%20%20return%20renderIterableBody(o,%20function%20(value)%20%7B%0A%20%20%20%20%20%20%20%20return%20%5B'li',%20reference(value)%5D;%0A%20%20%20%20%20%20%7D,%20%7B%0A%20%20%20%20%20%20%20%20sorted:%20true%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20var%20OrderedSetFormatter%20=%20%7B%0A%20%20%20%20header:%20function%20header(o)%20%7B%0A%20%20%20%20%20%20if%20(!Immutable.OrderedSet.isOrderedSet(o))%20return%20null;%0A%20%20%20%20%20%20return%20renderIterableHeader(o,%20'OrderedSet');%0A%20%20%20%20%7D,%0A%20%20%20%20hasBody:%20hasBody,%0A%20%20%20%20body:%20function%20body(o)%20%7B%0A%20%20%20%20%20%20return%20renderIterableBody(o,%20function%20(value)%20%7B%0A%20%20%20%20%20%20%20%20return%20%5B'li',%20reference(value)%5D;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20return%20%7B%0A%20%20%20%20RecordFormatter:%20RecordFormatter,%0A%20%20%20%20OrderedMapFormatter:%20OrderedMapFormatter,%0A%20%20%20%20OrderedSetFormatter:%20OrderedSetFormatter,%0A%20%20%20%20ListFormatter:%20ListFormatter,%0A%20%20%20%20MapFormatter:%20MapFormatter,%0A%20%20%20%20SetFormatter:%20SetFormatter,%0A%20%20%20%20StackFormatter:%20StackFormatter%0A%20%20%7D;%0A%7D%0A%0A//%20Check%20for%20globally%20defined%20Immutable%20and%20add%20an%20install%20method%20to%20it.%0Aif%20(typeof%20Immutable%20!==%20'undefined')%20%7B%0A%20%20Immutable.installDevTools%20=%20install.bind(null,%20Immutable);%0A%7D%0A%0A//%20I%20imagine%20most%20people%20are%20using%20Immutable%20as%20a%20CommonJS%20module%20though...%0A%0Avar%20installed%20=%20false;%0Afunction%20install(Immutable)%20%7B%0A%20%20var%20gw%20=%20typeof%20window%20===%20'undefined'%20?%20global%20:%20window;%0A%0A%20%20//%20Don't%20install%20more%20than%20once.%0A%20%20if%20(installed%20===%20true)%20%7B%0A%20%20%20%20return;%0A%20%20%7D%0A%20%20gw.devtoolsFormatters%20=%20gw.devtoolsFormatters%20%7C%7C%20%5B%5D;%0A%20%20var%20_createFormatters%20=%20createFormatter(Immutable),%0A%20%20%20%20RecordFormatter%20=%20_createFormatters.RecordFormatter,%0A%20%20%20%20OrderedMapFormatter%20=%20_createFormatters.OrderedMapFormatter,%0A%20%20%20%20OrderedSetFormatter%20=%20_createFormatters.OrderedSetFormatter,%0A%20%20%20%20ListFormatter%20=%20_createFormatters.ListFormatter,%0A%20%20%20%20MapFormatter%20=%20_createFormatters.MapFormatter,%0A%20%20%20%20SetFormatter%20=%20_createFormatters.SetFormatter,%0A%20%20%20%20StackFormatter%20=%20_createFormatters.StackFormatter;%0A%20%20gw.devtoolsFormatters.push(RecordFormatter,%20OrderedMapFormatter,%20OrderedSetFormatter,%20ListFormatter,%20MapFormatter,%20SetFormatter,%20StackFormatter);%0A%20%20installed%20=%20true;%0A%7D%0A%0Afunction%20_typeof(o)%20%7B%0A%20%20%22@babel/helpers%20-%20typeof%22;%0A%0A%20%20return%20_typeof%20=%20%22function%22%20==%20typeof%20Symbol%20&&%20%22symbol%22%20==%20typeof%20Symbol.iterator%20?%20function%20(o)%20%7B%0A%20%20%20%20return%20typeof%20o;%0A%20%20%7D%20:%20function%20(o)%20%7B%0A%20%20%20%20return%20o%20&&%20%22function%22%20==%20typeof%20Symbol%20&&%20o.constructor%20===%20Symbol%20&&%20o%20!==%20Symbol.prototype%20?%20%22symbol%22%20:%20typeof%20o;%0A%20%20%7D,%20_typeof(o);%0A%7D%0A%0A/**%0A%20*%20@license%0A%20*%20MIT%20License%0A%20*%20%0A%20*%20Copyright%20(c)%202014-present,%20Lee%20Byron%20and%20other%20contributors.%0A%20*%20%0A%20*%20Permission%20is%20hereby%20granted,%20free%20of%20charge,%20to%20any%20person%20obtaining%20a%20copy%0A%20*%20of%20this%20software%20and%20associated%20documentation%20files%20(the%20%22Software%22),%20to%20deal%0A%20*%20in%20the%20Software%20without%20restriction,%20including%20without%20limitation%20the%20rights%0A%20*%20to%20use,%20copy,%20modify,%20merge,%20publish,%20distribute,%20sublicense,%20and/or%20sell%0A%20*%20copies%20of%20the%20Software,%20and%20to%20permit%20persons%20to%20whom%20the%20Software%20is%0A%20*%20furnished%20to%20do%20so,%20subject%20to%20the%20following%20conditions:%0A%20*%20%0A%20*%20The%20above%20copyright%20notice%20and%20this%20permission%20notice%20shall%20be%20included%20in%20all%0A%20*%20copies%20or%20substantial%20portions%20of%20the%20Software.%0A%20*%20%0A%20*%20THE%20SOFTWARE%20IS%20PROVIDED%20%22AS%20IS%22,%20WITHOUT%20WARRANTY%20OF%20ANY%20KIND,%20EXPRESS%20OR%0A%20*%20IMPLIED,%20INCLUDING%20BUT%20NOT%20LIMITED%20TO%20THE%20WARRANTIES%20OF%20MERCHANTABILITY,%0A%20*%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%20AND%20NONINFRINGEMENT.%20IN%20NO%20EVENT%20SHALL%20THE%0A%20*%20AUTHORS%20OR%20COPYRIGHT%20HOLDERS%20BE%20LIABLE%20FOR%20ANY%20CLAIM,%20DAMAGES%20OR%20OTHER%0A%20*%20LIABILITY,%20WHETHER%20IN%20AN%20ACTION%20OF%20CONTRACT,%20TORT%20OR%20OTHERWISE,%20ARISING%20FROM,%0A%20*%20OUT%20OF%20OR%20IN%20CONNECTION%20WITH%20THE%20SOFTWARE%20OR%20THE%20USE%20OR%20OTHER%20DEALINGS%20IN%20THE%0A%20*%20SOFTWARE.%0A%20*/%0A//%20Used%20for%20setting%20prototype%20methods%20that%20IE8%20chokes%20on.%0Avar%20DELETE%20=%20'delete';%0A//%20Constants%20describing%20the%20size%20of%20trie%20nodes.%0Avar%20SHIFT%20=%205;%20//%20Resulted%20in%20best%20performance%20after%20______?%0Avar%20SIZE%20=%201%20%3C%3C%20SHIFT;%0Avar%20MASK%20=%20SIZE%20-%201;%0A//%20A%20consistent%20shared%20value%20representing%20%22not%20set%22%20which%20equals%20nothing%20other%0A//%20than%20itself,%20and%20nothing%20that%20could%20be%20provided%20externally.%0Avar%20NOT_SET%20=%20%7B%7D;%0A//%20Boolean%20references,%20Rough%20equivalent%20of%20%60bool%20&%60.%0Afunction%20MakeRef()%20%7B%0A%20%20return%20%7B%0A%20%20%20%20value:%20false%0A%20%20%7D;%0A%7D%0Afunction%20SetRef(ref)%20%7B%0A%20%20if%20(ref)%20%7B%0A%20%20%20%20ref.value%20=%20true;%0A%20%20%7D%0A%7D%0A//%20A%20function%20which%20returns%20a%20value%20representing%20an%20%22owner%22%20for%20transient%20writes%0A//%20to%20tries.%20The%20return%20value%20will%20only%20ever%20equal%20itself,%20and%20will%20not%20equal%0A//%20the%20return%20of%20any%20subsequent%20call%20of%20this%20function.%0Afunction%20OwnerID()%20%7B%7D%0Afunction%20ensureSize(iter)%20%7B%0A%20%20//%20@ts-expect-error%20size%20should%20exists%20on%20Collection%0A%20%20if%20(iter.size%20===%20undefined)%20%7B%0A%20%20%20%20//%20@ts-expect-error%20size%20should%20exists%20on%20Collection,%20__iterate%20does%20exist%20on%20Collection%0A%20%20%20%20iter.size%20=%20iter.__iterate(returnTrue);%0A%20%20%7D%0A%20%20//%20@ts-expect-error%20size%20should%20exists%20on%20Collection%0A%20%20return%20iter.size;%0A%7D%0Afunction%20wrapIndex(iter,%20index)%20%7B%0A%20%20//%20This%20implements%20%22is%20array%20index%22%20which%20the%20ECMAString%20spec%20defines%20as:%0A%20%20//%0A%20%20//%20%20%20%20%20A%20String%20property%20name%20P%20is%20an%20array%20index%20if%20and%20only%20if%0A%20%20//%20%20%20%20%20ToString(ToUint32(P))%20is%20equal%20to%20P%20and%20ToUint32(P)%20is%20not%20equal%0A%20%20//%20%20%20%20%20to%202%5E32%E2%88%921.%0A%20%20//%0A%20%20//%20http://www.ecma-international.org/ecma-262/6.0/#sec-array-exotic-objects%0A%20%20if%20(typeof%20index%20!==%20'number')%20%7B%0A%20%20%20%20var%20uint32Index%20=%20index%20%3E%3E%3E%200;%20//%20N%20%3E%3E%3E%200%20is%20shorthand%20for%20ToUint32%0A%20%20%20%20if%20(''%20+%20uint32Index%20!==%20index%20%7C%7C%20uint32Index%20===%204294967295)%20%7B%0A%20%20%20%20%20%20return%20NaN;%0A%20%20%20%20%7D%0A%20%20%20%20index%20=%20uint32Index;%0A%20%20%7D%0A%20%20return%20index%20%3C%200%20?%20ensureSize(iter)%20+%20index%20:%20index;%0A%7D%0Afunction%20returnTrue()%20%7B%0A%20%20return%20true;%0A%7D%0Afunction%20wholeSlice(begin,%20end,%20size)%20%7B%0A%20%20return%20(begin%20===%200%20&&%20!isNeg(begin)%20%7C%7C%20size%20!==%20undefined%20&&%20begin%20%3C=%20-size)%20&&%20(end%20===%20undefined%20%7C%7C%20size%20!==%20undefined%20&&%20end%20%3E=%20size);%0A%7D%0Afunction%20resolveBegin(begin,%20size)%20%7B%0A%20%20return%20resolveIndex(begin,%20size,%200);%0A%7D%0Afunction%20resolveEnd(end,%20size)%20%7B%0A%20%20return%20resolveIndex(end,%20size,%20size);%0A%7D%0Afunction%20resolveIndex(index,%20size,%20defaultIndex)%20%7B%0A%20%20//%20Sanitize%20indices%20using%20this%20shorthand%20for%20ToInt32(argument)%0A%20%20//%20http://www.ecma-international.org/ecma-262/6.0/#sec-toint32%0A%20%20return%20index%20===%20undefined%20?%20defaultIndex%20:%20isNeg(index)%20?%20size%20===%20Infinity%20?%20size%20:%20Math.max(0,%20size%20+%20index)%20%7C%200%20:%20size%20===%20undefined%20%7C%7C%20size%20===%20index%20?%20index%20:%20Math.min(size,%20index)%20%7C%200;%0A%7D%0Afunction%20isNeg(value)%20%7B%0A%20%20//%20Account%20for%20-0%20which%20is%20negative,%20but%20not%20less%20than%200.%0A%20%20return%20value%20%3C%200%20%7C%7C%20value%20===%200%20&&%201%20/%20value%20===%20-Infinity;%0A%7D%0A%0A//%20Note:%20value%20is%20unchanged%20to%20not%20break%20immutable-devtools.%0Avar%20IS_COLLECTION_SYMBOL%20=%20'@@__IMMUTABLE_ITERABLE__@@';%0A/**%0A%20*%20True%20if%20%60maybeCollection%60%20is%20a%20Collection,%20or%20any%20of%20its%20subclasses.%0A%20*%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20isCollection,%20Map,%20List,%20Stack%20%7D%20from%20'immutable';%0A%20*%0A%20*%20isCollection(%5B%5D);%20//%20false%0A%20*%20isCollection(%7B%7D);%20//%20false%0A%20*%20isCollection(Map());%20//%20true%0A%20*%20isCollection(List());%20//%20true%0A%20*%20isCollection(Stack());%20//%20true%0A%20*%20%60%60%60%0A%20*/%0Afunction%20isCollection(maybeCollection)%20%7B%0A%20%20return%20Boolean(maybeCollection%20&&%0A%20%20//%20@ts-expect-error:%20maybeCollection%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeCollection%20&&%20typeof%20maybeCollection%20===%20'object'%20&&%20IS_COLLECTION_SYMBOL%20in%20maybeCollection%60%0A%20%20maybeCollection%5BIS_COLLECTION_SYMBOL%5D);%0A%7D%0Avar%20IS_KEYED_SYMBOL%20=%20'@@__IMMUTABLE_KEYED__@@';%0A/**%0A%20*%20True%20if%20%60maybeKeyed%60%20is%20a%20Collection.Keyed,%20or%20any%20of%20its%20subclasses.%0A%20*%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20isKeyed,%20Map,%20List,%20Stack%20%7D%20from%20'immutable';%0A%20*%0A%20*%20isKeyed(%5B%5D);%20//%20false%0A%20*%20isKeyed(%7B%7D);%20//%20false%0A%20*%20isKeyed(Map());%20//%20true%0A%20*%20isKeyed(List());%20//%20false%0A%20*%20isKeyed(Stack());%20//%20false%0A%20*%20%60%60%60%0A%20*/%0Afunction%20isKeyed(maybeKeyed)%20%7B%0A%20%20return%20Boolean(maybeKeyed%20&&%0A%20%20//%20@ts-expect-error:%20maybeKeyed%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeKeyed%20&&%20typeof%20maybeKeyed%20===%20'object'%20&&%20IS_KEYED_SYMBOL%20in%20maybeKeyed%60%0A%20%20maybeKeyed%5BIS_KEYED_SYMBOL%5D);%0A%7D%0Avar%20IS_INDEXED_SYMBOL%20=%20'@@__IMMUTABLE_INDEXED__@@';%0A/**%0A%20*%20True%20if%20%60maybeIndexed%60%20is%20a%20Collection.Indexed,%20or%20any%20of%20its%20subclasses.%0A%20*%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20isIndexed,%20Map,%20List,%20Stack,%20Set%20%7D%20from%20'immutable';%0A%20*%0A%20*%20isIndexed(%5B%5D);%20//%20false%0A%20*%20isIndexed(%7B%7D);%20//%20false%0A%20*%20isIndexed(Map());%20//%20false%0A%20*%20isIndexed(List());%20//%20true%0A%20*%20isIndexed(Stack());%20//%20true%0A%20*%20isIndexed(Set());%20//%20false%0A%20*%20%60%60%60%0A%20*/%0Afunction%20isIndexed(maybeIndexed)%20%7B%0A%20%20return%20Boolean(maybeIndexed%20&&%0A%20%20//%20@ts-expect-error:%20maybeIndexed%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeIndexed%20&&%20typeof%20maybeIndexed%20===%20'object'%20&&%20IS_INDEXED_SYMBOL%20in%20maybeIndexed%60%0A%20%20maybeIndexed%5BIS_INDEXED_SYMBOL%5D);%0A%7D%0A%0A/**%0A%20*%20True%20if%20%60maybeAssociative%60%20is%20either%20a%20Keyed%20or%20Indexed%20Collection.%0A%20*%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20isAssociative,%20Map,%20List,%20Stack,%20Set%20%7D%20from%20'immutable';%0A%20*%0A%20*%20isAssociative(%5B%5D);%20//%20false%0A%20*%20isAssociative(%7B%7D);%20//%20false%0A%20*%20isAssociative(Map());%20//%20true%0A%20*%20isAssociative(List());%20//%20true%0A%20*%20isAssociative(Stack());%20//%20true%0A%20*%20isAssociative(Set());%20//%20false%0A%20*%20%60%60%60%0A%20*/%0Afunction%20isAssociative(maybeAssociative)%20%7B%0A%20%20return%20isKeyed(maybeAssociative)%20%7C%7C%20isIndexed(maybeAssociative);%0A%7D%0Avar%20Collection%20=%20function%20Collection(value)%20%7B%0A%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20return%20isCollection(value)%20?%20value%20:%20Seq(value);%0A%7D;%0Avar%20KeyedCollection%20=%20/*@__PURE__*/function%20(Collection)%20%7B%0A%20%20function%20KeyedCollection(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20isKeyed(value)%20?%20value%20:%20KeyedSeq(value);%0A%20%20%7D%0A%20%20if%20(Collection)%20KeyedCollection.__proto__%20=%20Collection;%0A%20%20KeyedCollection.prototype%20=%20Object.create(Collection%20&&%20Collection.prototype);%0A%20%20KeyedCollection.prototype.constructor%20=%20KeyedCollection;%0A%20%20return%20KeyedCollection;%0A%7D(Collection);%0Avar%20IndexedCollection%20=%20/*@__PURE__*/function%20(Collection)%20%7B%0A%20%20function%20IndexedCollection(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20isIndexed(value)%20?%20value%20:%20IndexedSeq(value);%0A%20%20%7D%0A%20%20if%20(Collection)%20IndexedCollection.__proto__%20=%20Collection;%0A%20%20IndexedCollection.prototype%20=%20Object.create(Collection%20&&%20Collection.prototype);%0A%20%20IndexedCollection.prototype.constructor%20=%20IndexedCollection;%0A%20%20return%20IndexedCollection;%0A%7D(Collection);%0Avar%20SetCollection%20=%20/*@__PURE__*/function%20(Collection)%20%7B%0A%20%20function%20SetCollection(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20isCollection(value)%20&&%20!isAssociative(value)%20?%20value%20:%20SetSeq(value);%0A%20%20%7D%0A%20%20if%20(Collection)%20SetCollection.__proto__%20=%20Collection;%0A%20%20SetCollection.prototype%20=%20Object.create(Collection%20&&%20Collection.prototype);%0A%20%20SetCollection.prototype.constructor%20=%20SetCollection;%0A%20%20return%20SetCollection;%0A%7D(Collection);%0ACollection.Keyed%20=%20KeyedCollection;%0ACollection.Indexed%20=%20IndexedCollection;%0ACollection.Set%20=%20SetCollection;%0Avar%20IS_SEQ_SYMBOL%20=%20'@@__IMMUTABLE_SEQ__@@';%0A/**%0A%20*%20True%20if%20%60maybeSeq%60%20is%20a%20Seq.%0A%20*/%0Afunction%20isSeq(maybeSeq)%20%7B%0A%20%20return%20Boolean(maybeSeq%20&&%0A%20%20//%20@ts-expect-error:%20maybeSeq%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeSeq%20&&%20typeof%20maybeSeq%20===%20'object'%20&&%20MAYBE_SEQ_SYMBOL%20in%20maybeSeq%60%0A%20%20maybeSeq%5BIS_SEQ_SYMBOL%5D);%0A%7D%0Avar%20IS_RECORD_SYMBOL%20=%20'@@__IMMUTABLE_RECORD__@@';%0A/**%0A%20*%20True%20if%20%60maybeRecord%60%20is%20a%20Record.%0A%20*/%0Afunction%20isRecord(maybeRecord)%20%7B%0A%20%20return%20Boolean(maybeRecord%20&&%0A%20%20//%20@ts-expect-error:%20maybeRecord%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeRecord%20&&%20typeof%20maybeRecord%20===%20'object'%20&&%20IS_RECORD_SYMBOL%20in%20maybeRecord%60%0A%20%20maybeRecord%5BIS_RECORD_SYMBOL%5D);%0A%7D%0A%0A/**%0A%20*%20True%20if%20%60maybeImmutable%60%20is%20an%20Immutable%20Collection%20or%20Record.%0A%20*%0A%20*%20Note:%20Still%20returns%20true%20even%20if%20the%20collections%20is%20within%20a%20%60withMutations()%60.%0A%20*%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20isImmutable,%20Map,%20List,%20Stack%20%7D%20from%20'immutable';%0A%20*%20isImmutable(%5B%5D);%20//%20false%0A%20*%20isImmutable(%7B%7D);%20//%20false%0A%20*%20isImmutable(Map());%20//%20true%0A%20*%20isImmutable(List());%20//%20true%0A%20*%20isImmutable(Stack());%20//%20true%0A%20*%20isImmutable(Map().asMutable());%20//%20true%0A%20*%20%60%60%60%0A%20*/%0Afunction%20isImmutable(maybeImmutable)%20%7B%0A%20%20return%20isCollection(maybeImmutable)%20%7C%7C%20isRecord(maybeImmutable);%0A%7D%0Avar%20IS_ORDERED_SYMBOL%20=%20'@@__IMMUTABLE_ORDERED__@@';%0Afunction%20isOrdered(maybeOrdered)%20%7B%0A%20%20return%20Boolean(maybeOrdered%20&&%0A%20%20//%20@ts-expect-error:%20maybeOrdered%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeOrdered%20&&%20typeof%20maybeOrdered%20===%20'object'%20&&%20IS_ORDERED_SYMBOL%20in%20maybeOrdered%60%0A%20%20maybeOrdered%5BIS_ORDERED_SYMBOL%5D);%0A%7D%0Avar%20ITERATE_KEYS%20=%200;%0Avar%20ITERATE_VALUES%20=%201;%0Avar%20ITERATE_ENTRIES%20=%202;%0Avar%20REAL_ITERATOR_SYMBOL%20=%20typeof%20Symbol%20===%20'function'%20&&%20Symbol.iterator;%0Avar%20FAUX_ITERATOR_SYMBOL%20=%20'@@iterator';%0Avar%20ITERATOR_SYMBOL%20=%20REAL_ITERATOR_SYMBOL%20%7C%7C%20FAUX_ITERATOR_SYMBOL;%0Avar%20Iterator%20=%20function%20Iterator(next)%20%7B%0A%20%20this.next%20=%20next;%0A%7D;%0AIterator.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20return%20'%5BIterator%5D';%0A%7D;%0AIterator.KEYS%20=%20ITERATE_KEYS;%0AIterator.VALUES%20=%20ITERATE_VALUES;%0AIterator.ENTRIES%20=%20ITERATE_ENTRIES;%0AIterator.prototype.inspect%20=%20Iterator.prototype.toSource%20=%20function%20()%20%7B%0A%20%20return%20this.toString();%0A%7D;%0AIterator.prototype%5BITERATOR_SYMBOL%5D%20=%20function%20()%20%7B%0A%20%20return%20this;%0A%7D;%0Afunction%20iteratorValue(type,%20k,%20v,%20iteratorResult)%20%7B%0A%20%20var%20value%20=%20type%20===%20ITERATE_KEYS%20?%20k%20:%20type%20===%20ITERATE_VALUES%20?%20v%20:%20%5Bk,%20v%5D;%0A%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20iteratorResult%20?%20iteratorResult.value%20=%20value%20:%20iteratorResult%20=%20%7B%0A%20%20%20%20value:%20value,%0A%20%20%20%20done:%20false%0A%20%20%7D;%0A%20%20return%20iteratorResult;%0A%7D%0Afunction%20iteratorDone()%20%7B%0A%20%20return%20%7B%0A%20%20%20%20value:%20undefined,%0A%20%20%20%20done:%20true%0A%20%20%7D;%0A%7D%0Afunction%20hasIterator(maybeIterable)%20%7B%0A%20%20if%20(Array.isArray(maybeIterable))%20%7B%0A%20%20%20%20//%20IE11%20trick%20as%20it%20does%20not%20support%20%60Symbol.iterator%60%0A%20%20%20%20return%20true;%0A%20%20%7D%0A%20%20return%20!!getIteratorFn(maybeIterable);%0A%7D%0Afunction%20isIterator(maybeIterator)%20%7B%0A%20%20return%20maybeIterator%20&&%20typeof%20maybeIterator.next%20===%20'function';%0A%7D%0Afunction%20getIterator(iterable)%20%7B%0A%20%20var%20iteratorFn%20=%20getIteratorFn(iterable);%0A%20%20return%20iteratorFn%20&&%20iteratorFn.call(iterable);%0A%7D%0Afunction%20getIteratorFn(iterable)%20%7B%0A%20%20var%20iteratorFn%20=%20iterable%20&&%20(REAL_ITERATOR_SYMBOL%20&&%20iterable%5BREAL_ITERATOR_SYMBOL%5D%20%7C%7C%20iterable%5BFAUX_ITERATOR_SYMBOL%5D);%0A%20%20if%20(typeof%20iteratorFn%20===%20'function')%20%7B%0A%20%20%20%20return%20iteratorFn;%0A%20%20%7D%0A%7D%0Afunction%20isEntriesIterable(maybeIterable)%20%7B%0A%20%20var%20iteratorFn%20=%20getIteratorFn(maybeIterable);%0A%20%20return%20iteratorFn%20&&%20iteratorFn%20===%20maybeIterable.entries;%0A%7D%0Afunction%20isKeysIterable(maybeIterable)%20%7B%0A%20%20var%20iteratorFn%20=%20getIteratorFn(maybeIterable);%0A%20%20return%20iteratorFn%20&&%20iteratorFn%20===%20maybeIterable.keys;%0A%7D%0Avar%20hasOwnProperty%20=%20Object.prototype.hasOwnProperty;%0Afunction%20isArrayLike(value)%20%7B%0A%20%20if%20(Array.isArray(value)%20%7C%7C%20typeof%20value%20===%20'string')%20%7B%0A%20%20%20%20return%20true;%0A%20%20%7D%0A%20%20//%20@ts-expect-error%20%22Type%20'unknown'%20is%20not%20assignable%20to%20type%20'boolean'%22%20:%20convert%20to%20Boolean%0A%20%20return%20value%20&&%20_typeof(value)%20===%20'object'%20&&%0A%20%20//%20@ts-expect-error%20check%20that%20%60'length'%20in%20value%20&&%60%0A%20%20Number.isInteger(value.length)%20&&%0A%20%20//%20@ts-expect-error%20check%20that%20%60'length'%20in%20value%20&&%60%0A%20%20value.length%20%3E=%200%20&&%20(%0A%20%20//%20@ts-expect-error%20check%20that%20%60'length'%20in%20value%20&&%60%0A%20%20value.length%20===%200%20?%0A%20%20//%20Only%20%7Blength:%200%7D%20is%20considered%20Array-like.%0A%20%20Object.keys(value).length%20===%201%20:%0A%20%20//%20An%20object%20is%20only%20Array-like%20if%20it%20has%20a%20property%20where%20the%20last%20value%0A%20%20//%20in%20the%20array-like%20may%20be%20found%20(which%20could%20be%20undefined).%0A%20%20//%20@ts-expect-error%20check%20that%20%60'length'%20in%20value%20&&%60%0A%20%20value.hasOwnProperty(value.length%20-%201));%0A%7D%0Avar%20Seq%20=%20/*@__PURE__*/function%20(Collection)%20%7B%0A%20%20function%20Seq(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptySequence()%20:%20isImmutable(value)%20?%20value.toSeq()%20:%20seqFromValue(value);%0A%20%20%7D%0A%20%20if%20(Collection)%20Seq.__proto__%20=%20Collection;%0A%20%20Seq.prototype%20=%20Object.create(Collection%20&&%20Collection.prototype);%0A%20%20Seq.prototype.constructor%20=%20Seq;%0A%20%20Seq.prototype.toSeq%20=%20function%20toSeq()%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D;%0A%20%20Seq.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('Seq%20%7B',%20'%7D');%0A%20%20%7D;%0A%20%20Seq.prototype.cacheResult%20=%20function%20cacheResult()%20%7B%0A%20%20%20%20if%20(!this._cache%20&&%20this.__iterateUncached)%20%7B%0A%20%20%20%20%20%20this._cache%20=%20this.entrySeq().toArray();%0A%20%20%20%20%20%20this.size%20=%20this._cache.length;%0A%20%20%20%20%7D%0A%20%20%20%20return%20this;%0A%20%20%7D;%0A%0A%20%20//%20abstract%20__iterateUncached(fn,%20reverse)%0A%0A%20%20Seq.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20cache%20=%20this._cache;%0A%20%20%20%20if%20(cache)%20%7B%0A%20%20%20%20%20%20var%20size%20=%20cache.length;%0A%20%20%20%20%20%20var%20i%20=%200;%0A%20%20%20%20%20%20while%20(i%20!==%20size)%20%7B%0A%20%20%20%20%20%20%20%20var%20entry%20=%20cache%5Breverse%20?%20size%20-%20++i%20:%20i++%5D;%0A%20%20%20%20%20%20%20%20if%20(fn(entry%5B1%5D,%20entry%5B0%5D,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20i;%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.__iterateUncached(fn,%20reverse);%0A%20%20%7D;%0A%0A%20%20//%20abstract%20__iteratorUncached(type,%20reverse)%0A%0A%20%20Seq.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20cache%20=%20this._cache;%0A%20%20%20%20if%20(cache)%20%7B%0A%20%20%20%20%20%20var%20size%20=%20cache.length;%0A%20%20%20%20%20%20var%20i%20=%200;%0A%20%20%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20%20%20if%20(i%20===%20size)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20entry%20=%20cache%5Breverse%20?%20size%20-%20++i%20:%20i++%5D;%0A%20%20%20%20%20%20%20%20return%20iteratorValue(type,%20entry%5B0%5D,%20entry%5B1%5D);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.__iteratorUncached(type,%20reverse);%0A%20%20%7D;%0A%20%20return%20Seq;%0A%7D(Collection);%0Avar%20KeyedSeq%20=%20/*@__PURE__*/function%20(Seq)%20%7B%0A%20%20function%20KeyedSeq(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptySequence().toKeyedSeq()%20:%20isCollection(value)%20?%20isKeyed(value)%20?%20value.toSeq()%20:%20value.fromEntrySeq()%20:%20isRecord(value)%20?%20value.toSeq()%20:%20keyedSeqFromValue(value);%0A%20%20%7D%0A%20%20if%20(Seq)%20KeyedSeq.__proto__%20=%20Seq;%0A%20%20KeyedSeq.prototype%20=%20Object.create(Seq%20&&%20Seq.prototype);%0A%20%20KeyedSeq.prototype.constructor%20=%20KeyedSeq;%0A%20%20KeyedSeq.prototype.toKeyedSeq%20=%20function%20toKeyedSeq()%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D;%0A%20%20return%20KeyedSeq;%0A%7D(Seq);%0Avar%20IndexedSeq%20=%20/*@__PURE__*/function%20(Seq)%20%7B%0A%20%20function%20IndexedSeq(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptySequence()%20:%20isCollection(value)%20?%20isKeyed(value)%20?%20value.entrySeq()%20:%20value.toIndexedSeq()%20:%20isRecord(value)%20?%20value.toSeq().entrySeq()%20:%20indexedSeqFromValue(value);%0A%20%20%7D%0A%20%20if%20(Seq)%20IndexedSeq.__proto__%20=%20Seq;%0A%20%20IndexedSeq.prototype%20=%20Object.create(Seq%20&&%20Seq.prototype);%0A%20%20IndexedSeq.prototype.constructor%20=%20IndexedSeq;%0A%20%20IndexedSeq.of%20=%20function%20of(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20return%20IndexedSeq(arguments);%0A%20%20%7D;%0A%20%20IndexedSeq.prototype.toIndexedSeq%20=%20function%20toIndexedSeq()%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D;%0A%20%20IndexedSeq.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('Seq%20%5B',%20'%5D');%0A%20%20%7D;%0A%20%20return%20IndexedSeq;%0A%7D(Seq);%0Avar%20SetSeq%20=%20/*@__PURE__*/function%20(Seq)%20%7B%0A%20%20function%20SetSeq(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20(isCollection(value)%20&&%20!isAssociative(value)%20?%20value%20:%20IndexedSeq(value)).toSetSeq();%0A%20%20%7D%0A%20%20if%20(Seq)%20SetSeq.__proto__%20=%20Seq;%0A%20%20SetSeq.prototype%20=%20Object.create(Seq%20&&%20Seq.prototype);%0A%20%20SetSeq.prototype.constructor%20=%20SetSeq;%0A%20%20SetSeq.of%20=%20function%20of(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20return%20SetSeq(arguments);%0A%20%20%7D;%0A%20%20SetSeq.prototype.toSetSeq%20=%20function%20toSetSeq()%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D;%0A%20%20return%20SetSeq;%0A%7D(Seq);%0ASeq.isSeq%20=%20isSeq;%0ASeq.Keyed%20=%20KeyedSeq;%0ASeq.Set%20=%20SetSeq;%0ASeq.Indexed%20=%20IndexedSeq;%0ASeq.prototype%5BIS_SEQ_SYMBOL%5D%20=%20true;%0A%0A//%20#pragma%20Root%20Sequences%0A%0Avar%20ArraySeq%20=%20/*@__PURE__*/function%20(IndexedSeq)%20%7B%0A%20%20function%20ArraySeq(array)%20%7B%0A%20%20%20%20this._array%20=%20array;%0A%20%20%20%20this.size%20=%20array.length;%0A%20%20%7D%0A%20%20if%20(IndexedSeq)%20ArraySeq.__proto__%20=%20IndexedSeq;%0A%20%20ArraySeq.prototype%20=%20Object.create(IndexedSeq%20&&%20IndexedSeq.prototype);%0A%20%20ArraySeq.prototype.constructor%20=%20ArraySeq;%0A%20%20ArraySeq.prototype.get%20=%20function%20get(index,%20notSetValue)%20%7B%0A%20%20%20%20return%20this.has(index)%20?%20this._array%5BwrapIndex(this,%20index)%5D%20:%20notSetValue;%0A%20%20%7D;%0A%20%20ArraySeq.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20array%20=%20this._array;%0A%20%20%20%20var%20size%20=%20array.length;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20while%20(i%20!==%20size)%20%7B%0A%20%20%20%20%20%20var%20ii%20=%20reverse%20?%20size%20-%20++i%20:%20i++;%0A%20%20%20%20%20%20if%20(fn(array%5Bii%5D,%20ii,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20i;%0A%20%20%7D;%0A%20%20ArraySeq.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20array%20=%20this._array;%0A%20%20%20%20var%20size%20=%20array.length;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20if%20(i%20===%20size)%20%7B%0A%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20ii%20=%20reverse%20?%20size%20-%20++i%20:%20i++;%0A%20%20%20%20%20%20return%20iteratorValue(type,%20ii,%20array%5Bii%5D);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20ArraySeq;%0A%7D(IndexedSeq);%0Avar%20ObjectSeq%20=%20/*@__PURE__*/function%20(KeyedSeq)%20%7B%0A%20%20function%20ObjectSeq(object)%20%7B%0A%20%20%20%20var%20keys%20=%20Object.keys(object).concat(Object.getOwnPropertySymbols%20?%20Object.getOwnPropertySymbols(object)%20:%20%5B%5D);%0A%20%20%20%20this._object%20=%20object;%0A%20%20%20%20this._keys%20=%20keys;%0A%20%20%20%20this.size%20=%20keys.length;%0A%20%20%7D%0A%20%20if%20(KeyedSeq)%20ObjectSeq.__proto__%20=%20KeyedSeq;%0A%20%20ObjectSeq.prototype%20=%20Object.create(KeyedSeq%20&&%20KeyedSeq.prototype);%0A%20%20ObjectSeq.prototype.constructor%20=%20ObjectSeq;%0A%20%20ObjectSeq.prototype.get%20=%20function%20get(key,%20notSetValue)%20%7B%0A%20%20%20%20if%20(notSetValue%20!==%20undefined%20&&%20!this.has(key))%20%7B%0A%20%20%20%20%20%20return%20notSetValue;%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._object%5Bkey%5D;%0A%20%20%7D;%0A%20%20ObjectSeq.prototype.has%20=%20function%20has(key)%20%7B%0A%20%20%20%20return%20hasOwnProperty.call(this._object,%20key);%0A%20%20%7D;%0A%20%20ObjectSeq.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20object%20=%20this._object;%0A%20%20%20%20var%20keys%20=%20this._keys;%0A%20%20%20%20var%20size%20=%20keys.length;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20while%20(i%20!==%20size)%20%7B%0A%20%20%20%20%20%20var%20key%20=%20keys%5Breverse%20?%20size%20-%20++i%20:%20i++%5D;%0A%20%20%20%20%20%20if%20(fn(object%5Bkey%5D,%20key,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20i;%0A%20%20%7D;%0A%20%20ObjectSeq.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20object%20=%20this._object;%0A%20%20%20%20var%20keys%20=%20this._keys;%0A%20%20%20%20var%20size%20=%20keys.length;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20if%20(i%20===%20size)%20%7B%0A%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20key%20=%20keys%5Breverse%20?%20size%20-%20++i%20:%20i++%5D;%0A%20%20%20%20%20%20return%20iteratorValue(type,%20key,%20object%5Bkey%5D);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20ObjectSeq;%0A%7D(KeyedSeq);%0AObjectSeq.prototype%5BIS_ORDERED_SYMBOL%5D%20=%20true;%0Avar%20CollectionSeq%20=%20/*@__PURE__*/function%20(IndexedSeq)%20%7B%0A%20%20function%20CollectionSeq(collection)%20%7B%0A%20%20%20%20this._collection%20=%20collection;%0A%20%20%20%20this.size%20=%20collection.length%20%7C%7C%20collection.size;%0A%20%20%7D%0A%20%20if%20(IndexedSeq)%20CollectionSeq.__proto__%20=%20IndexedSeq;%0A%20%20CollectionSeq.prototype%20=%20Object.create(IndexedSeq%20&&%20IndexedSeq.prototype);%0A%20%20CollectionSeq.prototype.constructor%20=%20CollectionSeq;%0A%20%20CollectionSeq.prototype.__iterateUncached%20=%20function%20__iterateUncached(fn,%20reverse)%20%7B%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterate(fn,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20collection%20=%20this._collection;%0A%20%20%20%20var%20iterator%20=%20getIterator(collection);%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20if%20(isIterator(iterator))%20%7B%0A%20%20%20%20%20%20var%20step;%0A%20%20%20%20%20%20while%20(!(step%20=%20iterator.next()).done)%20%7B%0A%20%20%20%20%20%20%20%20if%20(fn(step.value,%20iterations++,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20CollectionSeq.prototype.__iteratorUncached%20=%20function%20__iteratorUncached(type,%20reverse)%20%7B%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterator(type,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20collection%20=%20this._collection;%0A%20%20%20%20var%20iterator%20=%20getIterator(collection);%0A%20%20%20%20if%20(!isIterator(iterator))%20%7B%0A%20%20%20%20%20%20return%20new%20Iterator(iteratorDone);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20return%20step.done%20?%20step%20:%20iteratorValue(type,%20iterations++,%20step.value);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20CollectionSeq;%0A%7D(IndexedSeq);%0A%0A//%20#%20pragma%20Helper%20functions%0A%0Avar%20EMPTY_SEQ;%0Afunction%20emptySequence()%20%7B%0A%20%20return%20EMPTY_SEQ%20%7C%7C%20(EMPTY_SEQ%20=%20new%20ArraySeq(%5B%5D));%0A%7D%0Afunction%20keyedSeqFromValue(value)%20%7B%0A%20%20var%20seq%20=%20maybeIndexedSeqFromValue(value);%0A%20%20if%20(seq)%20%7B%0A%20%20%20%20return%20seq.fromEntrySeq();%0A%20%20%7D%0A%20%20if%20(_typeof(value)%20===%20'object')%20%7B%0A%20%20%20%20return%20new%20ObjectSeq(value);%0A%20%20%7D%0A%20%20throw%20new%20TypeError('Expected%20Array%20or%20collection%20object%20of%20%5Bk,%20v%5D%20entries,%20or%20keyed%20object:%20'%20+%20value);%0A%7D%0Afunction%20indexedSeqFromValue(value)%20%7B%0A%20%20var%20seq%20=%20maybeIndexedSeqFromValue(value);%0A%20%20if%20(seq)%20%7B%0A%20%20%20%20return%20seq;%0A%20%20%7D%0A%20%20throw%20new%20TypeError('Expected%20Array%20or%20collection%20object%20of%20values:%20'%20+%20value);%0A%7D%0Afunction%20seqFromValue(value)%20%7B%0A%20%20var%20seq%20=%20maybeIndexedSeqFromValue(value);%0A%20%20if%20(seq)%20%7B%0A%20%20%20%20return%20isEntriesIterable(value)%20?%20seq.fromEntrySeq()%20:%20isKeysIterable(value)%20?%20seq.toSetSeq()%20:%20seq;%0A%20%20%7D%0A%20%20if%20(_typeof(value)%20===%20'object')%20%7B%0A%20%20%20%20return%20new%20ObjectSeq(value);%0A%20%20%7D%0A%20%20throw%20new%20TypeError('Expected%20Array%20or%20collection%20object%20of%20values,%20or%20keyed%20object:%20'%20+%20value);%0A%7D%0Afunction%20maybeIndexedSeqFromValue(value)%20%7B%0A%20%20return%20isArrayLike(value)%20?%20new%20ArraySeq(value)%20:%20hasIterator(value)%20?%20new%20CollectionSeq(value)%20:%20undefined;%0A%7D%0Avar%20IS_MAP_SYMBOL%20=%20'@@__IMMUTABLE_MAP__@@';%0A/**%0A%20*%20True%20if%20%60maybeMap%60%20is%20a%20Map.%0A%20*%0A%20*%20Also%20true%20for%20OrderedMaps.%0A%20*/%0Afunction%20isMap(maybeMap)%20%7B%0A%20%20return%20Boolean(maybeMap%20&&%0A%20%20//%20@ts-expect-error:%20maybeMap%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeMap%20&&%20typeof%20maybeMap%20===%20'object'%20&&%20IS_MAP_SYMBOL%20in%20maybeMap%60%0A%20%20maybeMap%5BIS_MAP_SYMBOL%5D);%0A%7D%0A%0A/**%0A%20*%20True%20if%20%60maybeOrderedMap%60%20is%20an%20OrderedMap.%0A%20*/%0Afunction%20isOrderedMap(maybeOrderedMap)%20%7B%0A%20%20return%20isMap(maybeOrderedMap)%20&&%20isOrdered(maybeOrderedMap);%0A%7D%0A%0A/**%0A%20*%20True%20if%20%60maybeValue%60%20is%20a%20JavaScript%20Object%20which%20has%20*both*%20%60equals()%60%0A%20*%20and%20%60hashCode()%60%20methods.%0A%20*%0A%20*%20Any%20two%20instances%20of%20*value%20objects*%20can%20be%20compared%20for%20value%20equality%20with%0A%20*%20%60Immutable.is()%60%20and%20can%20be%20used%20as%20keys%20in%20a%20%60Map%60%20or%20members%20in%20a%20%60Set%60.%0A%20*/%0Afunction%20isValueObject(maybeValue)%20%7B%0A%20%20return%20Boolean(maybeValue%20&&%0A%20%20//%20@ts-expect-error:%20maybeValue%20is%20typed%20as%20%60%7B%7D%60%0A%20%20typeof%20maybeValue.equals%20===%20'function'%20&&%0A%20%20//%20@ts-expect-error:%20maybeValue%20is%20typed%20as%20%60%7B%7D%60%0A%20%20typeof%20maybeValue.hashCode%20===%20'function');%0A%7D%0A%0A/**%0A%20*%20An%20extension%20of%20the%20%22same-value%22%20algorithm%20as%20%5Bdescribed%20for%20use%20by%20ES6%20Map%0A%20*%20and%20Set%5D(https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Key_equality)%0A%20*%0A%20*%20NaN%20is%20considered%20the%20same%20as%20NaN,%20however%20-0%20and%200%20are%20considered%20the%20same%0A%20*%20value,%20which%20is%20different%20from%20the%20algorithm%20described%20by%0A%20*%20%5B%60Object.is%60%5D(https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is).%0A%20*%0A%20*%20This%20is%20extended%20further%20to%20allow%20Objects%20to%20describe%20the%20values%20they%0A%20*%20represent,%20by%20way%20of%20%60valueOf%60%20or%20%60equals%60%20(and%20%60hashCode%60).%0A%20*%0A%20*%20Note:%20because%20of%20this%20extension,%20the%20key%20equality%20of%20Immutable.Map%20and%20the%0A%20*%20value%20equality%20of%20Immutable.Set%20will%20differ%20from%20ES6%20Map%20and%20Set.%0A%20*%0A%20*%20###%20Defining%20custom%20values%0A%20*%0A%20*%20The%20easiest%20way%20to%20describe%20the%20value%20an%20object%20represents%20is%20by%20implementing%0A%20*%20%60valueOf%60.%20For%20example,%20%60Date%60%20represents%20a%20value%20by%20returning%20a%20unix%0A%20*%20timestamp%20for%20%60valueOf%60:%0A%20*%0A%20*%20%20%20%20%20var%20date1%20=%20new%20Date(1234567890000);%20//%20Fri%20Feb%2013%202009%20...%0A%20*%20%20%20%20%20var%20date2%20=%20new%20Date(1234567890000);%0A%20*%20%20%20%20%20date1.valueOf();%20//%201234567890000%0A%20*%20%20%20%20%20assert(%20date1%20!==%20date2%20);%0A%20*%20%20%20%20%20assert(%20Immutable.is(%20date1,%20date2%20)%20);%0A%20*%0A%20*%20Note:%20overriding%20%60valueOf%60%20may%20have%20other%20implications%20if%20you%20use%20this%20object%0A%20*%20where%20JavaScript%20expects%20a%20primitive,%20such%20as%20implicit%20string%20coercion.%0A%20*%0A%20*%20For%20more%20complex%20types,%20especially%20collections,%20implementing%20%60valueOf%60%20may%0A%20*%20not%20be%20performant.%20An%20alternative%20is%20to%20implement%20%60equals%60%20and%20%60hashCode%60.%0A%20*%0A%20*%20%60equals%60%20takes%20another%20object,%20presumably%20of%20similar%20type,%20and%20returns%20true%0A%20*%20if%20it%20is%20equal.%20Equality%20is%20symmetrical,%20so%20the%20same%20result%20should%20be%0A%20*%20returned%20if%20this%20and%20the%20argument%20are%20flipped.%0A%20*%0A%20*%20%20%20%20%20assert(%20a.equals(b)%20===%20b.equals(a)%20);%0A%20*%0A%20*%20%60hashCode%60%20returns%20a%2032bit%20integer%20number%20representing%20the%20object%20which%20will%0A%20*%20be%20used%20to%20determine%20how%20to%20store%20the%20value%20object%20in%20a%20Map%20or%20Set.%20You%20must%0A%20*%20provide%20both%20or%20neither%20methods,%20one%20must%20not%20exist%20without%20the%20other.%0A%20*%0A%20*%20Also,%20an%20important%20relationship%20between%20these%20methods%20must%20be%20upheld:%20if%20two%0A%20*%20values%20are%20equal,%20they%20*must*%20return%20the%20same%20hashCode.%20If%20the%20values%20are%20not%0A%20*%20equal,%20they%20might%20have%20the%20same%20hashCode;%20this%20is%20called%20a%20hash%20collision,%0A%20*%20and%20while%20undesirable%20for%20performance%20reasons,%20it%20is%20acceptable.%0A%20*%0A%20*%20%20%20%20%20if%20(a.equals(b))%20%7B%0A%20*%20%20%20%20%20%20%20assert(%20a.hashCode()%20===%20b.hashCode()%20);%0A%20*%20%20%20%20%20%7D%0A%20*%0A%20*%20All%20Immutable%20collections%20are%20Value%20Objects:%20they%20implement%20%60equals()%60%0A%20*%20and%20%60hashCode()%60.%0A%20*/%0Afunction%20is(valueA,%20valueB)%20%7B%0A%20%20if%20(valueA%20===%20valueB%20%7C%7C%20valueA%20!==%20valueA%20&&%20valueB%20!==%20valueB)%20%7B%0A%20%20%20%20return%20true;%0A%20%20%7D%0A%20%20if%20(!valueA%20%7C%7C%20!valueB)%20%7B%0A%20%20%20%20return%20false;%0A%20%20%7D%0A%20%20if%20(typeof%20valueA.valueOf%20===%20'function'%20&&%20typeof%20valueB.valueOf%20===%20'function')%20%7B%0A%20%20%20%20valueA%20=%20valueA.valueOf();%0A%20%20%20%20valueB%20=%20valueB.valueOf();%0A%20%20%20%20if%20(valueA%20===%20valueB%20%7C%7C%20valueA%20!==%20valueA%20&&%20valueB%20!==%20valueB)%20%7B%0A%20%20%20%20%20%20return%20true;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!valueA%20%7C%7C%20!valueB)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20!!(isValueObject(valueA)%20&&%20isValueObject(valueB)%20&&%20valueA.equals(valueB));%0A%7D%0Avar%20imul%20=%20typeof%20Math.imul%20===%20'function'%20&&%20Math.imul(0xffffffff,%202)%20===%20-2%20?%20Math.imul%20:%20function%20imul(a,%20b)%20%7B%0A%20%20a%20%7C=%200;%20//%20int%0A%20%20b%20%7C=%200;%20//%20int%0A%20%20var%20c%20=%20a%20&%200xffff;%0A%20%20var%20d%20=%20b%20&%200xffff;%0A%20%20//%20Shift%20by%200%20fixes%20the%20sign%20on%20the%20high%20part.%0A%20%20return%20c%20*%20d%20+%20((a%20%3E%3E%3E%2016)%20*%20d%20+%20c%20*%20(b%20%3E%3E%3E%2016)%20%3C%3C%2016%20%3E%3E%3E%200)%20%7C%200;%20//%20int%0A%7D;%0A%0A//%20v8%20has%20an%20optimization%20for%20storing%2031-bit%20signed%20numbers.%0A//%20Values%20which%20have%20either%2000%20or%2011%20as%20the%20high%20order%20bits%20qualify.%0A//%20This%20function%20drops%20the%20highest%20order%20bit%20in%20a%20signed%20number,%20maintaining%0A//%20the%20sign%20bit.%0Afunction%20smi(i32)%20%7B%0A%20%20return%20i32%20%3E%3E%3E%201%20&%200x40000000%20%7C%20i32%20&%200xbfffffff;%0A%7D%0Avar%20defaultValueOf%20=%20Object.prototype.valueOf;%0Afunction%20hash(o)%20%7B%0A%20%20//%20eslint-disable-next-line%20eqeqeq%0A%20%20if%20(o%20==%20null)%20%7B%0A%20%20%20%20return%20hashNullish(o);%0A%20%20%7D%0A%20%20if%20(typeof%20o.hashCode%20===%20'function')%20%7B%0A%20%20%20%20//%20Drop%20any%20high%20bits%20from%20accidentally%20long%20hash%20codes.%0A%20%20%20%20return%20smi(o.hashCode(o));%0A%20%20%7D%0A%20%20var%20v%20=%20valueOf(o);%0A%0A%20%20//%20eslint-disable-next-line%20eqeqeq%0A%20%20if%20(v%20==%20null)%20%7B%0A%20%20%20%20return%20hashNullish(v);%0A%20%20%7D%0A%20%20switch%20(_typeof(v))%20%7B%0A%20%20%20%20case%20'boolean':%0A%20%20%20%20%20%20//%20The%20hash%20values%20for%20built-in%20constants%20are%20a%201%20value%20for%20each%205-byte%0A%20%20%20%20%20%20//%20shift%20region%20expect%20for%20the%20first,%20which%20encodes%20the%20value.%20This%0A%20%20%20%20%20%20//%20reduces%20the%20odds%20of%20a%20hash%20collision%20for%20these%20common%20values.%0A%20%20%20%20%20%20return%20v%20?%200x42108421%20:%200x42108420;%0A%20%20%20%20case%20'number':%0A%20%20%20%20%20%20return%20hashNumber(v);%0A%20%20%20%20case%20'string':%0A%20%20%20%20%20%20return%20v.length%20%3E%20STRING_HASH_CACHE_MIN_STRLEN%20?%20cachedHashString(v)%20:%20hashString(v);%0A%20%20%20%20case%20'object':%0A%20%20%20%20case%20'function':%0A%20%20%20%20%20%20return%20hashJSObj(v);%0A%20%20%20%20case%20'symbol':%0A%20%20%20%20%20%20return%20hashSymbol(v);%0A%20%20%20%20default:%0A%20%20%20%20%20%20if%20(typeof%20v.toString%20===%20'function')%20%7B%0A%20%20%20%20%20%20%20%20return%20hashString(v.toString());%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20throw%20new%20Error('Value%20type%20'%20+%20_typeof(v)%20+%20'%20cannot%20be%20hashed.');%0A%20%20%7D%0A%7D%0Afunction%20hashNullish(nullish)%20%7B%0A%20%20return%20nullish%20===%20null%20?%200x42108422%20:%20/*%20undefined%20*/0x42108423;%0A%7D%0A%0A//%20Compress%20arbitrarily%20large%20numbers%20into%20smi%20hashes.%0Afunction%20hashNumber(n)%20%7B%0A%20%20if%20(n%20!==%20n%20%7C%7C%20n%20===%20Infinity)%20%7B%0A%20%20%20%20return%200;%0A%20%20%7D%0A%20%20var%20hash%20=%20n%20%7C%200;%0A%20%20if%20(hash%20!==%20n)%20%7B%0A%20%20%20%20hash%20%5E=%20n%20*%200xffffffff;%0A%20%20%7D%0A%20%20while%20(n%20%3E%200xffffffff)%20%7B%0A%20%20%20%20n%20/=%200xffffffff;%0A%20%20%20%20hash%20%5E=%20n;%0A%20%20%7D%0A%20%20return%20smi(hash);%0A%7D%0Afunction%20cachedHashString(string)%20%7B%0A%20%20var%20hashed%20=%20stringHashCache%5Bstring%5D;%0A%20%20if%20(hashed%20===%20undefined)%20%7B%0A%20%20%20%20hashed%20=%20hashString(string);%0A%20%20%20%20if%20(STRING_HASH_CACHE_SIZE%20===%20STRING_HASH_CACHE_MAX_SIZE)%20%7B%0A%20%20%20%20%20%20STRING_HASH_CACHE_SIZE%20=%200;%0A%20%20%20%20%20%20stringHashCache%20=%20%7B%7D;%0A%20%20%20%20%7D%0A%20%20%20%20STRING_HASH_CACHE_SIZE++;%0A%20%20%20%20stringHashCache%5Bstring%5D%20=%20hashed;%0A%20%20%7D%0A%20%20return%20hashed;%0A%7D%0A%0A//%20http://jsperf.com/hashing-strings%0Afunction%20hashString(string)%20%7B%0A%20%20//%20This%20is%20the%20hash%20from%20JVM%0A%20%20//%20The%20hash%20code%20for%20a%20string%20is%20computed%20as%0A%20%20//%20s%5B0%5D%20*%2031%20%5E%20(n%20-%201)%20+%20s%5B1%5D%20*%2031%20%5E%20(n%20-%202)%20+%20...%20+%20s%5Bn%20-%201%5D,%0A%20%20//%20where%20s%5Bi%5D%20is%20the%20ith%20character%20of%20the%20string%20and%20n%20is%20the%20length%20of%0A%20%20//%20the%20string.%20We%20%22mod%22%20the%20result%20to%20make%20it%20between%200%20(inclusive)%20and%202%5E31%0A%20%20//%20(exclusive)%20by%20dropping%20high%20bits.%0A%20%20var%20hashed%20=%200;%0A%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20string.length;%20ii++)%20%7B%0A%20%20%20%20hashed%20=%2031%20*%20hashed%20+%20string.charCodeAt(ii)%20%7C%200;%0A%20%20%7D%0A%20%20return%20smi(hashed);%0A%7D%0Afunction%20hashSymbol(sym)%20%7B%0A%20%20var%20hashed%20=%20symbolMap%5Bsym%5D;%0A%20%20if%20(hashed%20!==%20undefined)%20%7B%0A%20%20%20%20return%20hashed;%0A%20%20%7D%0A%20%20hashed%20=%20nextHash();%0A%20%20symbolMap%5Bsym%5D%20=%20hashed;%0A%20%20return%20hashed;%0A%7D%0Afunction%20hashJSObj(obj)%20%7B%0A%20%20var%20hashed;%0A%20%20if%20(usingWeakMap)%20%7B%0A%20%20%20%20hashed%20=%20weakMap.get(obj);%0A%20%20%20%20if%20(hashed%20!==%20undefined)%20%7B%0A%20%20%20%20%20%20return%20hashed;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20hashed%20=%20obj%5BUID_HASH_KEY%5D;%0A%20%20if%20(hashed%20!==%20undefined)%20%7B%0A%20%20%20%20return%20hashed;%0A%20%20%7D%0A%20%20if%20(!canDefineProperty)%20%7B%0A%20%20%20%20hashed%20=%20obj.propertyIsEnumerable%20&&%20obj.propertyIsEnumerable%5BUID_HASH_KEY%5D;%0A%20%20%20%20if%20(hashed%20!==%20undefined)%20%7B%0A%20%20%20%20%20%20return%20hashed;%0A%20%20%20%20%7D%0A%20%20%20%20hashed%20=%20getIENodeHash(obj);%0A%20%20%20%20if%20(hashed%20!==%20undefined)%20%7B%0A%20%20%20%20%20%20return%20hashed;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20hashed%20=%20nextHash();%0A%20%20if%20(usingWeakMap)%20%7B%0A%20%20%20%20weakMap.set(obj,%20hashed);%0A%20%20%7D%20else%20if%20(isExtensible%20!==%20undefined%20&&%20isExtensible(obj)%20===%20false)%20%7B%0A%20%20%20%20throw%20new%20Error('Non-extensible%20objects%20are%20not%20allowed%20as%20keys.');%0A%20%20%7D%20else%20if%20(canDefineProperty)%20%7B%0A%20%20%20%20Object.defineProperty(obj,%20UID_HASH_KEY,%20%7B%0A%20%20%20%20%20%20enumerable:%20false,%0A%20%20%20%20%20%20configurable:%20false,%0A%20%20%20%20%20%20writable:%20false,%0A%20%20%20%20%20%20value:%20hashed%0A%20%20%20%20%7D);%0A%20%20%7D%20else%20if%20(obj.propertyIsEnumerable%20!==%20undefined%20&&%20obj.propertyIsEnumerable%20===%20obj.constructor.prototype.propertyIsEnumerable)%20%7B%0A%20%20%20%20//%20Since%20we%20can't%20define%20a%20non-enumerable%20property%20on%20the%20object%0A%20%20%20%20//%20we'll%20hijack%20one%20of%20the%20less-used%20non-enumerable%20properties%20to%0A%20%20%20%20//%20save%20our%20hash%20on%20it.%20Since%20this%20is%20a%20function%20it%20will%20not%20show%20up%20in%0A%20%20%20%20//%20%60JSON.stringify%60%20which%20is%20what%20we%20want.%0A%20%20%20%20obj.propertyIsEnumerable%20=%20function%20()%20%7B%0A%20%20%20%20%20%20return%20this.constructor.prototype.propertyIsEnumerable.apply(this,%20arguments);%0A%20%20%20%20%7D;%0A%20%20%20%20obj.propertyIsEnumerable%5BUID_HASH_KEY%5D%20=%20hashed;%0A%20%20%7D%20else%20if%20(obj.nodeType%20!==%20undefined)%20%7B%0A%20%20%20%20//%20At%20this%20point%20we%20couldn't%20get%20the%20IE%20%60uniqueID%60%20to%20use%20as%20a%20hash%0A%20%20%20%20//%20and%20we%20couldn't%20use%20a%20non-enumerable%20property%20to%20exploit%20the%0A%20%20%20%20//%20dontEnum%20bug%20so%20we%20simply%20add%20the%20%60UID_HASH_KEY%60%20on%20the%20node%0A%20%20%20%20//%20itself.%0A%20%20%20%20obj%5BUID_HASH_KEY%5D%20=%20hashed;%0A%20%20%7D%20else%20%7B%0A%20%20%20%20throw%20new%20Error('Unable%20to%20set%20a%20non-enumerable%20property%20on%20object.');%0A%20%20%7D%0A%20%20return%20hashed;%0A%7D%0A%0A//%20Get%20references%20to%20ES5%20object%20methods.%0Avar%20isExtensible%20=%20Object.isExtensible;%0A%0A//%20True%20if%20Object.defineProperty%20works%20as%20expected.%20IE8%20fails%20this%20test.%0Avar%20canDefineProperty%20=%20function%20()%20%7B%0A%20%20try%20%7B%0A%20%20%20%20Object.defineProperty(%7B%7D,%20'@',%20%7B%7D);%0A%20%20%20%20return%20true;%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-vars%0A%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20return%20false;%0A%20%20%7D%0A%7D();%0A%0A//%20IE%20has%20a%20%60uniqueID%60%20property%20on%20DOM%20nodes.%20We%20can%20construct%20the%20hash%20from%20it%0A//%20and%20avoid%20memory%20leaks%20from%20the%20IE%20cloneNode%20bug.%0Afunction%20getIENodeHash(node)%20%7B%0A%20%20if%20(node%20&&%20node.nodeType%20%3E%200)%20%7B%0A%20%20%20%20switch%20(node.nodeType)%20%7B%0A%20%20%20%20%20%20case%201:%0A%20%20%20%20%20%20%20%20//%20Element%0A%20%20%20%20%20%20%20%20return%20node.uniqueID;%0A%20%20%20%20%20%20case%209:%0A%20%20%20%20%20%20%20%20//%20Document%0A%20%20%20%20%20%20%20%20return%20node.documentElement%20&&%20node.documentElement.uniqueID;%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Afunction%20valueOf(obj)%20%7B%0A%20%20return%20obj.valueOf%20!==%20defaultValueOf%20&&%20typeof%20obj.valueOf%20===%20'function'%20?%20obj.valueOf(obj)%20:%20obj;%0A%7D%0Afunction%20nextHash()%20%7B%0A%20%20var%20nextHash%20=%20++_objHashUID;%0A%20%20if%20(_objHashUID%20&%200x40000000)%20%7B%0A%20%20%20%20_objHashUID%20=%200;%0A%20%20%7D%0A%20%20return%20nextHash;%0A%7D%0A%0A//%20If%20possible,%20use%20a%20WeakMap.%0Avar%20usingWeakMap%20=%20typeof%20WeakMap%20===%20'function';%0Avar%20weakMap;%0Aif%20(usingWeakMap)%20%7B%0A%20%20weakMap%20=%20new%20WeakMap();%0A%7D%0Avar%20symbolMap%20=%20Object.create(null);%0Avar%20_objHashUID%20=%200;%0Avar%20UID_HASH_KEY%20=%20'__immutablehash__';%0Aif%20(typeof%20Symbol%20===%20'function')%20%7B%0A%20%20UID_HASH_KEY%20=%20Symbol(UID_HASH_KEY);%0A%7D%0Avar%20STRING_HASH_CACHE_MIN_STRLEN%20=%2016;%0Avar%20STRING_HASH_CACHE_MAX_SIZE%20=%20255;%0Avar%20STRING_HASH_CACHE_SIZE%20=%200;%0Avar%20stringHashCache%20=%20%7B%7D;%0Avar%20ToKeyedSequence%20=%20/*@__PURE__*/function%20(KeyedSeq)%20%7B%0A%20%20function%20ToKeyedSequence(indexed,%20useKeys)%20%7B%0A%20%20%20%20this._iter%20=%20indexed;%0A%20%20%20%20this._useKeys%20=%20useKeys;%0A%20%20%20%20this.size%20=%20indexed.size;%0A%20%20%7D%0A%20%20if%20(KeyedSeq)%20ToKeyedSequence.__proto__%20=%20KeyedSeq;%0A%20%20ToKeyedSequence.prototype%20=%20Object.create(KeyedSeq%20&&%20KeyedSeq.prototype);%0A%20%20ToKeyedSequence.prototype.constructor%20=%20ToKeyedSequence;%0A%20%20ToKeyedSequence.prototype.get%20=%20function%20get(key,%20notSetValue)%20%7B%0A%20%20%20%20return%20this._iter.get(key,%20notSetValue);%0A%20%20%7D;%0A%20%20ToKeyedSequence.prototype.has%20=%20function%20has(key)%20%7B%0A%20%20%20%20return%20this._iter.has(key);%0A%20%20%7D;%0A%20%20ToKeyedSequence.prototype.valueSeq%20=%20function%20valueSeq()%20%7B%0A%20%20%20%20return%20this._iter.valueSeq();%0A%20%20%7D;%0A%20%20ToKeyedSequence.prototype.reverse%20=%20function%20reverse()%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20reversedSequence%20=%20reverseFactory(this,%20true);%0A%20%20%20%20if%20(!this._useKeys)%20%7B%0A%20%20%20%20%20%20reversedSequence.valueSeq%20=%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20return%20this$1$1._iter.toSeq().reverse();%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%7D%0A%20%20%20%20return%20reversedSequence;%0A%20%20%7D;%0A%20%20ToKeyedSequence.prototype.map%20=%20function%20map(mapper,%20context)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20mappedSequence%20=%20mapFactory(this,%20mapper,%20context);%0A%20%20%20%20if%20(!this._useKeys)%20%7B%0A%20%20%20%20%20%20mappedSequence.valueSeq%20=%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20return%20this$1$1._iter.toSeq().map(mapper,%20context);%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%7D%0A%20%20%20%20return%20mappedSequence;%0A%20%20%7D;%0A%20%20ToKeyedSequence.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20this._iter.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20return%20fn(v,%20k,%20this$1$1);%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20ToKeyedSequence.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20return%20this._iter.__iterator(type,%20reverse);%0A%20%20%7D;%0A%20%20return%20ToKeyedSequence;%0A%7D(KeyedSeq);%0AToKeyedSequence.prototype%5BIS_ORDERED_SYMBOL%5D%20=%20true;%0Avar%20ToIndexedSequence%20=%20/*@__PURE__*/function%20(IndexedSeq)%20%7B%0A%20%20function%20ToIndexedSequence(iter)%20%7B%0A%20%20%20%20this._iter%20=%20iter;%0A%20%20%20%20this.size%20=%20iter.size;%0A%20%20%7D%0A%20%20if%20(IndexedSeq)%20ToIndexedSequence.__proto__%20=%20IndexedSeq;%0A%20%20ToIndexedSequence.prototype%20=%20Object.create(IndexedSeq%20&&%20IndexedSeq.prototype);%0A%20%20ToIndexedSequence.prototype.constructor%20=%20ToIndexedSequence;%0A%20%20ToIndexedSequence.prototype.includes%20=%20function%20includes(value)%20%7B%0A%20%20%20%20return%20this._iter.includes(value);%0A%20%20%7D;%0A%20%20ToIndexedSequence.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20reverse%20&&%20ensureSize(this);%0A%20%20%20%20return%20this._iter.__iterate(function%20(v)%20%7B%0A%20%20%20%20%20%20return%20fn(v,%20reverse%20?%20this$1$1.size%20-%20++i%20:%20i++,%20this$1$1);%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20ToIndexedSequence.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20iterator%20=%20this._iter.__iterator(ITERATE_VALUES,%20reverse);%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20reverse%20&&%20ensureSize(this);%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20return%20step.done%20?%20step%20:%20iteratorValue(type,%20reverse%20?%20this$1$1.size%20-%20++i%20:%20i++,%20step.value,%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20ToIndexedSequence;%0A%7D(IndexedSeq);%0Avar%20ToSetSequence%20=%20/*@__PURE__*/function%20(SetSeq)%20%7B%0A%20%20function%20ToSetSequence(iter)%20%7B%0A%20%20%20%20this._iter%20=%20iter;%0A%20%20%20%20this.size%20=%20iter.size;%0A%20%20%7D%0A%20%20if%20(SetSeq)%20ToSetSequence.__proto__%20=%20SetSeq;%0A%20%20ToSetSequence.prototype%20=%20Object.create(SetSeq%20&&%20SetSeq.prototype);%0A%20%20ToSetSequence.prototype.constructor%20=%20ToSetSequence;%0A%20%20ToSetSequence.prototype.has%20=%20function%20has(key)%20%7B%0A%20%20%20%20return%20this._iter.includes(key);%0A%20%20%7D;%0A%20%20ToSetSequence.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20this._iter.__iterate(function%20(v)%20%7B%0A%20%20%20%20%20%20return%20fn(v,%20v,%20this$1$1);%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20ToSetSequence.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20iterator%20=%20this._iter.__iterator(ITERATE_VALUES,%20reverse);%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20return%20step.done%20?%20step%20:%20iteratorValue(type,%20step.value,%20step.value,%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20ToSetSequence;%0A%7D(SetSeq);%0Avar%20FromEntriesSequence%20=%20/*@__PURE__*/function%20(KeyedSeq)%20%7B%0A%20%20function%20FromEntriesSequence(entries)%20%7B%0A%20%20%20%20this._iter%20=%20entries;%0A%20%20%20%20this.size%20=%20entries.size;%0A%20%20%7D%0A%20%20if%20(KeyedSeq)%20FromEntriesSequence.__proto__%20=%20KeyedSeq;%0A%20%20FromEntriesSequence.prototype%20=%20Object.create(KeyedSeq%20&&%20KeyedSeq.prototype);%0A%20%20FromEntriesSequence.prototype.constructor%20=%20FromEntriesSequence;%0A%20%20FromEntriesSequence.prototype.entrySeq%20=%20function%20entrySeq()%20%7B%0A%20%20%20%20return%20this._iter.toSeq();%0A%20%20%7D;%0A%20%20FromEntriesSequence.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20this._iter.__iterate(function%20(entry)%20%7B%0A%20%20%20%20%20%20//%20Check%20if%20entry%20exists%20first%20so%20array%20access%20doesn't%20throw%20for%20holes%0A%20%20%20%20%20%20//%20in%20the%20parent%20iteration.%0A%20%20%20%20%20%20if%20(entry)%20%7B%0A%20%20%20%20%20%20%20%20validateEntry(entry);%0A%20%20%20%20%20%20%20%20var%20indexedCollection%20=%20isCollection(entry);%0A%20%20%20%20%20%20%20%20return%20fn(indexedCollection%20?%20entry.get(1)%20:%20entry%5B1%5D,%20indexedCollection%20?%20entry.get(0)%20:%20entry%5B0%5D,%20this$1$1);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20FromEntriesSequence.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20iterator%20=%20this._iter.__iterator(ITERATE_VALUES,%20reverse);%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20while%20(true)%20%7B%0A%20%20%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20%20%20if%20(step.done)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20entry%20=%20step.value;%0A%20%20%20%20%20%20%20%20//%20Check%20if%20entry%20exists%20first%20so%20array%20access%20doesn't%20throw%20for%20holes%0A%20%20%20%20%20%20%20%20//%20in%20the%20parent%20iteration.%0A%20%20%20%20%20%20%20%20if%20(entry)%20%7B%0A%20%20%20%20%20%20%20%20%20%20validateEntry(entry);%0A%20%20%20%20%20%20%20%20%20%20var%20indexedCollection%20=%20isCollection(entry);%0A%20%20%20%20%20%20%20%20%20%20return%20iteratorValue(type,%20indexedCollection%20?%20entry.get(0)%20:%20entry%5B0%5D,%20indexedCollection%20?%20entry.get(1)%20:%20entry%5B1%5D,%20step);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20FromEntriesSequence;%0A%7D(KeyedSeq);%0AToIndexedSequence.prototype.cacheResult%20=%20ToKeyedSequence.prototype.cacheResult%20=%20ToSetSequence.prototype.cacheResult%20=%20FromEntriesSequence.prototype.cacheResult%20=%20cacheResultThrough;%0Afunction%20flipFactory(collection)%20%7B%0A%20%20var%20flipSequence%20=%20makeSequence(collection);%0A%20%20flipSequence._iter%20=%20collection;%0A%20%20flipSequence.size%20=%20collection.size;%0A%20%20flipSequence.flip%20=%20function%20()%20%7B%0A%20%20%20%20return%20collection;%0A%20%20%7D;%0A%20%20flipSequence.reverse%20=%20function%20()%20%7B%0A%20%20%20%20var%20reversedSequence%20=%20collection.reverse.apply(this);%20//%20super.reverse()%0A%20%20%20%20reversedSequence.flip%20=%20function%20()%20%7B%0A%20%20%20%20%20%20return%20collection.reverse();%0A%20%20%20%20%7D;%0A%20%20%20%20return%20reversedSequence;%0A%20%20%7D;%0A%20%20flipSequence.has%20=%20function%20(key)%20%7B%0A%20%20%20%20return%20collection.includes(key);%0A%20%20%7D;%0A%20%20flipSequence.includes%20=%20function%20(key)%20%7B%0A%20%20%20%20return%20collection.has(key);%0A%20%20%7D;%0A%20%20flipSequence.cacheResult%20=%20cacheResultThrough;%0A%20%20flipSequence.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20collection.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20return%20fn(k,%20v,%20this$1$1)%20!==%20false;%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20flipSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20if%20(type%20===%20ITERATE_ENTRIES)%20%7B%0A%20%20%20%20%20%20var%20iterator%20=%20collection.__iterator(type,%20reverse);%0A%20%20%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20%20%20if%20(!step.done)%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20k%20=%20step.value%5B0%5D;%0A%20%20%20%20%20%20%20%20%20%20step.value%5B0%5D%20=%20step.value%5B1%5D;%0A%20%20%20%20%20%20%20%20%20%20step.value%5B1%5D%20=%20k;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%0A%20%20%20%20return%20collection.__iterator(type%20===%20ITERATE_VALUES%20?%20ITERATE_KEYS%20:%20ITERATE_VALUES,%20reverse);%0A%20%20%7D;%0A%20%20return%20flipSequence;%0A%7D%0Afunction%20mapFactory(collection,%20mapper,%20context)%20%7B%0A%20%20var%20mappedSequence%20=%20makeSequence(collection);%0A%20%20mappedSequence.size%20=%20collection.size;%0A%20%20mappedSequence.has%20=%20function%20(key)%20%7B%0A%20%20%20%20return%20collection.has(key);%0A%20%20%7D;%0A%20%20mappedSequence.get%20=%20function%20(key,%20notSetValue)%20%7B%0A%20%20%20%20var%20v%20=%20collection.get(key,%20NOT_SET);%0A%20%20%20%20return%20v%20===%20NOT_SET%20?%20notSetValue%20:%20mapper.call(context,%20v,%20key,%20collection);%0A%20%20%7D;%0A%20%20mappedSequence.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20collection.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20%20%20return%20fn(mapper.call(context,%20v,%20k,%20c),%20k,%20this$1$1)%20!==%20false;%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20mappedSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(ITERATE_ENTRIES,%20reverse);%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20if%20(step.done)%20%7B%0A%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20entry%20=%20step.value;%0A%20%20%20%20%20%20var%20key%20=%20entry%5B0%5D;%0A%20%20%20%20%20%20return%20iteratorValue(type,%20key,%20mapper.call(context,%20entry%5B1%5D,%20key,%20collection),%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20mappedSequence;%0A%7D%0Afunction%20reverseFactory(collection,%20useKeys)%20%7B%0A%20%20var%20this$1$1%20=%20this;%0A%20%20var%20reversedSequence%20=%20makeSequence(collection);%0A%20%20reversedSequence._iter%20=%20collection;%0A%20%20reversedSequence.size%20=%20collection.size;%0A%20%20reversedSequence.reverse%20=%20function%20()%20%7B%0A%20%20%20%20return%20collection;%0A%20%20%7D;%0A%20%20if%20(collection.flip)%20%7B%0A%20%20%20%20reversedSequence.flip%20=%20function%20()%20%7B%0A%20%20%20%20%20%20var%20flipSequence%20=%20flipFactory(collection);%0A%20%20%20%20%20%20flipSequence.reverse%20=%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20return%20collection.flip();%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%20%20return%20flipSequence;%0A%20%20%20%20%7D;%0A%20%20%7D%0A%20%20reversedSequence.get%20=%20function%20(key,%20notSetValue)%20%7B%0A%20%20%20%20return%20collection.get(useKeys%20?%20key%20:%20-1%20-%20key,%20notSetValue);%0A%20%20%7D;%0A%20%20reversedSequence.has%20=%20function%20(key)%20%7B%0A%20%20%20%20return%20collection.has(useKeys%20?%20key%20:%20-1%20-%20key);%0A%20%20%7D;%0A%20%20reversedSequence.includes%20=%20function%20(value)%20%7B%0A%20%20%20%20return%20collection.includes(value);%0A%20%20%7D;%0A%20%20reversedSequence.cacheResult%20=%20cacheResultThrough;%0A%20%20reversedSequence.__iterate%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20reverse%20&&%20ensureSize(collection);%0A%20%20%20%20return%20collection.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20return%20fn(v,%20useKeys%20?%20k%20:%20reverse%20?%20this$1$1.size%20-%20++i%20:%20i++,%20this$1$1);%0A%20%20%20%20%7D,%20!reverse);%0A%20%20%7D;%0A%20%20reversedSequence.__iterator%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20reverse%20&&%20ensureSize(collection);%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(ITERATE_ENTRIES,%20!reverse);%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20if%20(step.done)%20%7B%0A%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20entry%20=%20step.value;%0A%20%20%20%20%20%20return%20iteratorValue(type,%20useKeys%20?%20entry%5B0%5D%20:%20reverse%20?%20this$1$1.size%20-%20++i%20:%20i++,%20entry%5B1%5D,%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20reversedSequence;%0A%7D%0Afunction%20filterFactory(collection,%20predicate,%20context,%20useKeys)%20%7B%0A%20%20var%20filterSequence%20=%20makeSequence(collection);%0A%20%20if%20(useKeys)%20%7B%0A%20%20%20%20filterSequence.has%20=%20function%20(key)%20%7B%0A%20%20%20%20%20%20var%20v%20=%20collection.get(key,%20NOT_SET);%0A%20%20%20%20%20%20return%20v%20!==%20NOT_SET%20&&%20!!predicate.call(context,%20v,%20key,%20collection);%0A%20%20%20%20%7D;%0A%20%20%20%20filterSequence.get%20=%20function%20(key,%20notSetValue)%20%7B%0A%20%20%20%20%20%20var%20v%20=%20collection.get(key,%20NOT_SET);%0A%20%20%20%20%20%20return%20v%20!==%20NOT_SET%20&&%20predicate.call(context,%20v,%20key,%20collection)%20?%20v%20:%20notSetValue;%0A%20%20%20%20%7D;%0A%20%20%7D%0A%20%20filterSequence.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20collection.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20%20%20if%20(predicate.call(context,%20v,%20k,%20c))%20%7B%0A%20%20%20%20%20%20%20%20iterations++;%0A%20%20%20%20%20%20%20%20return%20fn(v,%20useKeys%20?%20k%20:%20iterations%20-%201,%20this$1$1);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D,%20reverse);%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20filterSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(ITERATE_ENTRIES,%20reverse);%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20while%20(true)%20%7B%0A%20%20%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20%20%20if%20(step.done)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20entry%20=%20step.value;%0A%20%20%20%20%20%20%20%20var%20key%20=%20entry%5B0%5D;%0A%20%20%20%20%20%20%20%20var%20value%20=%20entry%5B1%5D;%0A%20%20%20%20%20%20%20%20if%20(predicate.call(context,%20value,%20key,%20collection))%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20iteratorValue(type,%20useKeys%20?%20key%20:%20iterations++,%20value,%20step);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20filterSequence;%0A%7D%0Afunction%20countByFactory(collection,%20grouper,%20context)%20%7B%0A%20%20var%20groups%20=%20Map().asMutable();%0A%20%20collection.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20groups.update(grouper.call(context,%20v,%20k,%20collection),%200,%20function%20(a)%20%7B%0A%20%20%20%20%20%20return%20a%20+%201;%0A%20%20%20%20%7D);%0A%20%20%7D);%0A%20%20return%20groups.asImmutable();%0A%7D%0Afunction%20groupByFactory(collection,%20grouper,%20context)%20%7B%0A%20%20var%20isKeyedIter%20=%20isKeyed(collection);%0A%20%20var%20groups%20=%20(isOrdered(collection)%20?%20OrderedMap()%20:%20Map()).asMutable();%0A%20%20collection.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20groups.update(grouper.call(context,%20v,%20k,%20collection),%20function%20(a)%20%7B%0A%20%20%20%20%20%20return%20a%20=%20a%20%7C%7C%20%5B%5D,%20a.push(isKeyedIter%20?%20%5Bk,%20v%5D%20:%20v),%20a;%0A%20%20%20%20%7D);%0A%20%20%7D);%0A%20%20var%20coerce%20=%20collectionClass(collection);%0A%20%20return%20groups.map(function%20(arr)%20%7B%0A%20%20%20%20return%20reify(collection,%20coerce(arr));%0A%20%20%7D).asImmutable();%0A%7D%0Afunction%20partitionFactory(collection,%20predicate,%20context)%20%7B%0A%20%20var%20isKeyedIter%20=%20isKeyed(collection);%0A%20%20var%20groups%20=%20%5B%5B%5D,%20%5B%5D%5D;%0A%20%20collection.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20groups%5Bpredicate.call(context,%20v,%20k,%20collection)%20?%201%20:%200%5D.push(isKeyedIter%20?%20%5Bk,%20v%5D%20:%20v);%0A%20%20%7D);%0A%20%20var%20coerce%20=%20collectionClass(collection);%0A%20%20return%20groups.map(function%20(arr)%20%7B%0A%20%20%20%20return%20reify(collection,%20coerce(arr));%0A%20%20%7D);%0A%7D%0Afunction%20sliceFactory(collection,%20begin,%20end,%20useKeys)%20%7B%0A%20%20var%20originalSize%20=%20collection.size;%0A%20%20if%20(wholeSlice(begin,%20end,%20originalSize))%20%7B%0A%20%20%20%20return%20collection;%0A%20%20%7D%0A%0A%20%20//%20begin%20or%20end%20can%20not%20be%20resolved%20if%20they%20were%20provided%20as%20negative%20numbers%20and%0A%20%20//%20this%20collection's%20size%20is%20unknown.%20In%20that%20case,%20cache%20first%20so%20there%20is%0A%20%20//%20a%20known%20size%20and%20these%20do%20not%20resolve%20to%20NaN.%0A%20%20if%20(typeof%20originalSize%20===%20'undefined'%20&&%20(begin%20%3C%200%20%7C%7C%20end%20%3C%200))%20%7B%0A%20%20%20%20return%20sliceFactory(collection.toSeq().cacheResult(),%20begin,%20end,%20useKeys);%0A%20%20%7D%0A%20%20var%20resolvedBegin%20=%20resolveBegin(begin,%20originalSize);%0A%20%20var%20resolvedEnd%20=%20resolveEnd(end,%20originalSize);%0A%0A%20%20//%20Note:%20resolvedEnd%20is%20undefined%20when%20the%20original%20sequence's%20length%20is%0A%20%20//%20unknown%20and%20this%20slice%20did%20not%20supply%20an%20end%20and%20should%20contain%20all%0A%20%20//%20elements%20after%20resolvedBegin.%0A%20%20//%20In%20that%20case,%20resolvedSize%20will%20be%20NaN%20and%20sliceSize%20will%20remain%20undefined.%0A%20%20var%20resolvedSize%20=%20resolvedEnd%20-%20resolvedBegin;%0A%20%20var%20sliceSize;%0A%20%20if%20(resolvedSize%20===%20resolvedSize)%20%7B%0A%20%20%20%20sliceSize%20=%20resolvedSize%20%3C%200%20?%200%20:%20resolvedSize;%0A%20%20%7D%0A%20%20var%20sliceSeq%20=%20makeSequence(collection);%0A%0A%20%20//%20If%20collection.size%20is%20undefined,%20the%20size%20of%20the%20realized%20sliceSeq%20is%0A%20%20//%20unknown%20at%20this%20point%20unless%20the%20number%20of%20items%20to%20slice%20is%200%0A%20%20sliceSeq.size%20=%20sliceSize%20===%200%20?%20sliceSize%20:%20collection.size%20&&%20sliceSize%20%7C%7C%20undefined;%0A%20%20if%20(!useKeys%20&&%20isSeq(collection)%20&&%20sliceSize%20%3E=%200)%20%7B%0A%20%20%20%20sliceSeq.get%20=%20function%20(index,%20notSetValue)%20%7B%0A%20%20%20%20%20%20index%20=%20wrapIndex(this,%20index);%0A%20%20%20%20%20%20return%20index%20%3E=%200%20&&%20index%20%3C%20sliceSize%20?%20collection.get(index%20+%20resolvedBegin,%20notSetValue)%20:%20notSetValue;%0A%20%20%20%20%7D;%0A%20%20%7D%0A%20%20sliceSeq.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(sliceSize%20===%200)%20%7B%0A%20%20%20%20%20%20return%200;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterate(fn,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20skipped%20=%200;%0A%20%20%20%20var%20isSkipping%20=%20true;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20collection.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20if%20(!(isSkipping%20&&%20(isSkipping%20=%20skipped++%20%3C%20resolvedBegin)))%20%7B%0A%20%20%20%20%20%20%20%20iterations++;%0A%20%20%20%20%20%20%20%20return%20fn(v,%20useKeys%20?%20k%20:%20iterations%20-%201,%20this$1$1)%20!==%20false%20&&%20iterations%20!==%20sliceSize;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20sliceSeq.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20if%20(sliceSize%20!==%200%20&&%20reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterator(type,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20//%20Don't%20bother%20instantiating%20parent%20iterator%20if%20taking%200.%0A%20%20%20%20if%20(sliceSize%20===%200)%20%7B%0A%20%20%20%20%20%20return%20new%20Iterator(iteratorDone);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(type,%20reverse);%0A%20%20%20%20var%20skipped%20=%200;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20while%20(skipped++%20%3C%20resolvedBegin)%20%7B%0A%20%20%20%20%20%20%20%20iterator.next();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20(++iterations%20%3E%20sliceSize)%20%7B%0A%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20if%20(useKeys%20%7C%7C%20type%20===%20ITERATE_VALUES%20%7C%7C%20step.done)%20%7B%0A%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20(type%20===%20ITERATE_KEYS)%20%7B%0A%20%20%20%20%20%20%20%20return%20iteratorValue(type,%20iterations%20-%201,%20undefined,%20step);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20iteratorValue(type,%20iterations%20-%201,%20step.value%5B1%5D,%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20sliceSeq;%0A%7D%0Afunction%20takeWhileFactory(collection,%20predicate,%20context)%20%7B%0A%20%20var%20takeSequence%20=%20makeSequence(collection);%0A%20%20takeSequence.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterate(fn,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20collection.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20%20%20return%20predicate.call(context,%20v,%20k,%20c)%20&&%20++iterations%20&&%20fn(v,%20k,%20this$1$1);%0A%20%20%20%20%7D);%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20takeSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterator(type,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(ITERATE_ENTRIES,%20reverse);%0A%20%20%20%20var%20iterating%20=%20true;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20if%20(!iterating)%20%7B%0A%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20if%20(step.done)%20%7B%0A%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20entry%20=%20step.value;%0A%20%20%20%20%20%20var%20k%20=%20entry%5B0%5D;%0A%20%20%20%20%20%20var%20v%20=%20entry%5B1%5D;%0A%20%20%20%20%20%20if%20(!predicate.call(context,%20v,%20k,%20this$1$1))%20%7B%0A%20%20%20%20%20%20%20%20iterating%20=%20false;%0A%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20type%20===%20ITERATE_ENTRIES%20?%20step%20:%20iteratorValue(type,%20k,%20v,%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20takeSequence;%0A%7D%0Afunction%20skipWhileFactory(collection,%20predicate,%20context,%20useKeys)%20%7B%0A%20%20var%20skipSequence%20=%20makeSequence(collection);%0A%20%20skipSequence.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterate(fn,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20isSkipping%20=%20true;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20collection.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20%20%20if%20(!(isSkipping%20&&%20(isSkipping%20=%20predicate.call(context,%20v,%20k,%20c))))%20%7B%0A%20%20%20%20%20%20%20%20iterations++;%0A%20%20%20%20%20%20%20%20return%20fn(v,%20useKeys%20?%20k%20:%20iterations%20-%201,%20this$1$1);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20skipSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterator(type,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(ITERATE_ENTRIES,%20reverse);%0A%20%20%20%20var%20skipping%20=%20true;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20step;%0A%20%20%20%20%20%20var%20k;%0A%20%20%20%20%20%20var%20v;%0A%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20step%20=%20iterator.next();%0A%20%20%20%20%20%20%20%20if%20(step.done)%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20(useKeys%20%7C%7C%20type%20===%20ITERATE_VALUES)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20(type%20===%20ITERATE_KEYS)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20iteratorValue(type,%20iterations++,%20undefined,%20step);%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20iteratorValue(type,%20iterations++,%20step.value%5B1%5D,%20step);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20entry%20=%20step.value;%0A%20%20%20%20%20%20%20%20k%20=%20entry%5B0%5D;%0A%20%20%20%20%20%20%20%20v%20=%20entry%5B1%5D;%0A%20%20%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20%20%20%20%20skipping%20&&%20(skipping%20=%20predicate.call(context,%20v,%20k,%20this$1$1));%0A%20%20%20%20%20%20%7D%20while%20(skipping);%0A%20%20%20%20%20%20return%20type%20===%20ITERATE_ENTRIES%20?%20step%20:%20iteratorValue(type,%20k,%20v,%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20skipSequence;%0A%7D%0Avar%20ConcatSeq%20=%20/*@__PURE__*/function%20(Seq)%20%7B%0A%20%20function%20ConcatSeq(iterables)%20%7B%0A%20%20%20%20this._wrappedIterables%20=%20iterables.flatMap(function%20(iterable)%20%7B%0A%20%20%20%20%20%20if%20(iterable._wrappedIterables)%20%7B%0A%20%20%20%20%20%20%20%20return%20iterable._wrappedIterables;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%5Biterable%5D;%0A%20%20%20%20%7D);%0A%20%20%20%20this.size%20=%20this._wrappedIterables.reduce(function%20(sum,%20iterable)%20%7B%0A%20%20%20%20%20%20if%20(sum%20!==%20undefined)%20%7B%0A%20%20%20%20%20%20%20%20var%20size%20=%20iterable.size;%0A%20%20%20%20%20%20%20%20if%20(size%20!==%20undefined)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20sum%20+%20size;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D,%200);%0A%20%20%20%20this%5BIS_KEYED_SYMBOL%5D%20=%20this._wrappedIterables%5B0%5D%5BIS_KEYED_SYMBOL%5D;%0A%20%20%20%20this%5BIS_INDEXED_SYMBOL%5D%20=%20this._wrappedIterables%5B0%5D%5BIS_INDEXED_SYMBOL%5D;%0A%20%20%20%20this%5BIS_ORDERED_SYMBOL%5D%20=%20this._wrappedIterables%5B0%5D%5BIS_ORDERED_SYMBOL%5D;%0A%20%20%7D%0A%20%20if%20(Seq)%20ConcatSeq.__proto__%20=%20Seq;%0A%20%20ConcatSeq.prototype%20=%20Object.create(Seq%20&&%20Seq.prototype);%0A%20%20ConcatSeq.prototype.constructor%20=%20ConcatSeq;%0A%20%20ConcatSeq.prototype.__iterateUncached%20=%20function%20__iterateUncached(fn,%20reverse)%20%7B%0A%20%20%20%20if%20(this._wrappedIterables.length%20===%200)%20%7B%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterate(fn,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterableIndex%20=%200;%0A%20%20%20%20var%20useKeys%20=%20isKeyed(this);%0A%20%20%20%20var%20iteratorType%20=%20useKeys%20?%20ITERATE_ENTRIES%20:%20ITERATE_VALUES;%0A%20%20%20%20var%20currentIterator%20=%20this._wrappedIterables%5BiterableIndex%5D.__iterator(iteratorType,%20reverse);%0A%20%20%20%20var%20keepGoing%20=%20true;%0A%20%20%20%20var%20index%20=%200;%0A%20%20%20%20while%20(keepGoing)%20%7B%0A%20%20%20%20%20%20var%20next%20=%20currentIterator.next();%0A%20%20%20%20%20%20while%20(next.done)%20%7B%0A%20%20%20%20%20%20%20%20iterableIndex++;%0A%20%20%20%20%20%20%20%20if%20(iterableIndex%20===%20this._wrappedIterables.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20index;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20currentIterator%20=%20this._wrappedIterables%5BiterableIndex%5D.__iterator(iteratorType,%20reverse);%0A%20%20%20%20%20%20%20%20next%20=%20currentIterator.next();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20fnResult%20=%20useKeys%20?%20fn(next.value%5B1%5D,%20next.value%5B0%5D,%20this)%20:%20fn(next.value,%20index,%20this);%0A%20%20%20%20%20%20keepGoing%20=%20fnResult%20!==%20false;%0A%20%20%20%20%20%20index++;%0A%20%20%20%20%7D%0A%20%20%20%20return%20index;%0A%20%20%7D;%0A%20%20ConcatSeq.prototype.__iteratorUncached%20=%20function%20__iteratorUncached(type,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(this._wrappedIterables.length%20===%200)%20%7B%0A%20%20%20%20%20%20return%20new%20Iterator(iteratorDone);%0A%20%20%20%20%7D%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterator(type,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterableIndex%20=%200;%0A%20%20%20%20var%20currentIterator%20=%20this._wrappedIterables%5BiterableIndex%5D.__iterator(type,%20reverse);%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20next%20=%20currentIterator.next();%0A%20%20%20%20%20%20while%20(next.done)%20%7B%0A%20%20%20%20%20%20%20%20iterableIndex++;%0A%20%20%20%20%20%20%20%20if%20(iterableIndex%20===%20this$1$1._wrappedIterables.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20next;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20currentIterator%20=%20this$1$1._wrappedIterables%5BiterableIndex%5D.__iterator(type,%20reverse);%0A%20%20%20%20%20%20%20%20next%20=%20currentIterator.next();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20next;%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20ConcatSeq;%0A%7D(Seq);%0Afunction%20concatFactory(collection,%20values)%20%7B%0A%20%20var%20isKeyedCollection%20=%20isKeyed(collection);%0A%20%20var%20iters%20=%20%5Bcollection%5D.concat(values).map(function%20(v)%20%7B%0A%20%20%20%20if%20(!isCollection(v))%20%7B%0A%20%20%20%20%20%20v%20=%20isKeyedCollection%20?%20keyedSeqFromValue(v)%20:%20indexedSeqFromValue(Array.isArray(v)%20?%20v%20:%20%5Bv%5D);%0A%20%20%20%20%7D%20else%20if%20(isKeyedCollection)%20%7B%0A%20%20%20%20%20%20v%20=%20KeyedCollection(v);%0A%20%20%20%20%7D%0A%20%20%20%20return%20v;%0A%20%20%7D).filter(function%20(v)%20%7B%0A%20%20%20%20return%20v.size%20!==%200;%0A%20%20%7D);%0A%20%20if%20(iters.length%20===%200)%20%7B%0A%20%20%20%20return%20collection;%0A%20%20%7D%0A%20%20if%20(iters.length%20===%201)%20%7B%0A%20%20%20%20var%20singleton%20=%20iters%5B0%5D;%0A%20%20%20%20if%20(singleton%20===%20collection%20%7C%7C%20isKeyedCollection%20&&%20isKeyed(singleton)%20%7C%7C%20isIndexed(collection)%20&&%20isIndexed(singleton))%20%7B%0A%20%20%20%20%20%20return%20singleton;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20new%20ConcatSeq(iters);%0A%7D%0Afunction%20flattenFactory(collection,%20depth,%20useKeys)%20%7B%0A%20%20var%20flatSequence%20=%20makeSequence(collection);%0A%20%20flatSequence.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterate(fn,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20var%20stopped%20=%20false;%0A%20%20%20%20function%20flatDeep(iter,%20currentDepth)%20%7B%0A%20%20%20%20%20%20iter.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20%20%20if%20((!depth%20%7C%7C%20currentDepth%20%3C%20depth)%20&&%20isCollection(v))%20%7B%0A%20%20%20%20%20%20%20%20%20%20flatDeep(v,%20currentDepth%20+%201);%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20iterations++;%0A%20%20%20%20%20%20%20%20%20%20if%20(fn(v,%20useKeys%20?%20k%20:%20iterations%20-%201,%20flatSequence)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20stopped%20=%20true;%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20!stopped;%0A%20%20%20%20%20%20%7D,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20flatDeep(collection,%200);%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20flatSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20this.cacheResult().__iterator(type,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(type,%20reverse);%0A%20%20%20%20var%20stack%20=%20%5B%5D;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20while%20(iterator)%20%7B%0A%20%20%20%20%20%20%20%20var%20step%20=%20iterator.next();%0A%20%20%20%20%20%20%20%20if%20(step.done%20!==%20false)%20%7B%0A%20%20%20%20%20%20%20%20%20%20iterator%20=%20stack.pop();%0A%20%20%20%20%20%20%20%20%20%20continue;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20v%20=%20step.value;%0A%20%20%20%20%20%20%20%20if%20(type%20===%20ITERATE_ENTRIES)%20%7B%0A%20%20%20%20%20%20%20%20%20%20v%20=%20v%5B1%5D;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20((!depth%20%7C%7C%20stack.length%20%3C%20depth)%20&&%20isCollection(v))%20%7B%0A%20%20%20%20%20%20%20%20%20%20stack.push(iterator);%0A%20%20%20%20%20%20%20%20%20%20iterator%20=%20v.__iterator(type,%20reverse);%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20useKeys%20?%20step%20:%20iteratorValue(type,%20iterations++,%20v,%20step);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20flatSequence;%0A%7D%0Afunction%20flatMapFactory(collection,%20mapper,%20context)%20%7B%0A%20%20var%20coerce%20=%20collectionClass(collection);%0A%20%20return%20collection.toSeq().map(function%20(v,%20k)%20%7B%0A%20%20%20%20return%20coerce(mapper.call(context,%20v,%20k,%20collection));%0A%20%20%7D).flatten(true);%0A%7D%0Afunction%20interposeFactory(collection,%20separator)%20%7B%0A%20%20var%20interposedSequence%20=%20makeSequence(collection);%0A%20%20interposedSequence.size%20=%20collection.size%20&&%20collection.size%20*%202%20-%201;%0A%20%20interposedSequence.__iterateUncached%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20collection.__iterate(function%20(v)%20%7B%0A%20%20%20%20%20%20return%20(!iterations%20%7C%7C%20fn(separator,%20iterations++,%20this$1$1)%20!==%20false)%20&&%20fn(v,%20iterations++,%20this$1$1)%20!==%20false;%0A%20%20%20%20%7D,%20reverse);%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20interposedSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20var%20iterator%20=%20collection.__iterator(ITERATE_VALUES,%20reverse);%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20var%20step;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20if%20(!step%20%7C%7C%20iterations%20%25%202)%20%7B%0A%20%20%20%20%20%20%20%20step%20=%20iterator.next();%0A%20%20%20%20%20%20%20%20if%20(step.done)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20step;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20iterations%20%25%202%20?%20iteratorValue(type,%20iterations++,%20separator)%20:%20iteratorValue(type,%20iterations++,%20step.value,%20step);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20interposedSequence;%0A%7D%0Afunction%20sortFactory(collection,%20comparator,%20mapper)%20%7B%0A%20%20if%20(!comparator)%20%7B%0A%20%20%20%20comparator%20=%20defaultComparator;%0A%20%20%7D%0A%20%20var%20isKeyedCollection%20=%20isKeyed(collection);%0A%20%20var%20index%20=%200;%0A%20%20var%20entries%20=%20collection.toSeq().map(function%20(v,%20k)%20%7B%0A%20%20%20%20return%20%5Bk,%20v,%20index++,%20mapper%20?%20mapper(v,%20k,%20collection)%20:%20v%5D;%0A%20%20%7D).valueSeq().toArray();%0A%20%20entries.sort(function%20(a,%20b)%20%7B%0A%20%20%20%20return%20comparator(a%5B3%5D,%20b%5B3%5D)%20%7C%7C%20a%5B2%5D%20-%20b%5B2%5D;%0A%20%20%7D).forEach(isKeyedCollection%20?%20function%20(v,%20i)%20%7B%0A%20%20%20%20entries%5Bi%5D.length%20=%202;%0A%20%20%7D%20:%20function%20(v,%20i)%20%7B%0A%20%20%20%20entries%5Bi%5D%20=%20v%5B1%5D;%0A%20%20%7D);%0A%20%20return%20isKeyedCollection%20?%20KeyedSeq(entries)%20:%20isIndexed(collection)%20?%20IndexedSeq(entries)%20:%20SetSeq(entries);%0A%7D%0Afunction%20maxFactory(collection,%20comparator,%20mapper)%20%7B%0A%20%20if%20(!comparator)%20%7B%0A%20%20%20%20comparator%20=%20defaultComparator;%0A%20%20%7D%0A%20%20if%20(mapper)%20%7B%0A%20%20%20%20var%20entry%20=%20collection.toSeq().map(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20return%20%5Bv,%20mapper(v,%20k,%20collection)%5D;%0A%20%20%20%20%7D).reduce(function%20(a,%20b)%20%7B%0A%20%20%20%20%20%20return%20maxCompare(comparator,%20a%5B1%5D,%20b%5B1%5D)%20?%20b%20:%20a;%0A%20%20%20%20%7D);%0A%20%20%20%20return%20entry%20&&%20entry%5B0%5D;%0A%20%20%7D%0A%20%20return%20collection.reduce(function%20(a,%20b)%20%7B%0A%20%20%20%20return%20maxCompare(comparator,%20a,%20b)%20?%20b%20:%20a;%0A%20%20%7D);%0A%7D%0Afunction%20maxCompare(comparator,%20a,%20b)%20%7B%0A%20%20var%20comp%20=%20comparator(b,%20a);%0A%20%20//%20b%20is%20considered%20the%20new%20max%20if%20the%20comparator%20declares%20them%20equal,%20but%0A%20%20//%20they%20are%20not%20equal%20and%20b%20is%20in%20fact%20a%20nullish%20value.%0A%20%20return%20comp%20===%200%20&&%20b%20!==%20a%20&&%20(b%20===%20undefined%20%7C%7C%20b%20===%20null%20%7C%7C%20b%20!==%20b)%20%7C%7C%20comp%20%3E%200;%0A%7D%0Afunction%20zipWithFactory(keyIter,%20zipper,%20iters,%20zipAll)%20%7B%0A%20%20var%20zipSequence%20=%20makeSequence(keyIter);%0A%20%20var%20sizes%20=%20new%20ArraySeq(iters).map(function%20(i)%20%7B%0A%20%20%20%20return%20i.size;%0A%20%20%7D);%0A%20%20zipSequence.size%20=%20zipAll%20?%20sizes.max()%20:%20sizes.min();%0A%20%20//%20Note:%20this%20a%20generic%20base%20implementation%20of%20__iterate%20in%20terms%20of%0A%20%20//%20__iterator%20which%20may%20be%20more%20generically%20useful%20in%20the%20future.%0A%20%20zipSequence.__iterate%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20%20%20/*%20generic:%0A%20%20%20%20var%20iterator%20=%20this.__iterator(ITERATE_ENTRIES,%20reverse);%0A%20%20%20%20var%20step;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20while%20(!(step%20=%20iterator.next()).done)%20%7B%0A%20%20%20%20%20%20iterations++;%0A%20%20%20%20%20%20if%20(fn(step.value%5B1%5D,%20step.value%5B0%5D,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20iterations;%0A%20%20%20%20*/%0A%20%20%20%20//%20indexed:%0A%20%20%20%20var%20iterator%20=%20this.__iterator(ITERATE_VALUES,%20reverse);%0A%20%20%20%20var%20step;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20while%20(!(step%20=%20iterator.next()).done)%20%7B%0A%20%20%20%20%20%20if%20(fn(step.value,%20iterations++,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20zipSequence.__iteratorUncached%20=%20function%20(type,%20reverse)%20%7B%0A%20%20%20%20var%20iterators%20=%20iters.map(function%20(i)%20%7B%0A%20%20%20%20%20%20return%20i%20=%20Collection(i),%20getIterator(reverse%20?%20i.reverse()%20:%20i);%0A%20%20%20%20%7D);%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20var%20isDone%20=%20false;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20steps;%0A%20%20%20%20%20%20if%20(!isDone)%20%7B%0A%20%20%20%20%20%20%20%20steps%20=%20iterators.map(function%20(i)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20i.next();%0A%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%20%20isDone%20=%20zipAll%20?%20steps.every(function%20(s)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20s.done;%0A%20%20%20%20%20%20%20%20%7D)%20:%20steps.some(function%20(s)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20s.done;%0A%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20(isDone)%20%7B%0A%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20iteratorValue(type,%20iterations++,%20zipper.apply(null,%20steps.map(function%20(s)%20%7B%0A%20%20%20%20%20%20%20%20return%20s.value;%0A%20%20%20%20%20%20%7D)));%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20zipSequence;%0A%7D%0A%0A//%20#pragma%20Helper%20Functions%0A%0Afunction%20reify(iter,%20seq)%20%7B%0A%20%20return%20iter%20===%20seq%20?%20iter%20:%20isSeq(iter)%20?%20seq%20:%20iter.constructor(seq);%0A%7D%0Afunction%20validateEntry(entry)%20%7B%0A%20%20if%20(entry%20!==%20Object(entry))%20%7B%0A%20%20%20%20throw%20new%20TypeError('Expected%20%5BK,%20V%5D%20tuple:%20'%20+%20entry);%0A%20%20%7D%0A%7D%0Afunction%20collectionClass(collection)%20%7B%0A%20%20return%20isKeyed(collection)%20?%20KeyedCollection%20:%20isIndexed(collection)%20?%20IndexedCollection%20:%20SetCollection;%0A%7D%0Afunction%20makeSequence(collection)%20%7B%0A%20%20return%20Object.create((isKeyed(collection)%20?%20KeyedSeq%20:%20isIndexed(collection)%20?%20IndexedSeq%20:%20SetSeq).prototype);%0A%7D%0Afunction%20cacheResultThrough()%20%7B%0A%20%20if%20(this._iter.cacheResult)%20%7B%0A%20%20%20%20this._iter.cacheResult();%0A%20%20%20%20this.size%20=%20this._iter.size;%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20return%20Seq.prototype.cacheResult.call(this);%0A%7D%0Afunction%20defaultComparator(a,%20b)%20%7B%0A%20%20if%20(a%20===%20undefined%20&&%20b%20===%20undefined)%20%7B%0A%20%20%20%20return%200;%0A%20%20%7D%0A%20%20if%20(a%20===%20undefined)%20%7B%0A%20%20%20%20return%201;%0A%20%20%7D%0A%20%20if%20(b%20===%20undefined)%20%7B%0A%20%20%20%20return%20-1;%0A%20%20%7D%0A%20%20return%20a%20%3E%20b%20?%201%20:%20a%20%3C%20b%20?%20-1%20:%200;%0A%7D%0A%0A//%20http://jsperf.com/copy-array-inline%0Afunction%20arrCopy(arr,%20offset)%20%7B%0A%20%20offset%20=%20offset%20%7C%7C%200;%0A%20%20var%20len%20=%20Math.max(0,%20arr.length%20-%20offset);%0A%20%20var%20newArr%20=%20new%20Array(len);%0A%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20len;%20ii++)%20%7B%0A%20%20%20%20//%20@ts-expect-error%20We%20may%20want%20to%20guard%20for%20undefined%20values%20with%20%60if%20(arr%5Bii%20+%20offset%5D%20!==%20undefined%60,%20but%20ths%20should%20not%20happen%20by%20design%0A%20%20%20%20newArr%5Bii%5D%20=%20arr%5Bii%20+%20offset%5D;%0A%20%20%7D%0A%20%20return%20newArr;%0A%7D%0Afunction%20invariant(condition,%20error)%20%7B%0A%20%20if%20(!condition)%20%7B%0A%20%20%20%20throw%20new%20Error(error);%0A%20%20%7D%0A%7D%0Afunction%20assertNotInfinite(size)%20%7B%0A%20%20invariant(size%20!==%20Infinity,%20'Cannot%20perform%20this%20action%20with%20an%20infinite%20size.');%0A%7D%0Afunction%20coerceKeyPath(keyPath)%20%7B%0A%20%20if%20(isArrayLike(keyPath)%20&&%20typeof%20keyPath%20!==%20'string')%20%7B%0A%20%20%20%20return%20keyPath;%0A%20%20%7D%0A%20%20if%20(isOrdered(keyPath))%20%7B%0A%20%20%20%20return%20keyPath.toArray();%0A%20%20%7D%0A%20%20throw%20new%20TypeError('Invalid%20keyPath:%20expected%20Ordered%20Collection%20or%20Array:%20'%20+%20keyPath);%0A%7D%0Avar%20toString%20=%20Object.prototype.toString;%0Afunction%20isPlainObject(value)%20%7B%0A%20%20//%20The%20base%20prototype's%20toString%20deals%20with%20Argument%20objects%20and%20native%20namespaces%20like%20Math%0A%20%20if%20(!value%20%7C%7C%20_typeof(value)%20!==%20'object'%20%7C%7C%20toString.call(value)%20!==%20'%5Bobject%20Object%5D')%20%7B%0A%20%20%20%20return%20false;%0A%20%20%7D%0A%20%20var%20proto%20=%20Object.getPrototypeOf(value);%0A%20%20if%20(proto%20===%20null)%20%7B%0A%20%20%20%20return%20true;%0A%20%20%7D%0A%20%20//%20Iteratively%20going%20up%20the%20prototype%20chain%20is%20needed%20for%20cross-realm%20environments%20(differing%20contexts,%20iframes,%20etc)%0A%20%20var%20parentProto%20=%20proto;%0A%20%20var%20nextProto%20=%20Object.getPrototypeOf(proto);%0A%20%20while%20(nextProto%20!==%20null)%20%7B%0A%20%20%20%20parentProto%20=%20nextProto;%0A%20%20%20%20nextProto%20=%20Object.getPrototypeOf(parentProto);%0A%20%20%7D%0A%20%20return%20parentProto%20===%20proto;%0A%7D%0A%0A/**%0A%20*%20Returns%20true%20if%20the%20value%20is%20a%20potentially-persistent%20data%20structure,%20either%0A%20*%20provided%20by%20Immutable.js%20or%20a%20plain%20Array%20or%20Object.%0A%20*/%0Afunction%20isDataStructure(value)%20%7B%0A%20%20return%20_typeof(value)%20===%20'object'%20&&%20(isImmutable(value)%20%7C%7C%20Array.isArray(value)%20%7C%7C%20isPlainObject(value));%0A%7D%0A%0A/**%0A%20*%20Converts%20a%20value%20to%20a%20string,%20adding%20quotes%20if%20a%20string%20was%20provided.%0A%20*/%0Afunction%20quoteString(value)%20%7B%0A%20%20try%20%7B%0A%20%20%20%20return%20typeof%20value%20===%20'string'%20?%20JSON.stringify(value)%20:%20String(value);%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-vars%0A%20%20%7D%20catch%20(_ignoreError)%20%7B%0A%20%20%20%20return%20JSON.stringify(value);%0A%20%20%7D%0A%7D%0A%0A/**%0A%20*%20Returns%20true%20if%20the%20key%20is%20defined%20in%20the%20provided%20collection.%0A%20*%0A%20*%20A%20functional%20alternative%20to%20%60collection.has(key)%60%20which%20will%20also%20work%20with%0A%20*%20plain%20Objects%20and%20Arrays%20as%20an%20alternative%20for%0A%20*%20%60collection.hasOwnProperty(key)%60.%0A%20*%0A%20*%20%3C!--%20runkit:activate%20--%3E%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20has%20%7D%20from%20'immutable';%0A%20*%0A%20*%20has(%5B%20'dog',%20'frog',%20'cat'%20%5D,%202)%20//%20true%0A%20*%20has(%5B%20'dog',%20'frog',%20'cat'%20%5D,%205)%20//%20false%0A%20*%20has(%7B%20x:%20123,%20y:%20456%20%7D,%20'x')%20//%20true%0A%20*%20has(%7B%20x:%20123,%20y:%20456%20%7D,%20'z')%20//%20false%0A%20*%20%60%60%60%0A%20*/%0Afunction%20has(collection,%20key)%20%7B%0A%20%20return%20isImmutable(collection)%20?%0A%20%20//%20@ts-expect-error%20key%20might%20be%20a%20number%20or%20symbol,%20which%20is%20not%20handled%20be%20Record%20key%20type%0A%20%20collection.has(key)%20:%0A%20%20//%20@ts-expect-error%20key%20might%20be%20anything%20else%20than%20PropertyKey,%20and%20will%20return%20false%20in%20that%20case%20but%20runtime%20is%20OK%0A%20%20isDataStructure(collection)%20&&%20hasOwnProperty.call(collection,%20key);%0A%7D%0Afunction%20get(collection,%20key,%20notSetValue)%20%7B%0A%20%20return%20isImmutable(collection)%20?%20collection.get(key,%20notSetValue)%20:%20!has(collection,%20key)%20?%20notSetValue%20:%0A%20%20//%20@ts-expect-error%20weird%20%22get%22%20here,%0A%20%20typeof%20collection.get%20===%20'function'%20?%0A%20%20//%20@ts-expect-error%20weird%20%22get%22%20here,%0A%20%20collection.get(key)%20:%0A%20%20//%20@ts-expect-error%20key%20is%20unknown%20here,%0A%20%20collection%5Bkey%5D;%0A%7D%0Afunction%20shallowCopy(from)%20%7B%0A%20%20if%20(Array.isArray(from))%20%7B%0A%20%20%20%20return%20arrCopy(from);%0A%20%20%7D%0A%20%20var%20to%20=%20%7B%7D;%0A%20%20for%20(var%20key%20in%20from)%20%7B%0A%20%20%20%20if%20(hasOwnProperty.call(from,%20key))%20%7B%0A%20%20%20%20%20%20to%5Bkey%5D%20=%20from%5Bkey%5D;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20to;%0A%7D%0Afunction%20remove(collection,%20key)%20%7B%0A%20%20if%20(!isDataStructure(collection))%20%7B%0A%20%20%20%20throw%20new%20TypeError('Cannot%20update%20non-data-structure%20value:%20'%20+%20collection);%0A%20%20%7D%0A%20%20if%20(isImmutable(collection))%20%7B%0A%20%20%20%20//%20@ts-expect-error%20weird%20%22remove%22%20here,%0A%20%20%20%20if%20(!collection.remove)%20%7B%0A%20%20%20%20%20%20throw%20new%20TypeError('Cannot%20update%20immutable%20value%20without%20.remove()%20method:%20'%20+%20collection);%0A%20%20%20%20%7D%0A%20%20%20%20//%20@ts-expect-error%20weird%20%22remove%22%20here,%0A%20%20%20%20return%20collection.remove(key);%0A%20%20%7D%0A%20%20//%20@ts-expect-error%20assert%20that%20key%20is%20a%20string,%20a%20number%20or%20a%20symbol%20here%0A%20%20if%20(!hasOwnProperty.call(collection,%20key))%20%7B%0A%20%20%20%20return%20collection;%0A%20%20%7D%0A%20%20var%20collectionCopy%20=%20shallowCopy(collection);%0A%20%20if%20(Array.isArray(collectionCopy))%20%7B%0A%20%20%20%20//%20@ts-expect-error%20assert%20that%20key%20is%20a%20number%20here%0A%20%20%20%20collectionCopy.splice(key,%201);%0A%20%20%7D%20else%20%7B%0A%20%20%20%20//%20@ts-expect-error%20assert%20that%20key%20is%20a%20string,%20a%20number%20or%20a%20symbol%20here%0A%20%20%20%20delete%20collectionCopy%5Bkey%5D;%0A%20%20%7D%0A%20%20return%20collectionCopy;%0A%7D%0Afunction%20set(collection,%20key,%20value)%20%7B%0A%20%20if%20(!isDataStructure(collection))%20%7B%0A%20%20%20%20throw%20new%20TypeError('Cannot%20update%20non-data-structure%20value:%20'%20+%20collection);%0A%20%20%7D%0A%20%20if%20(isImmutable(collection))%20%7B%0A%20%20%20%20//%20@ts-expect-error%20weird%20%22set%22%20here,%0A%20%20%20%20if%20(!collection.set)%20%7B%0A%20%20%20%20%20%20throw%20new%20TypeError('Cannot%20update%20immutable%20value%20without%20.set()%20method:%20'%20+%20collection);%0A%20%20%20%20%7D%0A%20%20%20%20//%20@ts-expect-error%20weird%20%22set%22%20here,%0A%20%20%20%20return%20collection.set(key,%20value);%0A%20%20%7D%0A%20%20//%20@ts-expect-error%20mix%20of%20key%20and%20string%20here.%20Probably%20need%20a%20more%20fine%20type%20here%0A%20%20if%20(hasOwnProperty.call(collection,%20key)%20&&%20value%20===%20collection%5Bkey%5D)%20%7B%0A%20%20%20%20return%20collection;%0A%20%20%7D%0A%20%20var%20collectionCopy%20=%20shallowCopy(collection);%0A%20%20//%20@ts-expect-error%20mix%20of%20key%20and%20string%20here.%20Probably%20need%20a%20more%20fine%20type%20here%0A%20%20collectionCopy%5Bkey%5D%20=%20value;%0A%20%20return%20collectionCopy;%0A%7D%0Afunction%20updateIn$1(collection,%20keyPath,%20notSetValue,%20updater)%20%7B%0A%20%20if%20(!updater)%20%7B%0A%20%20%20%20//%20handle%20the%20fact%20that%20%60notSetValue%60%20is%20optional%20here,%20in%20that%20case%20%60updater%60%20is%20the%20updater%20function%0A%20%20%20%20//%20@ts-expect-error%20updater%20is%20a%20function%20here%0A%20%20%20%20updater%20=%20notSetValue;%0A%20%20%20%20notSetValue%20=%20undefined;%0A%20%20%7D%0A%20%20var%20updatedValue%20=%20updateInDeeply(isImmutable(collection),%0A%20%20//%20@ts-expect-error%20type%20issues%20with%20Record%20and%20mixed%20types%0A%20%20collection,%20coerceKeyPath(keyPath),%200,%20notSetValue,%20updater);%0A%20%20//%20@ts-expect-error%20mixed%20return%20type%0A%20%20return%20updatedValue%20===%20NOT_SET%20?%20notSetValue%20:%20updatedValue;%0A%7D%0Afunction%20updateInDeeply(inImmutable,%20existing,%20keyPath,%20i,%20notSetValue,%20updater)%20%7B%0A%20%20var%20wasNotSet%20=%20existing%20===%20NOT_SET;%0A%20%20if%20(i%20===%20keyPath.length)%20%7B%0A%20%20%20%20var%20existingValue%20=%20wasNotSet%20?%20notSetValue%20:%20existing;%0A%20%20%20%20//%20@ts-expect-error%20mixed%20type%20with%20optional%20value%0A%20%20%20%20var%20newValue%20=%20updater(existingValue);%0A%20%20%20%20//%20@ts-expect-error%20mixed%20type%0A%20%20%20%20return%20newValue%20===%20existingValue%20?%20existing%20:%20newValue;%0A%20%20%7D%0A%20%20if%20(!wasNotSet%20&&%20!isDataStructure(existing))%20%7B%0A%20%20%20%20throw%20new%20TypeError('Cannot%20update%20within%20non-data-structure%20value%20in%20path%20%5B'%20+%20Array.from(keyPath).slice(0,%20i).map(quoteString)%20+%20'%5D:%20'%20+%20existing);%0A%20%20%7D%0A%20%20var%20key%20=%20keyPath%5Bi%5D;%0A%20%20var%20nextExisting%20=%20wasNotSet%20?%20NOT_SET%20:%20get(existing,%20key,%20NOT_SET);%0A%20%20var%20nextUpdated%20=%20updateInDeeply(nextExisting%20===%20NOT_SET%20?%20inImmutable%20:%20isImmutable(nextExisting),%0A%20%20//%20@ts-expect-error%20mixed%20type%0A%20%20nextExisting,%20keyPath,%20i%20+%201,%20notSetValue,%20updater);%0A%20%20return%20nextUpdated%20===%20nextExisting%20?%20existing%20:%20nextUpdated%20===%20NOT_SET%20?%20remove(existing,%20key)%20:%20set(wasNotSet%20?%20inImmutable%20?%20emptyMap()%20:%20%7B%7D%20:%20existing,%20key,%20nextUpdated);%0A%7D%0A%0A/**%0A%20*%20Returns%20a%20copy%20of%20the%20collection%20with%20the%20value%20at%20the%20key%20path%20set%20to%20the%0A%20*%20provided%20value.%0A%20*%0A%20*%20A%20functional%20alternative%20to%20%60collection.setIn(keypath)%60%20which%20will%20also%0A%20*%20work%20with%20plain%20Objects%20and%20Arrays.%0A%20*%0A%20*%20%3C!--%20runkit:activate%20--%3E%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20setIn%20%7D%20from%20'immutable';%0A%20*%0A%20*%20const%20original%20=%20%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D%0A%20*%20setIn(original,%20%5B'x',%20'y',%20'z'%5D,%20456)%20//%20%7B%20x:%20%7B%20y:%20%7B%20z:%20456%20%7D%7D%7D%0A%20*%20console.log(original)%20//%20%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D%0A%20*%20%60%60%60%0A%20*/%0Afunction%20setIn$1(collection,%20keyPath,%20value)%20%7B%0A%20%20return%20updateIn$1(collection,%20keyPath,%20NOT_SET,%20function%20()%20%7B%0A%20%20%20%20return%20value;%0A%20%20%7D);%0A%7D%0Afunction%20setIn(keyPath,%20v)%20%7B%0A%20%20return%20setIn$1(this,%20keyPath,%20v);%0A%7D%0A%0A/**%0A%20*%20Returns%20a%20copy%20of%20the%20collection%20with%20the%20value%20at%20the%20key%20path%20removed.%0A%20*%0A%20*%20A%20functional%20alternative%20to%20%60collection.removeIn(keypath)%60%20which%20will%20also%0A%20*%20work%20with%20plain%20Objects%20and%20Arrays.%0A%20*%0A%20*%20%3C!--%20runkit:activate%20--%3E%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20removeIn%20%7D%20from%20'immutable';%0A%20*%0A%20*%20const%20original%20=%20%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D%0A%20*%20removeIn(original,%20%5B'x',%20'y',%20'z'%5D)%20//%20%7B%20x:%20%7B%20y:%20%7B%7D%7D%7D%0A%20*%20console.log(original)%20//%20%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D%0A%20*%20%60%60%60%0A%20*/%0Afunction%20removeIn(collection,%20keyPath)%20%7B%0A%20%20return%20updateIn$1(collection,%20keyPath,%20function%20()%20%7B%0A%20%20%20%20return%20NOT_SET;%0A%20%20%7D);%0A%7D%0Afunction%20deleteIn(keyPath)%20%7B%0A%20%20return%20removeIn(this,%20keyPath);%0A%7D%0Afunction%20update$1(collection,%20key,%20notSetValue,%20updater)%20%7B%0A%20%20return%20updateIn$1(%0A%20%20//%20@ts-expect-error%20Index%20signature%20for%20type%20string%20is%20missing%20in%20type%20V%5B%5D%0A%20%20collection,%20%5Bkey%5D,%20notSetValue,%20updater);%0A%7D%0Afunction%20update(key,%20notSetValue,%20updater)%20%7B%0A%20%20return%20arguments.length%20===%201%20?%20key(this)%20:%20update$1(this,%20key,%20notSetValue,%20updater);%0A%7D%0Afunction%20updateIn(keyPath,%20notSetValue,%20updater)%20%7B%0A%20%20return%20updateIn$1(this,%20keyPath,%20notSetValue,%20updater);%0A%7D%0Afunction%20merge$1()%20%7B%0A%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length;%0A%20%20while%20(len--)%20iters%5Blen%5D%20=%20arguments%5Blen%5D;%0A%20%20return%20mergeIntoKeyedWith(this,%20iters);%0A%7D%0Afunction%20mergeWith$1(merger)%20%7B%0A%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%201;%0A%20%20while%20(len--%20%3E%200)%20iters%5Blen%5D%20=%20arguments%5Blen%20+%201%5D;%0A%20%20if%20(typeof%20merger%20!==%20'function')%20%7B%0A%20%20%20%20throw%20new%20TypeError('Invalid%20merger%20function:%20'%20+%20merger);%0A%20%20%7D%0A%20%20return%20mergeIntoKeyedWith(this,%20iters,%20merger);%0A%7D%0Afunction%20mergeIntoKeyedWith(collection,%20collections,%20merger)%20%7B%0A%20%20var%20iters%20=%20%5B%5D;%0A%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20collections.length;%20ii++)%20%7B%0A%20%20%20%20var%20collection$1%20=%20KeyedCollection(collections%5Bii%5D);%0A%20%20%20%20if%20(collection$1.size%20!==%200)%20%7B%0A%20%20%20%20%20%20iters.push(collection$1);%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20(iters.length%20===%200)%20%7B%0A%20%20%20%20return%20collection;%0A%20%20%7D%0A%20%20if%20(collection.toSeq().size%20===%200%20&&%20!collection.__ownerID%20&&%20iters.length%20===%201)%20%7B%0A%20%20%20%20return%20isRecord(collection)%20?%20collection%20//%20Record%20is%20empty%20and%20will%20not%20be%20updated:%20return%20the%20same%20instance%0A%20%20%20%20:%20collection.constructor(iters%5B0%5D);%0A%20%20%7D%0A%20%20return%20collection.withMutations(function%20(collection)%20%7B%0A%20%20%20%20var%20mergeIntoCollection%20=%20merger%20?%20function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20update$1(collection,%20key,%20NOT_SET,%20function%20(oldVal)%20%7B%0A%20%20%20%20%20%20%20%20return%20oldVal%20===%20NOT_SET%20?%20value%20:%20merger(oldVal,%20value,%20key);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D%20:%20function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20collection.set(key,%20value);%0A%20%20%20%20%7D;%0A%20%20%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20iters.length;%20ii++)%20%7B%0A%20%20%20%20%20%20iters%5Bii%5D.forEach(mergeIntoCollection);%0A%20%20%20%20%7D%0A%20%20%7D);%0A%7D%0Afunction%20merge(collection)%20%7B%0A%20%20var%20sources%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%201;%0A%20%20while%20(len--%20%3E%200)%20sources%5Blen%5D%20=%20arguments%5Blen%20+%201%5D;%0A%20%20return%20mergeWithSources(collection,%20sources);%0A%7D%0Afunction%20mergeWith(merger,%20collection)%20%7B%0A%20%20var%20sources%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%202;%0A%20%20while%20(len--%20%3E%200)%20sources%5Blen%5D%20=%20arguments%5Blen%20+%202%5D;%0A%20%20return%20mergeWithSources(collection,%20sources,%20merger);%0A%7D%0Afunction%20mergeDeep$1(collection)%20%7B%0A%20%20var%20sources%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%201;%0A%20%20while%20(len--%20%3E%200)%20sources%5Blen%5D%20=%20arguments%5Blen%20+%201%5D;%0A%20%20return%20mergeDeepWithSources(collection,%20sources);%0A%7D%0Afunction%20mergeDeepWith$1(merger,%20collection)%20%7B%0A%20%20var%20sources%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%202;%0A%20%20while%20(len--%20%3E%200)%20sources%5Blen%5D%20=%20arguments%5Blen%20+%202%5D;%0A%20%20return%20mergeDeepWithSources(collection,%20sources,%20merger);%0A%7D%0Afunction%20mergeDeepWithSources(collection,%20sources,%20merger)%20%7B%0A%20%20return%20mergeWithSources(collection,%20sources,%20deepMergerWith(merger));%0A%7D%0Afunction%20mergeWithSources(collection,%20sources,%20merger)%20%7B%0A%20%20if%20(!isDataStructure(collection))%20%7B%0A%20%20%20%20throw%20new%20TypeError('Cannot%20merge%20into%20non-data-structure%20value:%20'%20+%20collection);%0A%20%20%7D%0A%20%20if%20(isImmutable(collection))%20%7B%0A%20%20%20%20return%20typeof%20merger%20===%20'function'%20&&%20collection.mergeWith%20?%20collection.mergeWith.apply(collection,%20%5Bmerger%5D.concat(sources))%20:%20collection.merge%20?%20collection.merge.apply(collection,%20sources)%20:%20collection.concat.apply(collection,%20sources);%0A%20%20%7D%0A%20%20var%20isArray%20=%20Array.isArray(collection);%0A%20%20var%20merged%20=%20collection;%0A%20%20var%20Collection%20=%20isArray%20?%20IndexedCollection%20:%20KeyedCollection;%0A%20%20var%20mergeItem%20=%20isArray%20?%20function%20(value)%20%7B%0A%20%20%20%20//%20Copy%20on%20write%0A%20%20%20%20if%20(merged%20===%20collection)%20%7B%0A%20%20%20%20%20%20merged%20=%20shallowCopy(merged);%0A%20%20%20%20%7D%0A%20%20%20%20merged.push(value);%0A%20%20%7D%20:%20function%20(value,%20key)%20%7B%0A%20%20%20%20var%20hasVal%20=%20hasOwnProperty.call(merged,%20key);%0A%20%20%20%20var%20nextVal%20=%20hasVal%20&&%20merger%20?%20merger(merged%5Bkey%5D,%20value,%20key)%20:%20value;%0A%20%20%20%20if%20(!hasVal%20%7C%7C%20nextVal%20!==%20merged%5Bkey%5D)%20%7B%0A%20%20%20%20%20%20//%20Copy%20on%20write%0A%20%20%20%20%20%20if%20(merged%20===%20collection)%20%7B%0A%20%20%20%20%20%20%20%20merged%20=%20shallowCopy(merged);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20merged%5Bkey%5D%20=%20nextVal;%0A%20%20%20%20%7D%0A%20%20%7D;%0A%20%20for%20(var%20i%20=%200;%20i%20%3C%20sources.length;%20i++)%20%7B%0A%20%20%20%20Collection(sources%5Bi%5D).forEach(mergeItem);%0A%20%20%7D%0A%20%20return%20merged;%0A%7D%0Afunction%20deepMergerWith(merger)%20%7B%0A%20%20function%20deepMerger(oldValue,%20newValue,%20key)%20%7B%0A%20%20%20%20return%20isDataStructure(oldValue)%20&&%20isDataStructure(newValue)%20&&%20areMergeable(oldValue,%20newValue)%20?%20mergeWithSources(oldValue,%20%5BnewValue%5D,%20deepMerger)%20:%20merger%20?%20merger(oldValue,%20newValue,%20key)%20:%20newValue;%0A%20%20%7D%0A%20%20return%20deepMerger;%0A%7D%0A%0A/**%0A%20*%20It's%20unclear%20what%20the%20desired%20behavior%20is%20for%20merging%20two%20collections%20that%0A%20*%20fall%20into%20separate%20categories%20between%20keyed,%20indexed,%20or%20set-like,%20so%20we%20only%0A%20*%20consider%20them%20mergeable%20if%20they%20fall%20into%20the%20same%20category.%0A%20*/%0Afunction%20areMergeable(oldDataStructure,%20newDataStructure)%20%7B%0A%20%20var%20oldSeq%20=%20Seq(oldDataStructure);%0A%20%20var%20newSeq%20=%20Seq(newDataStructure);%0A%20%20//%20This%20logic%20assumes%20that%20a%20sequence%20can%20only%20fall%20into%20one%20of%20the%20three%0A%20%20//%20categories%20mentioned%20above%20(since%20there's%20no%20%60isSetLike()%60%20method).%0A%20%20return%20isIndexed(oldSeq)%20===%20isIndexed(newSeq)%20&&%20isKeyed(oldSeq)%20===%20isKeyed(newSeq);%0A%7D%0Afunction%20mergeDeep()%20%7B%0A%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length;%0A%20%20while%20(len--)%20iters%5Blen%5D%20=%20arguments%5Blen%5D;%0A%20%20return%20mergeDeepWithSources(this,%20iters);%0A%7D%0Afunction%20mergeDeepWith(merger)%20%7B%0A%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%201;%0A%20%20while%20(len--%20%3E%200)%20iters%5Blen%5D%20=%20arguments%5Blen%20+%201%5D;%0A%20%20return%20mergeDeepWithSources(this,%20iters,%20merger);%0A%7D%0Afunction%20mergeIn(keyPath)%20%7B%0A%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%201;%0A%20%20while%20(len--%20%3E%200)%20iters%5Blen%5D%20=%20arguments%5Blen%20+%201%5D;%0A%20%20return%20updateIn$1(this,%20keyPath,%20emptyMap(),%20function%20(m)%20%7B%0A%20%20%20%20return%20mergeWithSources(m,%20iters);%0A%20%20%7D);%0A%7D%0Afunction%20mergeDeepIn(keyPath)%20%7B%0A%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20len%20=%20arguments.length%20-%201;%0A%20%20while%20(len--%20%3E%200)%20iters%5Blen%5D%20=%20arguments%5Blen%20+%201%5D;%0A%20%20return%20updateIn$1(this,%20keyPath,%20emptyMap(),%20function%20(m)%20%7B%0A%20%20%20%20return%20mergeDeepWithSources(m,%20iters);%0A%20%20%7D);%0A%7D%0Afunction%20withMutations(fn)%20%7B%0A%20%20var%20mutable%20=%20this.asMutable();%0A%20%20fn(mutable);%0A%20%20return%20mutable.wasAltered()%20?%20mutable.__ensureOwner(this.__ownerID)%20:%20this;%0A%7D%0Afunction%20asMutable()%20%7B%0A%20%20return%20this.__ownerID%20?%20this%20:%20this.__ensureOwner(new%20OwnerID());%0A%7D%0Afunction%20asImmutable()%20%7B%0A%20%20return%20this.__ensureOwner();%0A%7D%0Afunction%20wasAltered()%20%7B%0A%20%20return%20this.__altered;%0A%7D%0Avar%20Map%20=%20/*@__PURE__*/function%20(KeyedCollection)%20%7B%0A%20%20function%20Map(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptyMap()%20:%20isMap(value)%20&&%20!isOrdered(value)%20?%20value%20:%20emptyMap().withMutations(function%20(map)%20%7B%0A%20%20%20%20%20%20var%20iter%20=%20KeyedCollection(value);%0A%20%20%20%20%20%20assertNotInfinite(iter.size);%0A%20%20%20%20%20%20iter.forEach(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20%20%20return%20map.set(k,%20v);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D%0A%20%20if%20(KeyedCollection)%20Map.__proto__%20=%20KeyedCollection;%0A%20%20Map.prototype%20=%20Object.create(KeyedCollection%20&&%20KeyedCollection.prototype);%0A%20%20Map.prototype.constructor%20=%20Map;%0A%20%20Map.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('Map%20%7B',%20'%7D');%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Access%0A%0A%20%20Map.prototype.get%20=%20function%20get(k,%20notSetValue)%20%7B%0A%20%20%20%20return%20this._root%20?%20this._root.get(0,%20undefined,%20k,%20notSetValue)%20:%20notSetValue;%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Modification%0A%0A%20%20Map.prototype.set%20=%20function%20set(k,%20v)%20%7B%0A%20%20%20%20return%20updateMap(this,%20k,%20v);%0A%20%20%7D;%0A%20%20Map.prototype.remove%20=%20function%20remove(k)%20%7B%0A%20%20%20%20return%20updateMap(this,%20k,%20NOT_SET);%0A%20%20%7D;%0A%20%20Map.prototype.deleteAll%20=%20function%20deleteAll(keys)%20%7B%0A%20%20%20%20var%20collection%20=%20Collection(keys);%0A%20%20%20%20if%20(collection.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.withMutations(function%20(map)%20%7B%0A%20%20%20%20%20%20collection.forEach(function%20(key)%20%7B%0A%20%20%20%20%20%20%20%20return%20map.remove(key);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20Map.prototype.clear%20=%20function%20clear()%20%7B%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.__ownerID)%20%7B%0A%20%20%20%20%20%20this.size%20=%200;%0A%20%20%20%20%20%20this._root%20=%20null;%0A%20%20%20%20%20%20this.__hash%20=%20undefined;%0A%20%20%20%20%20%20this.__altered%20=%20true;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20emptyMap();%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Composition%0A%0A%20%20Map.prototype.sort%20=%20function%20sort(comparator)%20%7B%0A%20%20%20%20//%20Late%20binding%0A%20%20%20%20return%20OrderedMap(sortFactory(this,%20comparator));%0A%20%20%7D;%0A%20%20Map.prototype.sortBy%20=%20function%20sortBy(mapper,%20comparator)%20%7B%0A%20%20%20%20//%20Late%20binding%0A%20%20%20%20return%20OrderedMap(sortFactory(this,%20comparator,%20mapper));%0A%20%20%7D;%0A%20%20Map.prototype.map%20=%20function%20map(mapper,%20context)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20this.withMutations(function%20(map)%20%7B%0A%20%20%20%20%20%20map.forEach(function%20(value,%20key)%20%7B%0A%20%20%20%20%20%20%20%20map.set(key,%20mapper.call(context,%20value,%20key,%20this$1$1));%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Mutability%0A%0A%20%20Map.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20return%20new%20MapIterator(this,%20type,%20reverse);%0A%20%20%7D;%0A%20%20Map.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20this._root%20&&%20this._root.iterate(function%20(entry)%20%7B%0A%20%20%20%20%20%20iterations++;%0A%20%20%20%20%20%20return%20fn(entry%5B1%5D,%20entry%5B0%5D,%20this$1$1);%0A%20%20%20%20%7D,%20reverse);%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20Map.prototype.__ensureOwner%20=%20function%20__ensureOwner(ownerID)%20%7B%0A%20%20%20%20if%20(ownerID%20===%20this.__ownerID)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!ownerID)%20%7B%0A%20%20%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20%20%20return%20emptyMap();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.__ownerID%20=%20ownerID;%0A%20%20%20%20%20%20this.__altered%20=%20false;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20makeMap(this.size,%20this._root,%20ownerID,%20this.__hash);%0A%20%20%7D;%0A%20%20return%20Map;%0A%7D(KeyedCollection);%0AMap.isMap%20=%20isMap;%0Avar%20MapPrototype%20=%20Map.prototype;%0AMapPrototype%5BIS_MAP_SYMBOL%5D%20=%20true;%0AMapPrototype%5BDELETE%5D%20=%20MapPrototype.remove;%0AMapPrototype.removeAll%20=%20MapPrototype.deleteAll;%0AMapPrototype.setIn%20=%20setIn;%0AMapPrototype.removeIn%20=%20MapPrototype.deleteIn%20=%20deleteIn;%0AMapPrototype.update%20=%20update;%0AMapPrototype.updateIn%20=%20updateIn;%0AMapPrototype.merge%20=%20MapPrototype.concat%20=%20merge$1;%0AMapPrototype.mergeWith%20=%20mergeWith$1;%0AMapPrototype.mergeDeep%20=%20mergeDeep;%0AMapPrototype.mergeDeepWith%20=%20mergeDeepWith;%0AMapPrototype.mergeIn%20=%20mergeIn;%0AMapPrototype.mergeDeepIn%20=%20mergeDeepIn;%0AMapPrototype.withMutations%20=%20withMutations;%0AMapPrototype.wasAltered%20=%20wasAltered;%0AMapPrototype.asImmutable%20=%20asImmutable;%0AMapPrototype%5B'@@transducer/init'%5D%20=%20MapPrototype.asMutable%20=%20asMutable;%0AMapPrototype%5B'@@transducer/step'%5D%20=%20function%20(result,%20arr)%20%7B%0A%20%20return%20result.set(arr%5B0%5D,%20arr%5B1%5D);%0A%7D;%0AMapPrototype%5B'@@transducer/result'%5D%20=%20function%20(obj)%20%7B%0A%20%20return%20obj.asImmutable();%0A%7D;%0A%0A//%20#pragma%20Trie%20Nodes%0A%0Avar%20ArrayMapNode%20=%20function%20ArrayMapNode(ownerID,%20entries)%20%7B%0A%20%20this.ownerID%20=%20ownerID;%0A%20%20this.entries%20=%20entries;%0A%7D;%0AArrayMapNode.prototype.get%20=%20function%20get(shift,%20keyHash,%20key,%20notSetValue)%20%7B%0A%20%20var%20entries%20=%20this.entries;%0A%20%20for%20(var%20ii%20=%200,%20len%20=%20entries.length;%20ii%20%3C%20len;%20ii++)%20%7B%0A%20%20%20%20if%20(is(key,%20entries%5Bii%5D%5B0%5D))%20%7B%0A%20%20%20%20%20%20return%20entries%5Bii%5D%5B1%5D;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20notSetValue;%0A%7D;%0AArrayMapNode.prototype.update%20=%20function%20update(ownerID,%20shift,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter)%20%7B%0A%20%20var%20removed%20=%20value%20===%20NOT_SET;%0A%20%20var%20entries%20=%20this.entries;%0A%20%20var%20idx%20=%200;%0A%20%20var%20len%20=%20entries.length;%0A%20%20for%20(;%20idx%20%3C%20len;%20idx++)%20%7B%0A%20%20%20%20if%20(is(key,%20entries%5Bidx%5D%5B0%5D))%20%7B%0A%20%20%20%20%20%20break;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20var%20exists%20=%20idx%20%3C%20len;%0A%20%20if%20(exists%20?%20entries%5Bidx%5D%5B1%5D%20===%20value%20:%20removed)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20SetRef(didAlter);%0A%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20(removed%20%7C%7C%20!exists)%20&&%20SetRef(didChangeSize);%0A%20%20if%20(removed%20&&%20entries.length%20===%201)%20%7B%0A%20%20%20%20return;%20//%20undefined%0A%20%20%7D%0A%20%20if%20(!exists%20&&%20!removed%20&&%20entries.length%20%3E=%20MAX_ARRAY_MAP_SIZE)%20%7B%0A%20%20%20%20return%20createNodes(ownerID,%20entries,%20key,%20value);%0A%20%20%7D%0A%20%20var%20isEditable%20=%20ownerID%20&&%20ownerID%20===%20this.ownerID;%0A%20%20var%20newEntries%20=%20isEditable%20?%20entries%20:%20arrCopy(entries);%0A%20%20if%20(exists)%20%7B%0A%20%20%20%20if%20(removed)%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20%20%20idx%20===%20len%20-%201%20?%20newEntries.pop()%20:%20newEntries%5Bidx%5D%20=%20newEntries.pop();%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20newEntries%5Bidx%5D%20=%20%5Bkey,%20value%5D;%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20newEntries.push(%5Bkey,%20value%5D);%0A%20%20%7D%0A%20%20if%20(isEditable)%20%7B%0A%20%20%20%20this.entries%20=%20newEntries;%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20return%20new%20ArrayMapNode(ownerID,%20newEntries);%0A%7D;%0Avar%20BitmapIndexedNode%20=%20function%20BitmapIndexedNode(ownerID,%20bitmap,%20nodes)%20%7B%0A%20%20this.ownerID%20=%20ownerID;%0A%20%20this.bitmap%20=%20bitmap;%0A%20%20this.nodes%20=%20nodes;%0A%7D;%0ABitmapIndexedNode.prototype.get%20=%20function%20get(shift,%20keyHash,%20key,%20notSetValue)%20%7B%0A%20%20if%20(keyHash%20===%20undefined)%20%7B%0A%20%20%20%20keyHash%20=%20hash(key);%0A%20%20%7D%0A%20%20var%20bit%20=%201%20%3C%3C%20((shift%20===%200%20?%20keyHash%20:%20keyHash%20%3E%3E%3E%20shift)%20&%20MASK);%0A%20%20var%20bitmap%20=%20this.bitmap;%0A%20%20return%20(bitmap%20&%20bit)%20===%200%20?%20notSetValue%20:%20this.nodes%5BpopCount(bitmap%20&%20bit%20-%201)%5D.get(shift%20+%20SHIFT,%20keyHash,%20key,%20notSetValue);%0A%7D;%0ABitmapIndexedNode.prototype.update%20=%20function%20update(ownerID,%20shift,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter)%20%7B%0A%20%20if%20(keyHash%20===%20undefined)%20%7B%0A%20%20%20%20keyHash%20=%20hash(key);%0A%20%20%7D%0A%20%20var%20keyHashFrag%20=%20(shift%20===%200%20?%20keyHash%20:%20keyHash%20%3E%3E%3E%20shift)%20&%20MASK;%0A%20%20var%20bit%20=%201%20%3C%3C%20keyHashFrag;%0A%20%20var%20bitmap%20=%20this.bitmap;%0A%20%20var%20exists%20=%20(bitmap%20&%20bit)%20!==%200;%0A%20%20if%20(!exists%20&&%20value%20===%20NOT_SET)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20idx%20=%20popCount(bitmap%20&%20bit%20-%201);%0A%20%20var%20nodes%20=%20this.nodes;%0A%20%20var%20node%20=%20exists%20?%20nodes%5Bidx%5D%20:%20undefined;%0A%20%20var%20newNode%20=%20updateNode(node,%20ownerID,%20shift%20+%20SHIFT,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter);%0A%20%20if%20(newNode%20===%20node)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20if%20(!exists%20&&%20newNode%20&&%20nodes.length%20%3E=%20MAX_BITMAP_INDEXED_SIZE)%20%7B%0A%20%20%20%20return%20expandNodes(ownerID,%20nodes,%20bitmap,%20keyHashFrag,%20newNode);%0A%20%20%7D%0A%20%20if%20(exists%20&&%20!newNode%20&&%20nodes.length%20===%202%20&&%20isLeafNode(nodes%5Bidx%20%5E%201%5D))%20%7B%0A%20%20%20%20return%20nodes%5Bidx%20%5E%201%5D;%0A%20%20%7D%0A%20%20if%20(exists%20&&%20newNode%20&&%20nodes.length%20===%201%20&&%20isLeafNode(newNode))%20%7B%0A%20%20%20%20return%20newNode;%0A%20%20%7D%0A%20%20var%20isEditable%20=%20ownerID%20&&%20ownerID%20===%20this.ownerID;%0A%20%20var%20newBitmap%20=%20exists%20?%20newNode%20?%20bitmap%20:%20bitmap%20%5E%20bit%20:%20bitmap%20%7C%20bit;%0A%20%20var%20newNodes%20=%20exists%20?%20newNode%20?%20setAt(nodes,%20idx,%20newNode,%20isEditable)%20:%20spliceOut(nodes,%20idx,%20isEditable)%20:%20spliceIn(nodes,%20idx,%20newNode,%20isEditable);%0A%20%20if%20(isEditable)%20%7B%0A%20%20%20%20this.bitmap%20=%20newBitmap;%0A%20%20%20%20this.nodes%20=%20newNodes;%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20return%20new%20BitmapIndexedNode(ownerID,%20newBitmap,%20newNodes);%0A%7D;%0Avar%20HashArrayMapNode%20=%20function%20HashArrayMapNode(ownerID,%20count,%20nodes)%20%7B%0A%20%20this.ownerID%20=%20ownerID;%0A%20%20this.count%20=%20count;%0A%20%20this.nodes%20=%20nodes;%0A%7D;%0AHashArrayMapNode.prototype.get%20=%20function%20get(shift,%20keyHash,%20key,%20notSetValue)%20%7B%0A%20%20if%20(keyHash%20===%20undefined)%20%7B%0A%20%20%20%20keyHash%20=%20hash(key);%0A%20%20%7D%0A%20%20var%20idx%20=%20(shift%20===%200%20?%20keyHash%20:%20keyHash%20%3E%3E%3E%20shift)%20&%20MASK;%0A%20%20var%20node%20=%20this.nodes%5Bidx%5D;%0A%20%20return%20node%20?%20node.get(shift%20+%20SHIFT,%20keyHash,%20key,%20notSetValue)%20:%20notSetValue;%0A%7D;%0AHashArrayMapNode.prototype.update%20=%20function%20update(ownerID,%20shift,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter)%20%7B%0A%20%20if%20(keyHash%20===%20undefined)%20%7B%0A%20%20%20%20keyHash%20=%20hash(key);%0A%20%20%7D%0A%20%20var%20idx%20=%20(shift%20===%200%20?%20keyHash%20:%20keyHash%20%3E%3E%3E%20shift)%20&%20MASK;%0A%20%20var%20removed%20=%20value%20===%20NOT_SET;%0A%20%20var%20nodes%20=%20this.nodes;%0A%20%20var%20node%20=%20nodes%5Bidx%5D;%0A%20%20if%20(removed%20&&%20!node)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20newNode%20=%20updateNode(node,%20ownerID,%20shift%20+%20SHIFT,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter);%0A%20%20if%20(newNode%20===%20node)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20newCount%20=%20this.count;%0A%20%20if%20(!node)%20%7B%0A%20%20%20%20newCount++;%0A%20%20%7D%20else%20if%20(!newNode)%20%7B%0A%20%20%20%20newCount--;%0A%20%20%20%20if%20(newCount%20%3C%20MIN_HASH_ARRAY_MAP_SIZE)%20%7B%0A%20%20%20%20%20%20return%20packNodes(ownerID,%20nodes,%20newCount,%20idx);%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20var%20isEditable%20=%20ownerID%20&&%20ownerID%20===%20this.ownerID;%0A%20%20var%20newNodes%20=%20setAt(nodes,%20idx,%20newNode,%20isEditable);%0A%20%20if%20(isEditable)%20%7B%0A%20%20%20%20this.count%20=%20newCount;%0A%20%20%20%20this.nodes%20=%20newNodes;%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20return%20new%20HashArrayMapNode(ownerID,%20newCount,%20newNodes);%0A%7D;%0Avar%20HashCollisionNode%20=%20function%20HashCollisionNode(ownerID,%20keyHash,%20entries)%20%7B%0A%20%20this.ownerID%20=%20ownerID;%0A%20%20this.keyHash%20=%20keyHash;%0A%20%20this.entries%20=%20entries;%0A%7D;%0AHashCollisionNode.prototype.get%20=%20function%20get(shift,%20keyHash,%20key,%20notSetValue)%20%7B%0A%20%20var%20entries%20=%20this.entries;%0A%20%20for%20(var%20ii%20=%200,%20len%20=%20entries.length;%20ii%20%3C%20len;%20ii++)%20%7B%0A%20%20%20%20if%20(is(key,%20entries%5Bii%5D%5B0%5D))%20%7B%0A%20%20%20%20%20%20return%20entries%5Bii%5D%5B1%5D;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20notSetValue;%0A%7D;%0AHashCollisionNode.prototype.update%20=%20function%20update(ownerID,%20shift,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter)%20%7B%0A%20%20if%20(keyHash%20===%20undefined)%20%7B%0A%20%20%20%20keyHash%20=%20hash(key);%0A%20%20%7D%0A%20%20var%20removed%20=%20value%20===%20NOT_SET;%0A%20%20if%20(keyHash%20!==%20this.keyHash)%20%7B%0A%20%20%20%20if%20(removed)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20SetRef(didAlter);%0A%20%20%20%20SetRef(didChangeSize);%0A%20%20%20%20return%20mergeIntoNode(this,%20ownerID,%20shift,%20keyHash,%20%5Bkey,%20value%5D);%0A%20%20%7D%0A%20%20var%20entries%20=%20this.entries;%0A%20%20var%20idx%20=%200;%0A%20%20var%20len%20=%20entries.length;%0A%20%20for%20(;%20idx%20%3C%20len;%20idx++)%20%7B%0A%20%20%20%20if%20(is(key,%20entries%5Bidx%5D%5B0%5D))%20%7B%0A%20%20%20%20%20%20break;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20var%20exists%20=%20idx%20%3C%20len;%0A%20%20if%20(exists%20?%20entries%5Bidx%5D%5B1%5D%20===%20value%20:%20removed)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20SetRef(didAlter);%0A%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20(removed%20%7C%7C%20!exists)%20&&%20SetRef(didChangeSize);%0A%20%20if%20(removed%20&&%20len%20===%202)%20%7B%0A%20%20%20%20return%20new%20ValueNode(ownerID,%20this.keyHash,%20entries%5Bidx%20%5E%201%5D);%0A%20%20%7D%0A%20%20var%20isEditable%20=%20ownerID%20&&%20ownerID%20===%20this.ownerID;%0A%20%20var%20newEntries%20=%20isEditable%20?%20entries%20:%20arrCopy(entries);%0A%20%20if%20(exists)%20%7B%0A%20%20%20%20if%20(removed)%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20%20%20idx%20===%20len%20-%201%20?%20newEntries.pop()%20:%20newEntries%5Bidx%5D%20=%20newEntries.pop();%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20newEntries%5Bidx%5D%20=%20%5Bkey,%20value%5D;%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20newEntries.push(%5Bkey,%20value%5D);%0A%20%20%7D%0A%20%20if%20(isEditable)%20%7B%0A%20%20%20%20this.entries%20=%20newEntries;%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20return%20new%20HashCollisionNode(ownerID,%20this.keyHash,%20newEntries);%0A%7D;%0Avar%20ValueNode%20=%20function%20ValueNode(ownerID,%20keyHash,%20entry)%20%7B%0A%20%20this.ownerID%20=%20ownerID;%0A%20%20this.keyHash%20=%20keyHash;%0A%20%20this.entry%20=%20entry;%0A%7D;%0AValueNode.prototype.get%20=%20function%20get(shift,%20keyHash,%20key,%20notSetValue)%20%7B%0A%20%20return%20is(key,%20this.entry%5B0%5D)%20?%20this.entry%5B1%5D%20:%20notSetValue;%0A%7D;%0AValueNode.prototype.update%20=%20function%20update(ownerID,%20shift,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter)%20%7B%0A%20%20var%20removed%20=%20value%20===%20NOT_SET;%0A%20%20var%20keyMatch%20=%20is(key,%20this.entry%5B0%5D);%0A%20%20if%20(keyMatch%20?%20value%20===%20this.entry%5B1%5D%20:%20removed)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20SetRef(didAlter);%0A%20%20if%20(removed)%20%7B%0A%20%20%20%20SetRef(didChangeSize);%0A%20%20%20%20return;%20//%20undefined%0A%20%20%7D%0A%20%20if%20(keyMatch)%20%7B%0A%20%20%20%20if%20(ownerID%20&&%20ownerID%20===%20this.ownerID)%20%7B%0A%20%20%20%20%20%20this.entry%5B1%5D%20=%20value;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20new%20ValueNode(ownerID,%20this.keyHash,%20%5Bkey,%20value%5D);%0A%20%20%7D%0A%20%20SetRef(didChangeSize);%0A%20%20return%20mergeIntoNode(this,%20ownerID,%20shift,%20hash(key),%20%5Bkey,%20value%5D);%0A%7D;%0A%0A//%20#pragma%20Iterators%0A%0AArrayMapNode.prototype.iterate%20=%20HashCollisionNode.prototype.iterate%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20var%20entries%20=%20this.entries;%0A%20%20for%20(var%20ii%20=%200,%20maxIndex%20=%20entries.length%20-%201;%20ii%20%3C=%20maxIndex;%20ii++)%20%7B%0A%20%20%20%20if%20(fn(entries%5Breverse%20?%20maxIndex%20-%20ii%20:%20ii%5D)%20===%20false)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D;%0ABitmapIndexedNode.prototype.iterate%20=%20HashArrayMapNode.prototype.iterate%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20var%20nodes%20=%20this.nodes;%0A%20%20for%20(var%20ii%20=%200,%20maxIndex%20=%20nodes.length%20-%201;%20ii%20%3C=%20maxIndex;%20ii++)%20%7B%0A%20%20%20%20var%20node%20=%20nodes%5Breverse%20?%20maxIndex%20-%20ii%20:%20ii%5D;%0A%20%20%20%20if%20(node%20&&%20node.iterate(fn,%20reverse)%20===%20false)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D;%0A%0A//%20eslint-disable-next-line%20@typescript-eslint/no-unused-vars%0AValueNode.prototype.iterate%20=%20function%20(fn,%20reverse)%20%7B%0A%20%20return%20fn(this.entry);%0A%7D;%0Avar%20MapIterator%20=%20/*@__PURE__*/function%20(Iterator)%20%7B%0A%20%20function%20MapIterator(map,%20type,%20reverse)%20%7B%0A%20%20%20%20this._type%20=%20type;%0A%20%20%20%20this._reverse%20=%20reverse;%0A%20%20%20%20this._stack%20=%20map._root%20&&%20mapIteratorFrame(map._root);%0A%20%20%7D%0A%20%20if%20(Iterator)%20MapIterator.__proto__%20=%20Iterator;%0A%20%20MapIterator.prototype%20=%20Object.create(Iterator%20&&%20Iterator.prototype);%0A%20%20MapIterator.prototype.constructor%20=%20MapIterator;%0A%20%20MapIterator.prototype.next%20=%20function%20next()%20%7B%0A%20%20%20%20var%20type%20=%20this._type;%0A%20%20%20%20var%20stack%20=%20this._stack;%0A%20%20%20%20while%20(stack)%20%7B%0A%20%20%20%20%20%20var%20node%20=%20stack.node;%0A%20%20%20%20%20%20var%20index%20=%20stack.index++;%0A%20%20%20%20%20%20var%20maxIndex%20=%20void%200;%0A%20%20%20%20%20%20if%20(node.entry)%20%7B%0A%20%20%20%20%20%20%20%20if%20(index%20===%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20mapIteratorValue(type,%20node.entry);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20(node.entries)%20%7B%0A%20%20%20%20%20%20%20%20maxIndex%20=%20node.entries.length%20-%201;%0A%20%20%20%20%20%20%20%20if%20(index%20%3C=%20maxIndex)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20mapIteratorValue(type,%20node.entries%5Bthis._reverse%20?%20maxIndex%20-%20index%20:%20index%5D);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20maxIndex%20=%20node.nodes.length%20-%201;%0A%20%20%20%20%20%20%20%20if%20(index%20%3C=%20maxIndex)%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20subNode%20=%20node.nodes%5Bthis._reverse%20?%20maxIndex%20-%20index%20:%20index%5D;%0A%20%20%20%20%20%20%20%20%20%20if%20(subNode)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(subNode.entry)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20mapIteratorValue(type,%20subNode.entry);%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20stack%20=%20this._stack%20=%20mapIteratorFrame(subNode,%20stack);%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20continue;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20stack%20=%20this._stack%20=%20this._stack.__prev;%0A%20%20%20%20%7D%0A%20%20%20%20return%20iteratorDone();%0A%20%20%7D;%0A%20%20return%20MapIterator;%0A%7D(Iterator);%0Afunction%20mapIteratorValue(type,%20entry)%20%7B%0A%20%20return%20iteratorValue(type,%20entry%5B0%5D,%20entry%5B1%5D);%0A%7D%0Afunction%20mapIteratorFrame(node,%20prev)%20%7B%0A%20%20return%20%7B%0A%20%20%20%20node:%20node,%0A%20%20%20%20index:%200,%0A%20%20%20%20__prev:%20prev%0A%20%20%7D;%0A%7D%0Afunction%20makeMap(size,%20root,%20ownerID,%20hash)%20%7B%0A%20%20var%20map%20=%20Object.create(MapPrototype);%0A%20%20map.size%20=%20size;%0A%20%20map._root%20=%20root;%0A%20%20map.__ownerID%20=%20ownerID;%0A%20%20map.__hash%20=%20hash;%0A%20%20map.__altered%20=%20false;%0A%20%20return%20map;%0A%7D%0Avar%20EMPTY_MAP;%0Afunction%20emptyMap()%20%7B%0A%20%20return%20EMPTY_MAP%20%7C%7C%20(EMPTY_MAP%20=%20makeMap(0));%0A%7D%0Afunction%20updateMap(map,%20k,%20v)%20%7B%0A%20%20var%20newRoot;%0A%20%20var%20newSize;%0A%20%20if%20(!map._root)%20%7B%0A%20%20%20%20if%20(v%20===%20NOT_SET)%20%7B%0A%20%20%20%20%20%20return%20map;%0A%20%20%20%20%7D%0A%20%20%20%20newSize%20=%201;%0A%20%20%20%20newRoot%20=%20new%20ArrayMapNode(map.__ownerID,%20%5B%5Bk,%20v%5D%5D);%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20didChangeSize%20=%20MakeRef();%0A%20%20%20%20var%20didAlter%20=%20MakeRef();%0A%20%20%20%20newRoot%20=%20updateNode(map._root,%20map.__ownerID,%200,%20undefined,%20k,%20v,%20didChangeSize,%20didAlter);%0A%20%20%20%20if%20(!didAlter.value)%20%7B%0A%20%20%20%20%20%20return%20map;%0A%20%20%20%20%7D%0A%20%20%20%20newSize%20=%20map.size%20+%20(didChangeSize.value%20?%20v%20===%20NOT_SET%20?%20-1%20:%201%20:%200);%0A%20%20%7D%0A%20%20if%20(map.__ownerID)%20%7B%0A%20%20%20%20map.size%20=%20newSize;%0A%20%20%20%20map._root%20=%20newRoot;%0A%20%20%20%20map.__hash%20=%20undefined;%0A%20%20%20%20map.__altered%20=%20true;%0A%20%20%20%20return%20map;%0A%20%20%7D%0A%20%20return%20newRoot%20?%20makeMap(newSize,%20newRoot)%20:%20emptyMap();%0A%7D%0Afunction%20updateNode(node,%20ownerID,%20shift,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter)%20%7B%0A%20%20if%20(!node)%20%7B%0A%20%20%20%20if%20(value%20===%20NOT_SET)%20%7B%0A%20%20%20%20%20%20return%20node;%0A%20%20%20%20%7D%0A%20%20%20%20SetRef(didAlter);%0A%20%20%20%20SetRef(didChangeSize);%0A%20%20%20%20return%20new%20ValueNode(ownerID,%20keyHash,%20%5Bkey,%20value%5D);%0A%20%20%7D%0A%20%20return%20node.update(ownerID,%20shift,%20keyHash,%20key,%20value,%20didChangeSize,%20didAlter);%0A%7D%0Afunction%20isLeafNode(node)%20%7B%0A%20%20return%20node.constructor%20===%20ValueNode%20%7C%7C%20node.constructor%20===%20HashCollisionNode;%0A%7D%0Afunction%20mergeIntoNode(node,%20ownerID,%20shift,%20keyHash,%20entry)%20%7B%0A%20%20if%20(node.keyHash%20===%20keyHash)%20%7B%0A%20%20%20%20return%20new%20HashCollisionNode(ownerID,%20keyHash,%20%5Bnode.entry,%20entry%5D);%0A%20%20%7D%0A%20%20var%20idx1%20=%20(shift%20===%200%20?%20node.keyHash%20:%20node.keyHash%20%3E%3E%3E%20shift)%20&%20MASK;%0A%20%20var%20idx2%20=%20(shift%20===%200%20?%20keyHash%20:%20keyHash%20%3E%3E%3E%20shift)%20&%20MASK;%0A%20%20var%20newNode;%0A%20%20var%20nodes%20=%20idx1%20===%20idx2%20?%20%5BmergeIntoNode(node,%20ownerID,%20shift%20+%20SHIFT,%20keyHash,%20entry)%5D%20:%20(newNode%20=%20new%20ValueNode(ownerID,%20keyHash,%20entry),%20idx1%20%3C%20idx2%20?%20%5Bnode,%20newNode%5D%20:%20%5BnewNode,%20node%5D);%0A%20%20return%20new%20BitmapIndexedNode(ownerID,%201%20%3C%3C%20idx1%20%7C%201%20%3C%3C%20idx2,%20nodes);%0A%7D%0Afunction%20createNodes(ownerID,%20entries,%20key,%20value)%20%7B%0A%20%20if%20(!ownerID)%20%7B%0A%20%20%20%20ownerID%20=%20new%20OwnerID();%0A%20%20%7D%0A%20%20var%20node%20=%20new%20ValueNode(ownerID,%20hash(key),%20%5Bkey,%20value%5D);%0A%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20entries.length;%20ii++)%20%7B%0A%20%20%20%20var%20entry%20=%20entries%5Bii%5D;%0A%20%20%20%20node%20=%20node.update(ownerID,%200,%20undefined,%20entry%5B0%5D,%20entry%5B1%5D);%0A%20%20%7D%0A%20%20return%20node;%0A%7D%0Afunction%20packNodes(ownerID,%20nodes,%20count,%20excluding)%20%7B%0A%20%20var%20bitmap%20=%200;%0A%20%20var%20packedII%20=%200;%0A%20%20var%20packedNodes%20=%20new%20Array(count);%0A%20%20for%20(var%20ii%20=%200,%20bit%20=%201,%20len%20=%20nodes.length;%20ii%20%3C%20len;%20ii++,%20bit%20%3C%3C=%201)%20%7B%0A%20%20%20%20var%20node%20=%20nodes%5Bii%5D;%0A%20%20%20%20if%20(node%20!==%20undefined%20&&%20ii%20!==%20excluding)%20%7B%0A%20%20%20%20%20%20bitmap%20%7C=%20bit;%0A%20%20%20%20%20%20packedNodes%5BpackedII++%5D%20=%20node;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20new%20BitmapIndexedNode(ownerID,%20bitmap,%20packedNodes);%0A%7D%0Afunction%20expandNodes(ownerID,%20nodes,%20bitmap,%20including,%20node)%20%7B%0A%20%20var%20count%20=%200;%0A%20%20var%20expandedNodes%20=%20new%20Array(SIZE);%0A%20%20for%20(var%20ii%20=%200;%20bitmap%20!==%200;%20ii++,%20bitmap%20%3E%3E%3E=%201)%20%7B%0A%20%20%20%20expandedNodes%5Bii%5D%20=%20bitmap%20&%201%20?%20nodes%5Bcount++%5D%20:%20undefined;%0A%20%20%7D%0A%20%20expandedNodes%5Bincluding%5D%20=%20node;%0A%20%20return%20new%20HashArrayMapNode(ownerID,%20count%20+%201,%20expandedNodes);%0A%7D%0Afunction%20popCount(x)%20%7B%0A%20%20x%20-=%20x%20%3E%3E%201%20&%200x55555555;%0A%20%20x%20=%20(x%20&%200x33333333)%20+%20(x%20%3E%3E%202%20&%200x33333333);%0A%20%20x%20=%20x%20+%20(x%20%3E%3E%204)%20&%200x0f0f0f0f;%0A%20%20x%20+=%20x%20%3E%3E%208;%0A%20%20x%20+=%20x%20%3E%3E%2016;%0A%20%20return%20x%20&%200x7f;%0A%7D%0Afunction%20setAt(array,%20idx,%20val,%20canEdit)%20%7B%0A%20%20var%20newArray%20=%20canEdit%20?%20array%20:%20arrCopy(array);%0A%20%20newArray%5Bidx%5D%20=%20val;%0A%20%20return%20newArray;%0A%7D%0Afunction%20spliceIn(array,%20idx,%20val,%20canEdit)%20%7B%0A%20%20var%20newLen%20=%20array.length%20+%201;%0A%20%20if%20(canEdit%20&&%20idx%20+%201%20===%20newLen)%20%7B%0A%20%20%20%20array%5Bidx%5D%20=%20val;%0A%20%20%20%20return%20array;%0A%20%20%7D%0A%20%20var%20newArray%20=%20new%20Array(newLen);%0A%20%20var%20after%20=%200;%0A%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20newLen;%20ii++)%20%7B%0A%20%20%20%20if%20(ii%20===%20idx)%20%7B%0A%20%20%20%20%20%20newArray%5Bii%5D%20=%20val;%0A%20%20%20%20%20%20after%20=%20-1;%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20newArray%5Bii%5D%20=%20array%5Bii%20+%20after%5D;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20newArray;%0A%7D%0Afunction%20spliceOut(array,%20idx,%20canEdit)%20%7B%0A%20%20var%20newLen%20=%20array.length%20-%201;%0A%20%20if%20(canEdit%20&&%20idx%20===%20newLen)%20%7B%0A%20%20%20%20array.pop();%0A%20%20%20%20return%20array;%0A%20%20%7D%0A%20%20var%20newArray%20=%20new%20Array(newLen);%0A%20%20var%20after%20=%200;%0A%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20newLen;%20ii++)%20%7B%0A%20%20%20%20if%20(ii%20===%20idx)%20%7B%0A%20%20%20%20%20%20after%20=%201;%0A%20%20%20%20%7D%0A%20%20%20%20newArray%5Bii%5D%20=%20array%5Bii%20+%20after%5D;%0A%20%20%7D%0A%20%20return%20newArray;%0A%7D%0Avar%20MAX_ARRAY_MAP_SIZE%20=%20SIZE%20/%204;%0Avar%20MAX_BITMAP_INDEXED_SIZE%20=%20SIZE%20/%202;%0Avar%20MIN_HASH_ARRAY_MAP_SIZE%20=%20SIZE%20/%204;%0Avar%20IS_LIST_SYMBOL%20=%20'@@__IMMUTABLE_LIST__@@';%0A/**%0A%20*%20True%20if%20%60maybeList%60%20is%20a%20List.%0A%20*/%0Afunction%20isList(maybeList)%20%7B%0A%20%20return%20Boolean(maybeList%20&&%0A%20%20//%20@ts-expect-error:%20maybeList%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeList%20&&%20typeof%20maybeList%20===%20'object'%20&&%20IS_LIST_SYMBOL%20in%20maybeList%60%0A%20%20maybeList%5BIS_LIST_SYMBOL%5D);%0A%7D%0Avar%20List%20=%20/*@__PURE__*/function%20(IndexedCollection)%20%7B%0A%20%20function%20List(value)%20%7B%0A%20%20%20%20var%20empty%20=%20emptyList();%0A%20%20%20%20if%20(value%20===%20undefined%20%7C%7C%20value%20===%20null)%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20return%20empty;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(isList(value))%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20return%20value;%0A%20%20%20%20%7D%0A%20%20%20%20var%20iter%20=%20IndexedCollection(value);%0A%20%20%20%20var%20size%20=%20iter.size;%0A%20%20%20%20if%20(size%20===%200)%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20return%20empty;%0A%20%20%20%20%7D%0A%20%20%20%20assertNotInfinite(size);%0A%20%20%20%20if%20(size%20%3E%200%20&&%20size%20%3C%20SIZE)%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20return%20makeList(0,%20size,%20SHIFT,%20null,%20new%20VNode(iter.toArray()));%0A%20%20%20%20%7D%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20empty.withMutations(function%20(list)%20%7B%0A%20%20%20%20%20%20list.setSize(size);%0A%20%20%20%20%20%20iter.forEach(function%20(v,%20i)%20%7B%0A%20%20%20%20%20%20%20%20return%20list.set(i,%20v);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D%0A%20%20if%20(IndexedCollection)%20List.__proto__%20=%20IndexedCollection;%0A%20%20List.prototype%20=%20Object.create(IndexedCollection%20&&%20IndexedCollection.prototype);%0A%20%20List.prototype.constructor%20=%20List;%0A%20%20List.of%20=%20function%20of(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20return%20this(arguments);%0A%20%20%7D;%0A%20%20List.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('List%20%5B',%20'%5D');%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Access%0A%0A%20%20List.prototype.get%20=%20function%20get(index,%20notSetValue)%20%7B%0A%20%20%20%20index%20=%20wrapIndex(this,%20index);%0A%20%20%20%20if%20(index%20%3E=%200%20&&%20index%20%3C%20this.size)%20%7B%0A%20%20%20%20%20%20index%20+=%20this._origin;%0A%20%20%20%20%20%20var%20node%20=%20listNodeFor(this,%20index);%0A%20%20%20%20%20%20return%20node%20&&%20node.array%5Bindex%20&%20MASK%5D;%0A%20%20%20%20%7D%0A%20%20%20%20return%20notSetValue;%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Modification%0A%0A%20%20List.prototype.set%20=%20function%20set(index,%20value)%20%7B%0A%20%20%20%20return%20updateList(this,%20index,%20value);%0A%20%20%7D;%0A%20%20List.prototype.remove%20=%20function%20remove(index)%20%7B%0A%20%20%20%20return%20!this.has(index)%20?%20this%20:%20index%20===%200%20?%20this.shift()%20:%20index%20===%20this.size%20-%201%20?%20this.pop()%20:%20this.splice(index,%201);%0A%20%20%7D;%0A%20%20List.prototype.insert%20=%20function%20insert(index,%20value)%20%7B%0A%20%20%20%20return%20this.splice(index,%200,%20value);%0A%20%20%7D;%0A%20%20List.prototype.clear%20=%20function%20clear()%20%7B%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.__ownerID)%20%7B%0A%20%20%20%20%20%20this.size%20=%20this._origin%20=%20this._capacity%20=%200;%0A%20%20%20%20%20%20this._level%20=%20SHIFT;%0A%20%20%20%20%20%20this._root%20=%20this._tail%20=%20this.__hash%20=%20undefined;%0A%20%20%20%20%20%20this.__altered%20=%20true;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20emptyList();%0A%20%20%7D;%0A%20%20List.prototype.push%20=%20function%20push(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20var%20values%20=%20arguments;%0A%20%20%20%20var%20oldSize%20=%20this.size;%0A%20%20%20%20return%20this.withMutations(function%20(list)%20%7B%0A%20%20%20%20%20%20setListBounds(list,%200,%20oldSize%20+%20values.length);%0A%20%20%20%20%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20values.length;%20ii++)%20%7B%0A%20%20%20%20%20%20%20%20list.set(oldSize%20+%20ii,%20values%5Bii%5D);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20List.prototype.pop%20=%20function%20pop()%20%7B%0A%20%20%20%20return%20setListBounds(this,%200,%20-1);%0A%20%20%7D;%0A%20%20List.prototype.unshift%20=%20function%20unshift(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20var%20values%20=%20arguments;%0A%20%20%20%20return%20this.withMutations(function%20(list)%20%7B%0A%20%20%20%20%20%20setListBounds(list,%20-values.length);%0A%20%20%20%20%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20values.length;%20ii++)%20%7B%0A%20%20%20%20%20%20%20%20list.set(ii,%20values%5Bii%5D);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20List.prototype.shift%20=%20function%20shift()%20%7B%0A%20%20%20%20return%20setListBounds(this,%201);%0A%20%20%7D;%0A%20%20List.prototype.shuffle%20=%20function%20shuffle(random)%20%7B%0A%20%20%20%20if%20(random%20===%20void%200)%20random%20=%20Math.random;%0A%20%20%20%20return%20this.withMutations(function%20(mutable)%20%7B%0A%20%20%20%20%20%20//%20implementation%20of%20the%20Fisher-Yates%20shuffle:%20https://en.wikipedia.org/wiki/Fisher%25E2%2580%2593Yates_shuffle%0A%20%20%20%20%20%20var%20current%20=%20mutable.size;%0A%20%20%20%20%20%20var%20destination;%0A%20%20%20%20%20%20var%20tmp;%0A%20%20%20%20%20%20while%20(current)%20%7B%0A%20%20%20%20%20%20%20%20destination%20=%20Math.floor(random()%20*%20current--);%0A%20%20%20%20%20%20%20%20tmp%20=%20mutable.get(destination);%0A%20%20%20%20%20%20%20%20mutable.set(destination,%20mutable.get(current));%0A%20%20%20%20%20%20%20%20mutable.set(current,%20tmp);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Composition%0A%0A%20%20List.prototype.concat%20=%20function%20concat(/*...collections*/%0A%20%20)%20%7B%0A%20%20%20%20var%20arguments$1%20=%20arguments;%0A%20%20%20%20var%20seqs%20=%20%5B%5D;%0A%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20arguments.length;%20i++)%20%7B%0A%20%20%20%20%20%20var%20argument%20=%20arguments$1%5Bi%5D;%0A%20%20%20%20%20%20var%20seq%20=%20IndexedCollection(typeof%20argument%20!==%20'string'%20&&%20hasIterator(argument)%20?%20argument%20:%20%5Bargument%5D);%0A%20%20%20%20%20%20if%20(seq.size%20!==%200)%20%7B%0A%20%20%20%20%20%20%20%20seqs.push(seq);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20(seqs.length%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.size%20===%200%20&&%20!this.__ownerID%20&&%20seqs.length%20===%201)%20%7B%0A%20%20%20%20%20%20return%20this.constructor(seqs%5B0%5D);%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.withMutations(function%20(list)%20%7B%0A%20%20%20%20%20%20seqs.forEach(function%20(seq)%20%7B%0A%20%20%20%20%20%20%20%20return%20seq.forEach(function%20(value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20list.push(value);%0A%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20List.prototype.setSize%20=%20function%20setSize(size)%20%7B%0A%20%20%20%20return%20setListBounds(this,%200,%20size);%0A%20%20%7D;%0A%20%20List.prototype.map%20=%20function%20map(mapper,%20context)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20this.withMutations(function%20(list)%20%7B%0A%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20this$1$1.size;%20i++)%20%7B%0A%20%20%20%20%20%20%20%20list.set(i,%20mapper.call(context,%20list.get(i),%20i,%20this$1$1));%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Iteration%0A%0A%20%20List.prototype.slice%20=%20function%20slice(begin,%20end)%20%7B%0A%20%20%20%20var%20size%20=%20this.size;%0A%20%20%20%20if%20(wholeSlice(begin,%20end,%20size))%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20setListBounds(this,%20resolveBegin(begin,%20size),%20resolveEnd(end,%20size));%0A%20%20%7D;%0A%20%20List.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20index%20=%20reverse%20?%20this.size%20:%200;%0A%20%20%20%20var%20values%20=%20iterateList(this,%20reverse);%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20var%20value%20=%20values();%0A%20%20%20%20%20%20return%20value%20===%20DONE%20?%20iteratorDone()%20:%20iteratorValue(type,%20reverse%20?%20--index%20:%20index++,%20value);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20List.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20index%20=%20reverse%20?%20this.size%20:%200;%0A%20%20%20%20var%20values%20=%20iterateList(this,%20reverse);%0A%20%20%20%20var%20value;%0A%20%20%20%20while%20((value%20=%20values())%20!==%20DONE)%20%7B%0A%20%20%20%20%20%20if%20(fn(value,%20reverse%20?%20--index%20:%20index++,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20index;%0A%20%20%7D;%0A%20%20List.prototype.__ensureOwner%20=%20function%20__ensureOwner(ownerID)%20%7B%0A%20%20%20%20if%20(ownerID%20===%20this.__ownerID)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!ownerID)%20%7B%0A%20%20%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20%20%20return%20emptyList();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.__ownerID%20=%20ownerID;%0A%20%20%20%20%20%20this.__altered%20=%20false;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20makeList(this._origin,%20this._capacity,%20this._level,%20this._root,%20this._tail,%20ownerID,%20this.__hash);%0A%20%20%7D;%0A%20%20return%20List;%0A%7D(IndexedCollection);%0AList.isList%20=%20isList;%0Avar%20ListPrototype%20=%20List.prototype;%0AListPrototype%5BIS_LIST_SYMBOL%5D%20=%20true;%0AListPrototype%5BDELETE%5D%20=%20ListPrototype.remove;%0AListPrototype.merge%20=%20ListPrototype.concat;%0AListPrototype.setIn%20=%20setIn;%0AListPrototype.deleteIn%20=%20ListPrototype.removeIn%20=%20deleteIn;%0AListPrototype.update%20=%20update;%0AListPrototype.updateIn%20=%20updateIn;%0AListPrototype.mergeIn%20=%20mergeIn;%0AListPrototype.mergeDeepIn%20=%20mergeDeepIn;%0AListPrototype.withMutations%20=%20withMutations;%0AListPrototype.wasAltered%20=%20wasAltered;%0AListPrototype.asImmutable%20=%20asImmutable;%0AListPrototype%5B'@@transducer/init'%5D%20=%20ListPrototype.asMutable%20=%20asMutable;%0AListPrototype%5B'@@transducer/step'%5D%20=%20function%20(result,%20arr)%20%7B%0A%20%20return%20result.push(arr);%0A%7D;%0AListPrototype%5B'@@transducer/result'%5D%20=%20function%20(obj)%20%7B%0A%20%20return%20obj.asImmutable();%0A%7D;%0Avar%20VNode%20=%20function%20VNode(array,%20ownerID)%20%7B%0A%20%20this.array%20=%20array;%0A%20%20this.ownerID%20=%20ownerID;%0A%7D;%0A%0A//%20TODO:%20seems%20like%20these%20methods%20are%20very%20similar%0A%0AVNode.prototype.removeBefore%20=%20function%20removeBefore(ownerID,%20level,%20index)%20%7B%0A%20%20if%20((index%20&%20(1%20%3C%3C%20level%20+%20SHIFT)%20-%201)%20===%200%20%7C%7C%20this.array.length%20===%200)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20originIndex%20=%20index%20%3E%3E%3E%20level%20&%20MASK;%0A%20%20if%20(originIndex%20%3E=%20this.array.length)%20%7B%0A%20%20%20%20return%20new%20VNode(%5B%5D,%20ownerID);%0A%20%20%7D%0A%20%20var%20removingFirst%20=%20originIndex%20===%200;%0A%20%20var%20newChild;%0A%20%20if%20(level%20%3E%200)%20%7B%0A%20%20%20%20var%20oldChild%20=%20this.array%5BoriginIndex%5D;%0A%20%20%20%20newChild%20=%20oldChild%20&&%20oldChild.removeBefore(ownerID,%20level%20-%20SHIFT,%20index);%0A%20%20%20%20if%20(newChild%20===%20oldChild%20&&%20removingFirst)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20(removingFirst%20&&%20!newChild)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20editable%20=%20editableVNode(this,%20ownerID);%0A%20%20if%20(!removingFirst)%20%7B%0A%20%20%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20originIndex;%20ii++)%20%7B%0A%20%20%20%20%20%20editable.array%5Bii%5D%20=%20undefined;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20(newChild)%20%7B%0A%20%20%20%20editable.array%5BoriginIndex%5D%20=%20newChild;%0A%20%20%7D%0A%20%20return%20editable;%0A%7D;%0AVNode.prototype.removeAfter%20=%20function%20removeAfter(ownerID,%20level,%20index)%20%7B%0A%20%20if%20(index%20===%20(level%20?%201%20%3C%3C%20level%20+%20SHIFT%20:%20SIZE)%20%7C%7C%20this.array.length%20===%200)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20sizeIndex%20=%20index%20-%201%20%3E%3E%3E%20level%20&%20MASK;%0A%20%20if%20(sizeIndex%20%3E=%20this.array.length)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20newChild;%0A%20%20if%20(level%20%3E%200)%20%7B%0A%20%20%20%20var%20oldChild%20=%20this.array%5BsizeIndex%5D;%0A%20%20%20%20newChild%20=%20oldChild%20&&%20oldChild.removeAfter(ownerID,%20level%20-%20SHIFT,%20index);%0A%20%20%20%20if%20(newChild%20===%20oldChild%20&&%20sizeIndex%20===%20this.array.length%20-%201)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20var%20editable%20=%20editableVNode(this,%20ownerID);%0A%20%20editable.array.splice(sizeIndex%20+%201);%0A%20%20if%20(newChild)%20%7B%0A%20%20%20%20editable.array%5BsizeIndex%5D%20=%20newChild;%0A%20%20%7D%0A%20%20return%20editable;%0A%7D;%0Avar%20DONE%20=%20%7B%7D;%0Afunction%20iterateList(list,%20reverse)%20%7B%0A%20%20var%20left%20=%20list._origin;%0A%20%20var%20right%20=%20list._capacity;%0A%20%20var%20tailPos%20=%20getTailOffset(right);%0A%20%20var%20tail%20=%20list._tail;%0A%20%20return%20iterateNodeOrLeaf(list._root,%20list._level,%200);%0A%20%20function%20iterateNodeOrLeaf(node,%20level,%20offset)%20%7B%0A%20%20%20%20return%20level%20===%200%20?%20iterateLeaf(node,%20offset)%20:%20iterateNode(node,%20level,%20offset);%0A%20%20%7D%0A%20%20function%20iterateLeaf(node,%20offset)%20%7B%0A%20%20%20%20var%20array%20=%20offset%20===%20tailPos%20?%20tail%20&&%20tail.array%20:%20node%20&&%20node.array;%0A%20%20%20%20var%20from%20=%20offset%20%3E%20left%20?%200%20:%20left%20-%20offset;%0A%20%20%20%20var%20to%20=%20right%20-%20offset;%0A%20%20%20%20if%20(to%20%3E%20SIZE)%20%7B%0A%20%20%20%20%20%20to%20=%20SIZE;%0A%20%20%20%20%7D%0A%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20if%20(from%20===%20to)%20%7B%0A%20%20%20%20%20%20%20%20return%20DONE;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20idx%20=%20reverse%20?%20--to%20:%20from++;%0A%20%20%20%20%20%20return%20array%20&&%20array%5Bidx%5D;%0A%20%20%20%20%7D;%0A%20%20%7D%0A%20%20function%20iterateNode(node,%20level,%20offset)%20%7B%0A%20%20%20%20var%20values;%0A%20%20%20%20var%20array%20=%20node%20&&%20node.array;%0A%20%20%20%20var%20from%20=%20offset%20%3E%20left%20?%200%20:%20left%20-%20offset%20%3E%3E%20level;%0A%20%20%20%20var%20to%20=%20(right%20-%20offset%20%3E%3E%20level)%20+%201;%0A%20%20%20%20if%20(to%20%3E%20SIZE)%20%7B%0A%20%20%20%20%20%20to%20=%20SIZE;%0A%20%20%20%20%7D%0A%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20while%20(true)%20%7B%0A%20%20%20%20%20%20%20%20if%20(values)%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20value%20=%20values();%0A%20%20%20%20%20%20%20%20%20%20if%20(value%20!==%20DONE)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20value;%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20values%20=%20null;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20(from%20===%20to)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20DONE;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20idx%20=%20reverse%20?%20--to%20:%20from++;%0A%20%20%20%20%20%20%20%20values%20=%20iterateNodeOrLeaf(array%20&&%20array%5Bidx%5D,%20level%20-%20SHIFT,%20offset%20+%20(idx%20%3C%3C%20level));%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D;%0A%20%20%7D%0A%7D%0Afunction%20makeList(origin,%20capacity,%20level,%20root,%20tail,%20ownerID,%20hash)%20%7B%0A%20%20var%20list%20=%20Object.create(ListPrototype);%0A%20%20list.size%20=%20capacity%20-%20origin;%0A%20%20list._origin%20=%20origin;%0A%20%20list._capacity%20=%20capacity;%0A%20%20list._level%20=%20level;%0A%20%20list._root%20=%20root;%0A%20%20list._tail%20=%20tail;%0A%20%20list.__ownerID%20=%20ownerID;%0A%20%20list.__hash%20=%20hash;%0A%20%20list.__altered%20=%20false;%0A%20%20return%20list;%0A%7D%0Afunction%20emptyList()%20%7B%0A%20%20return%20makeList(0,%200,%20SHIFT);%0A%7D%0Afunction%20updateList(list,%20index,%20value)%20%7B%0A%20%20index%20=%20wrapIndex(list,%20index);%0A%20%20if%20(index%20!==%20index)%20%7B%0A%20%20%20%20return%20list;%0A%20%20%7D%0A%20%20if%20(index%20%3E=%20list.size%20%7C%7C%20index%20%3C%200)%20%7B%0A%20%20%20%20return%20list.withMutations(function%20(list)%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20%20%20index%20%3C%200%20?%20setListBounds(list,%20index).set(0,%20value)%20:%20setListBounds(list,%200,%20index%20+%201).set(index,%20value);%0A%20%20%20%20%7D);%0A%20%20%7D%0A%20%20index%20+=%20list._origin;%0A%20%20var%20newTail%20=%20list._tail;%0A%20%20var%20newRoot%20=%20list._root;%0A%20%20var%20didAlter%20=%20MakeRef();%0A%20%20if%20(index%20%3E=%20getTailOffset(list._capacity))%20%7B%0A%20%20%20%20newTail%20=%20updateVNode(newTail,%20list.__ownerID,%200,%20index,%20value,%20didAlter);%0A%20%20%7D%20else%20%7B%0A%20%20%20%20newRoot%20=%20updateVNode(newRoot,%20list.__ownerID,%20list._level,%20index,%20value,%20didAlter);%0A%20%20%7D%0A%20%20if%20(!didAlter.value)%20%7B%0A%20%20%20%20return%20list;%0A%20%20%7D%0A%20%20if%20(list.__ownerID)%20%7B%0A%20%20%20%20list._root%20=%20newRoot;%0A%20%20%20%20list._tail%20=%20newTail;%0A%20%20%20%20list.__hash%20=%20undefined;%0A%20%20%20%20list.__altered%20=%20true;%0A%20%20%20%20return%20list;%0A%20%20%7D%0A%20%20return%20makeList(list._origin,%20list._capacity,%20list._level,%20newRoot,%20newTail);%0A%7D%0Afunction%20updateVNode(node,%20ownerID,%20level,%20index,%20value,%20didAlter)%20%7B%0A%20%20var%20idx%20=%20index%20%3E%3E%3E%20level%20&%20MASK;%0A%20%20var%20nodeHas%20=%20node%20&&%20idx%20%3C%20node.array.length;%0A%20%20if%20(!nodeHas%20&&%20value%20===%20undefined)%20%7B%0A%20%20%20%20return%20node;%0A%20%20%7D%0A%20%20var%20newNode;%0A%20%20if%20(level%20%3E%200)%20%7B%0A%20%20%20%20var%20lowerNode%20=%20node%20&&%20node.array%5Bidx%5D;%0A%20%20%20%20var%20newLowerNode%20=%20updateVNode(lowerNode,%20ownerID,%20level%20-%20SHIFT,%20index,%20value,%20didAlter);%0A%20%20%20%20if%20(newLowerNode%20===%20lowerNode)%20%7B%0A%20%20%20%20%20%20return%20node;%0A%20%20%20%20%7D%0A%20%20%20%20newNode%20=%20editableVNode(node,%20ownerID);%0A%20%20%20%20newNode.array%5Bidx%5D%20=%20newLowerNode;%0A%20%20%20%20return%20newNode;%0A%20%20%7D%0A%20%20if%20(nodeHas%20&&%20node.array%5Bidx%5D%20===%20value)%20%7B%0A%20%20%20%20return%20node;%0A%20%20%7D%0A%20%20if%20(didAlter)%20%7B%0A%20%20%20%20SetRef(didAlter);%0A%20%20%7D%0A%20%20newNode%20=%20editableVNode(node,%20ownerID);%0A%20%20if%20(value%20===%20undefined%20&&%20idx%20===%20newNode.array.length%20-%201)%20%7B%0A%20%20%20%20newNode.array.pop();%0A%20%20%7D%20else%20%7B%0A%20%20%20%20newNode.array%5Bidx%5D%20=%20value;%0A%20%20%7D%0A%20%20return%20newNode;%0A%7D%0Afunction%20editableVNode(node,%20ownerID)%20%7B%0A%20%20if%20(ownerID%20&&%20node%20&&%20ownerID%20===%20node.ownerID)%20%7B%0A%20%20%20%20return%20node;%0A%20%20%7D%0A%20%20return%20new%20VNode(node%20?%20node.array.slice()%20:%20%5B%5D,%20ownerID);%0A%7D%0Afunction%20listNodeFor(list,%20rawIndex)%20%7B%0A%20%20if%20(rawIndex%20%3E=%20getTailOffset(list._capacity))%20%7B%0A%20%20%20%20return%20list._tail;%0A%20%20%7D%0A%20%20if%20(rawIndex%20%3C%201%20%3C%3C%20list._level%20+%20SHIFT)%20%7B%0A%20%20%20%20var%20node%20=%20list._root;%0A%20%20%20%20var%20level%20=%20list._level;%0A%20%20%20%20while%20(node%20&&%20level%20%3E%200)%20%7B%0A%20%20%20%20%20%20node%20=%20node.array%5BrawIndex%20%3E%3E%3E%20level%20&%20MASK%5D;%0A%20%20%20%20%20%20level%20-=%20SHIFT;%0A%20%20%20%20%7D%0A%20%20%20%20return%20node;%0A%20%20%7D%0A%7D%0Afunction%20setListBounds(list,%20begin,%20end)%20%7B%0A%20%20//%20Sanitize%20begin%20&%20end%20using%20this%20shorthand%20for%20ToInt32(argument)%0A%20%20//%20http://www.ecma-international.org/ecma-262/6.0/#sec-toint32%0A%20%20if%20(begin%20!==%20undefined)%20%7B%0A%20%20%20%20begin%20%7C=%200;%0A%20%20%7D%0A%20%20if%20(end%20!==%20undefined)%20%7B%0A%20%20%20%20end%20%7C=%200;%0A%20%20%7D%0A%20%20var%20owner%20=%20list.__ownerID%20%7C%7C%20new%20OwnerID();%0A%20%20var%20oldOrigin%20=%20list._origin;%0A%20%20var%20oldCapacity%20=%20list._capacity;%0A%20%20var%20newOrigin%20=%20oldOrigin%20+%20begin;%0A%20%20var%20newCapacity%20=%20end%20===%20undefined%20?%20oldCapacity%20:%20end%20%3C%200%20?%20oldCapacity%20+%20end%20:%20oldOrigin%20+%20end;%0A%20%20if%20(newOrigin%20===%20oldOrigin%20&&%20newCapacity%20===%20oldCapacity)%20%7B%0A%20%20%20%20return%20list;%0A%20%20%7D%0A%0A%20%20//%20If%20it's%20going%20to%20end%20after%20it%20starts,%20it's%20empty.%0A%20%20if%20(newOrigin%20%3E=%20newCapacity)%20%7B%0A%20%20%20%20return%20list.clear();%0A%20%20%7D%0A%20%20var%20newLevel%20=%20list._level;%0A%20%20var%20newRoot%20=%20list._root;%0A%0A%20%20//%20New%20origin%20might%20need%20creating%20a%20higher%20root.%0A%20%20var%20offsetShift%20=%200;%0A%20%20while%20(newOrigin%20+%20offsetShift%20%3C%200)%20%7B%0A%20%20%20%20newRoot%20=%20new%20VNode(newRoot%20&&%20newRoot.array.length%20?%20%5Bundefined,%20newRoot%5D%20:%20%5B%5D,%20owner);%0A%20%20%20%20newLevel%20+=%20SHIFT;%0A%20%20%20%20offsetShift%20+=%201%20%3C%3C%20newLevel;%0A%20%20%7D%0A%20%20if%20(offsetShift)%20%7B%0A%20%20%20%20newOrigin%20+=%20offsetShift;%0A%20%20%20%20oldOrigin%20+=%20offsetShift;%0A%20%20%20%20newCapacity%20+=%20offsetShift;%0A%20%20%20%20oldCapacity%20+=%20offsetShift;%0A%20%20%7D%0A%20%20var%20oldTailOffset%20=%20getTailOffset(oldCapacity);%0A%20%20var%20newTailOffset%20=%20getTailOffset(newCapacity);%0A%0A%20%20//%20New%20size%20might%20need%20creating%20a%20higher%20root.%0A%20%20while%20(newTailOffset%20%3E=%201%20%3C%3C%20newLevel%20+%20SHIFT)%20%7B%0A%20%20%20%20newRoot%20=%20new%20VNode(newRoot%20&&%20newRoot.array.length%20?%20%5BnewRoot%5D%20:%20%5B%5D,%20owner);%0A%20%20%20%20newLevel%20+=%20SHIFT;%0A%20%20%7D%0A%0A%20%20//%20Locate%20or%20create%20the%20new%20tail.%0A%20%20var%20oldTail%20=%20list._tail;%0A%20%20var%20newTail%20=%20newTailOffset%20%3C%20oldTailOffset%20?%20listNodeFor(list,%20newCapacity%20-%201)%20:%20newTailOffset%20%3E%20oldTailOffset%20?%20new%20VNode(%5B%5D,%20owner)%20:%20oldTail;%0A%0A%20%20//%20Merge%20Tail%20into%20tree.%0A%20%20if%20(oldTail%20&&%20newTailOffset%20%3E%20oldTailOffset%20&&%20newOrigin%20%3C%20oldCapacity%20&&%20oldTail.array.length)%20%7B%0A%20%20%20%20newRoot%20=%20editableVNode(newRoot,%20owner);%0A%20%20%20%20var%20node%20=%20newRoot;%0A%20%20%20%20for%20(var%20level%20=%20newLevel;%20level%20%3E%20SHIFT;%20level%20-=%20SHIFT)%20%7B%0A%20%20%20%20%20%20var%20idx%20=%20oldTailOffset%20%3E%3E%3E%20level%20&%20MASK;%0A%20%20%20%20%20%20node%20=%20node.array%5Bidx%5D%20=%20editableVNode(node.array%5Bidx%5D,%20owner);%0A%20%20%20%20%7D%0A%20%20%20%20node.array%5BoldTailOffset%20%3E%3E%3E%20SHIFT%20&%20MASK%5D%20=%20oldTail;%0A%20%20%7D%0A%0A%20%20//%20If%20the%20size%20has%20been%20reduced,%20there's%20a%20chance%20the%20tail%20needs%20to%20be%20trimmed.%0A%20%20if%20(newCapacity%20%3C%20oldCapacity)%20%7B%0A%20%20%20%20newTail%20=%20newTail%20&&%20newTail.removeAfter(owner,%200,%20newCapacity);%0A%20%20%7D%0A%0A%20%20//%20If%20the%20new%20origin%20is%20within%20the%20tail,%20then%20we%20do%20not%20need%20a%20root.%0A%20%20if%20(newOrigin%20%3E=%20newTailOffset)%20%7B%0A%20%20%20%20newOrigin%20-=%20newTailOffset;%0A%20%20%20%20newCapacity%20-=%20newTailOffset;%0A%20%20%20%20newLevel%20=%20SHIFT;%0A%20%20%20%20newRoot%20=%20null;%0A%20%20%20%20newTail%20=%20newTail%20&&%20newTail.removeBefore(owner,%200,%20newOrigin);%0A%0A%20%20%20%20//%20Otherwise,%20if%20the%20root%20has%20been%20trimmed,%20garbage%20collect.%0A%20%20%7D%20else%20if%20(newOrigin%20%3E%20oldOrigin%20%7C%7C%20newTailOffset%20%3C%20oldTailOffset)%20%7B%0A%20%20%20%20offsetShift%20=%200;%0A%0A%20%20%20%20//%20Identify%20the%20new%20top%20root%20node%20of%20the%20subtree%20of%20the%20old%20root.%0A%20%20%20%20while%20(newRoot)%20%7B%0A%20%20%20%20%20%20var%20beginIndex%20=%20newOrigin%20%3E%3E%3E%20newLevel%20&%20MASK;%0A%20%20%20%20%20%20if%20(beginIndex%20!==%20newTailOffset%20%3E%3E%3E%20newLevel%20&%20MASK)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20(beginIndex)%20%7B%0A%20%20%20%20%20%20%20%20offsetShift%20+=%20(1%20%3C%3C%20newLevel)%20*%20beginIndex;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20newLevel%20-=%20SHIFT;%0A%20%20%20%20%20%20newRoot%20=%20newRoot.array%5BbeginIndex%5D;%0A%20%20%20%20%7D%0A%0A%20%20%20%20//%20Trim%20the%20new%20sides%20of%20the%20new%20root.%0A%20%20%20%20if%20(newRoot%20&&%20newOrigin%20%3E%20oldOrigin)%20%7B%0A%20%20%20%20%20%20newRoot%20=%20newRoot.removeBefore(owner,%20newLevel,%20newOrigin%20-%20offsetShift);%0A%20%20%20%20%7D%0A%20%20%20%20if%20(newRoot%20&&%20newTailOffset%20%3C%20oldTailOffset)%20%7B%0A%20%20%20%20%20%20newRoot%20=%20newRoot.removeAfter(owner,%20newLevel,%20newTailOffset%20-%20offsetShift);%0A%20%20%20%20%7D%0A%20%20%20%20if%20(offsetShift)%20%7B%0A%20%20%20%20%20%20newOrigin%20-=%20offsetShift;%0A%20%20%20%20%20%20newCapacity%20-=%20offsetShift;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20(list.__ownerID)%20%7B%0A%20%20%20%20list.size%20=%20newCapacity%20-%20newOrigin;%0A%20%20%20%20list._origin%20=%20newOrigin;%0A%20%20%20%20list._capacity%20=%20newCapacity;%0A%20%20%20%20list._level%20=%20newLevel;%0A%20%20%20%20list._root%20=%20newRoot;%0A%20%20%20%20list._tail%20=%20newTail;%0A%20%20%20%20list.__hash%20=%20undefined;%0A%20%20%20%20list.__altered%20=%20true;%0A%20%20%20%20return%20list;%0A%20%20%7D%0A%20%20return%20makeList(newOrigin,%20newCapacity,%20newLevel,%20newRoot,%20newTail);%0A%7D%0Afunction%20getTailOffset(size)%20%7B%0A%20%20return%20size%20%3C%20SIZE%20?%200%20:%20size%20-%201%20%3E%3E%3E%20SHIFT%20%3C%3C%20SHIFT;%0A%7D%0Avar%20OrderedMap%20=%20/*@__PURE__*/function%20(Map)%20%7B%0A%20%20function%20OrderedMap(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptyOrderedMap()%20:%20isOrderedMap(value)%20?%20value%20:%20emptyOrderedMap().withMutations(function%20(map)%20%7B%0A%20%20%20%20%20%20var%20iter%20=%20KeyedCollection(value);%0A%20%20%20%20%20%20assertNotInfinite(iter.size);%0A%20%20%20%20%20%20iter.forEach(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20%20%20return%20map.set(k,%20v);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D%0A%20%20if%20(Map)%20OrderedMap.__proto__%20=%20Map;%0A%20%20OrderedMap.prototype%20=%20Object.create(Map%20&&%20Map.prototype);%0A%20%20OrderedMap.prototype.constructor%20=%20OrderedMap;%0A%20%20OrderedMap.of%20=%20function%20of(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20return%20this(arguments);%0A%20%20%7D;%0A%20%20OrderedMap.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('OrderedMap%20%7B',%20'%7D');%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Access%0A%0A%20%20OrderedMap.prototype.get%20=%20function%20get(k,%20notSetValue)%20%7B%0A%20%20%20%20var%20index%20=%20this._map.get(k);%0A%20%20%20%20return%20index%20!==%20undefined%20?%20this._list.get(index)%5B1%5D%20:%20notSetValue;%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Modification%0A%0A%20%20OrderedMap.prototype.clear%20=%20function%20clear()%20%7B%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.__ownerID)%20%7B%0A%20%20%20%20%20%20this.size%20=%200;%0A%20%20%20%20%20%20this._map.clear();%0A%20%20%20%20%20%20this._list.clear();%0A%20%20%20%20%20%20this.__altered%20=%20true;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20emptyOrderedMap();%0A%20%20%7D;%0A%20%20OrderedMap.prototype.set%20=%20function%20set(k,%20v)%20%7B%0A%20%20%20%20return%20updateOrderedMap(this,%20k,%20v);%0A%20%20%7D;%0A%20%20OrderedMap.prototype.remove%20=%20function%20remove(k)%20%7B%0A%20%20%20%20return%20updateOrderedMap(this,%20k,%20NOT_SET);%0A%20%20%7D;%0A%20%20OrderedMap.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20this._list.__iterate(function%20(entry)%20%7B%0A%20%20%20%20%20%20return%20entry%20&&%20fn(entry%5B1%5D,%20entry%5B0%5D,%20this$1$1);%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20OrderedMap.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20return%20this._list.fromEntrySeq().__iterator(type,%20reverse);%0A%20%20%7D;%0A%20%20OrderedMap.prototype.__ensureOwner%20=%20function%20__ensureOwner(ownerID)%20%7B%0A%20%20%20%20if%20(ownerID%20===%20this.__ownerID)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20var%20newMap%20=%20this._map.__ensureOwner(ownerID);%0A%20%20%20%20var%20newList%20=%20this._list.__ensureOwner(ownerID);%0A%20%20%20%20if%20(!ownerID)%20%7B%0A%20%20%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20%20%20return%20emptyOrderedMap();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.__ownerID%20=%20ownerID;%0A%20%20%20%20%20%20this.__altered%20=%20false;%0A%20%20%20%20%20%20this._map%20=%20newMap;%0A%20%20%20%20%20%20this._list%20=%20newList;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20makeOrderedMap(newMap,%20newList,%20ownerID,%20this.__hash);%0A%20%20%7D;%0A%20%20return%20OrderedMap;%0A%7D(Map);%0AOrderedMap.isOrderedMap%20=%20isOrderedMap;%0AOrderedMap.prototype%5BIS_ORDERED_SYMBOL%5D%20=%20true;%0AOrderedMap.prototype%5BDELETE%5D%20=%20OrderedMap.prototype.remove;%0Afunction%20makeOrderedMap(map,%20list,%20ownerID,%20hash)%20%7B%0A%20%20var%20omap%20=%20Object.create(OrderedMap.prototype);%0A%20%20omap.size%20=%20map%20?%20map.size%20:%200;%0A%20%20omap._map%20=%20map;%0A%20%20omap._list%20=%20list;%0A%20%20omap.__ownerID%20=%20ownerID;%0A%20%20omap.__hash%20=%20hash;%0A%20%20omap.__altered%20=%20false;%0A%20%20return%20omap;%0A%7D%0Avar%20EMPTY_ORDERED_MAP;%0Afunction%20emptyOrderedMap()%20%7B%0A%20%20return%20EMPTY_ORDERED_MAP%20%7C%7C%20(EMPTY_ORDERED_MAP%20=%20makeOrderedMap(emptyMap(),%20emptyList()));%0A%7D%0Afunction%20updateOrderedMap(omap,%20k,%20v)%20%7B%0A%20%20var%20map%20=%20omap._map;%0A%20%20var%20list%20=%20omap._list;%0A%20%20var%20i%20=%20map.get(k);%0A%20%20var%20has%20=%20i%20!==%20undefined;%0A%20%20var%20newMap;%0A%20%20var%20newList;%0A%20%20if%20(v%20===%20NOT_SET)%20%7B%0A%20%20%20%20//%20removed%0A%20%20%20%20if%20(!has)%20%7B%0A%20%20%20%20%20%20return%20omap;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(list.size%20%3E=%20SIZE%20&&%20list.size%20%3E=%20map.size%20*%202)%20%7B%0A%20%20%20%20%20%20newList%20=%20list.filter(function%20(entry,%20idx)%20%7B%0A%20%20%20%20%20%20%20%20return%20entry%20!==%20undefined%20&&%20i%20!==%20idx;%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20newMap%20=%20newList.toKeyedSeq().map(function%20(entry)%20%7B%0A%20%20%20%20%20%20%20%20return%20entry%5B0%5D;%0A%20%20%20%20%20%20%7D).flip().toMap();%0A%20%20%20%20%20%20if%20(omap.__ownerID)%20%7B%0A%20%20%20%20%20%20%20%20newMap.__ownerID%20=%20newList.__ownerID%20=%20omap.__ownerID;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20newMap%20=%20map.remove(k);%0A%20%20%20%20%20%20newList%20=%20i%20===%20list.size%20-%201%20?%20list.pop()%20:%20list.set(i,%20undefined);%0A%20%20%20%20%7D%0A%20%20%7D%20else%20if%20(has)%20%7B%0A%20%20%20%20if%20(v%20===%20list.get(i)%5B1%5D)%20%7B%0A%20%20%20%20%20%20return%20omap;%0A%20%20%20%20%7D%0A%20%20%20%20newMap%20=%20map;%0A%20%20%20%20newList%20=%20list.set(i,%20%5Bk,%20v%5D);%0A%20%20%7D%20else%20%7B%0A%20%20%20%20newMap%20=%20map.set(k,%20list.size);%0A%20%20%20%20newList%20=%20list.set(list.size,%20%5Bk,%20v%5D);%0A%20%20%7D%0A%20%20if%20(omap.__ownerID)%20%7B%0A%20%20%20%20omap.size%20=%20newMap.size;%0A%20%20%20%20omap._map%20=%20newMap;%0A%20%20%20%20omap._list%20=%20newList;%0A%20%20%20%20omap.__hash%20=%20undefined;%0A%20%20%20%20omap.__altered%20=%20true;%0A%20%20%20%20return%20omap;%0A%20%20%7D%0A%20%20return%20makeOrderedMap(newMap,%20newList);%0A%7D%0Avar%20IS_STACK_SYMBOL%20=%20'@@__IMMUTABLE_STACK__@@';%0A/**%0A%20*%20True%20if%20%60maybeStack%60%20is%20a%20Stack.%0A%20*/%0Afunction%20isStack(maybeStack)%20%7B%0A%20%20return%20Boolean(maybeStack%20&&%0A%20%20//%20@ts-expect-error:%20maybeStack%20is%20typed%20as%20%60%7B%7D%60,%20need%20to%20change%20in%206.0%20to%20%60maybeStack%20&&%20typeof%20maybeStack%20===%20'object'%20&&%20MAYBE_STACK_SYMBOL%20in%20maybeStack%60%0A%20%20maybeStack%5BIS_STACK_SYMBOL%5D);%0A%7D%0Avar%20Stack%20=%20/*@__PURE__*/function%20(IndexedCollection)%20%7B%0A%20%20function%20Stack(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptyStack()%20:%20isStack(value)%20?%20value%20:%20emptyStack().pushAll(value);%0A%20%20%7D%0A%20%20if%20(IndexedCollection)%20Stack.__proto__%20=%20IndexedCollection;%0A%20%20Stack.prototype%20=%20Object.create(IndexedCollection%20&&%20IndexedCollection.prototype);%0A%20%20Stack.prototype.constructor%20=%20Stack;%0A%20%20Stack.of%20=%20function%20of(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20return%20this(arguments);%0A%20%20%7D;%0A%20%20Stack.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('Stack%20%5B',%20'%5D');%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Access%0A%0A%20%20Stack.prototype.get%20=%20function%20get(index,%20notSetValue)%20%7B%0A%20%20%20%20var%20head%20=%20this._head;%0A%20%20%20%20index%20=%20wrapIndex(this,%20index);%0A%20%20%20%20while%20(head%20&&%20index--)%20%7B%0A%20%20%20%20%20%20head%20=%20head.next;%0A%20%20%20%20%7D%0A%20%20%20%20return%20head%20?%20head.value%20:%20notSetValue;%0A%20%20%7D;%0A%20%20Stack.prototype.peek%20=%20function%20peek()%20%7B%0A%20%20%20%20return%20this._head%20&&%20this._head.value;%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Modification%0A%0A%20%20Stack.prototype.push%20=%20function%20push(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20var%20arguments$1%20=%20arguments;%0A%20%20%20%20if%20(arguments.length%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20var%20newSize%20=%20this.size%20+%20arguments.length;%0A%20%20%20%20var%20head%20=%20this._head;%0A%20%20%20%20for%20(var%20ii%20=%20arguments.length%20-%201;%20ii%20%3E=%200;%20ii--)%20%7B%0A%20%20%20%20%20%20head%20=%20%7B%0A%20%20%20%20%20%20%20%20value:%20arguments$1%5Bii%5D,%0A%20%20%20%20%20%20%20%20next:%20head%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.__ownerID)%20%7B%0A%20%20%20%20%20%20this.size%20=%20newSize;%0A%20%20%20%20%20%20this._head%20=%20head;%0A%20%20%20%20%20%20this.__hash%20=%20undefined;%0A%20%20%20%20%20%20this.__altered%20=%20true;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20makeStack(newSize,%20head);%0A%20%20%7D;%0A%20%20Stack.prototype.pushAll%20=%20function%20pushAll(iter)%20%7B%0A%20%20%20%20iter%20=%20IndexedCollection(iter);%0A%20%20%20%20if%20(iter.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.size%20===%200%20&&%20isStack(iter))%20%7B%0A%20%20%20%20%20%20return%20iter;%0A%20%20%20%20%7D%0A%20%20%20%20assertNotInfinite(iter.size);%0A%20%20%20%20var%20newSize%20=%20this.size;%0A%20%20%20%20var%20head%20=%20this._head;%0A%20%20%20%20iter.__iterate(function%20(value)%20%7B%0A%20%20%20%20%20%20newSize++;%0A%20%20%20%20%20%20head%20=%20%7B%0A%20%20%20%20%20%20%20%20value:%20value,%0A%20%20%20%20%20%20%20%20next:%20head%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%7D,%20/*%20reverse%20*/true);%0A%20%20%20%20if%20(this.__ownerID)%20%7B%0A%20%20%20%20%20%20this.size%20=%20newSize;%0A%20%20%20%20%20%20this._head%20=%20head;%0A%20%20%20%20%20%20this.__hash%20=%20undefined;%0A%20%20%20%20%20%20this.__altered%20=%20true;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20makeStack(newSize,%20head);%0A%20%20%7D;%0A%20%20Stack.prototype.pop%20=%20function%20pop()%20%7B%0A%20%20%20%20return%20this.slice(1);%0A%20%20%7D;%0A%20%20Stack.prototype.clear%20=%20function%20clear()%20%7B%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.__ownerID)%20%7B%0A%20%20%20%20%20%20this.size%20=%200;%0A%20%20%20%20%20%20this._head%20=%20undefined;%0A%20%20%20%20%20%20this.__hash%20=%20undefined;%0A%20%20%20%20%20%20this.__altered%20=%20true;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20emptyStack();%0A%20%20%7D;%0A%20%20Stack.prototype.slice%20=%20function%20slice(begin,%20end)%20%7B%0A%20%20%20%20if%20(wholeSlice(begin,%20end,%20this.size))%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20var%20resolvedBegin%20=%20resolveBegin(begin,%20this.size);%0A%20%20%20%20var%20resolvedEnd%20=%20resolveEnd(end,%20this.size);%0A%20%20%20%20if%20(resolvedEnd%20!==%20this.size)%20%7B%0A%20%20%20%20%20%20//%20super.slice(begin,%20end);%0A%20%20%20%20%20%20return%20IndexedCollection.prototype.slice.call(this,%20begin,%20end);%0A%20%20%20%20%7D%0A%20%20%20%20var%20newSize%20=%20this.size%20-%20resolvedBegin;%0A%20%20%20%20var%20head%20=%20this._head;%0A%20%20%20%20while%20(resolvedBegin--)%20%7B%0A%20%20%20%20%20%20head%20=%20head.next;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.__ownerID)%20%7B%0A%20%20%20%20%20%20this.size%20=%20newSize;%0A%20%20%20%20%20%20this._head%20=%20head;%0A%20%20%20%20%20%20this.__hash%20=%20undefined;%0A%20%20%20%20%20%20this.__altered%20=%20true;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20makeStack(newSize,%20head);%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Mutability%0A%0A%20%20Stack.prototype.__ensureOwner%20=%20function%20__ensureOwner(ownerID)%20%7B%0A%20%20%20%20if%20(ownerID%20===%20this.__ownerID)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!ownerID)%20%7B%0A%20%20%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20%20%20return%20emptyStack();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.__ownerID%20=%20ownerID;%0A%20%20%20%20%20%20this.__altered%20=%20false;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20makeStack(this.size,%20this._head,%20ownerID,%20this.__hash);%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Iteration%0A%0A%20%20Stack.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20new%20ArraySeq(this.toArray()).__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20%20%20return%20fn(v,%20k,%20this$1$1);%0A%20%20%20%20%20%20%7D,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20var%20node%20=%20this._head;%0A%20%20%20%20while%20(node)%20%7B%0A%20%20%20%20%20%20if%20(fn(node.value,%20iterations++,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20node%20=%20node.next;%0A%20%20%20%20%7D%0A%20%20%20%20return%20iterations;%0A%20%20%7D;%0A%20%20Stack.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20if%20(reverse)%20%7B%0A%20%20%20%20%20%20return%20new%20ArraySeq(this.toArray()).__iterator(type,%20reverse);%0A%20%20%20%20%7D%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20var%20node%20=%20this._head;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20if%20(node)%20%7B%0A%20%20%20%20%20%20%20%20var%20value%20=%20node.value;%0A%20%20%20%20%20%20%20%20node%20=%20node.next;%0A%20%20%20%20%20%20%20%20return%20iteratorValue(type,%20iterations++,%20value);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20return%20Stack;%0A%7D(IndexedCollection);%0AStack.isStack%20=%20isStack;%0Avar%20StackPrototype%20=%20Stack.prototype;%0AStackPrototype%5BIS_STACK_SYMBOL%5D%20=%20true;%0AStackPrototype.shift%20=%20StackPrototype.pop;%0AStackPrototype.unshift%20=%20StackPrototype.push;%0AStackPrototype.unshiftAll%20=%20StackPrototype.pushAll;%0AStackPrototype.withMutations%20=%20withMutations;%0AStackPrototype.wasAltered%20=%20wasAltered;%0AStackPrototype.asImmutable%20=%20asImmutable;%0AStackPrototype%5B'@@transducer/init'%5D%20=%20StackPrototype.asMutable%20=%20asMutable;%0AStackPrototype%5B'@@transducer/step'%5D%20=%20function%20(result,%20arr)%20%7B%0A%20%20return%20result.unshift(arr);%0A%7D;%0AStackPrototype%5B'@@transducer/result'%5D%20=%20function%20(obj)%20%7B%0A%20%20return%20obj.asImmutable();%0A%7D;%0Afunction%20makeStack(size,%20head,%20ownerID,%20hash)%20%7B%0A%20%20var%20map%20=%20Object.create(StackPrototype);%0A%20%20map.size%20=%20size;%0A%20%20map._head%20=%20head;%0A%20%20map.__ownerID%20=%20ownerID;%0A%20%20map.__hash%20=%20hash;%0A%20%20map.__altered%20=%20false;%0A%20%20return%20map;%0A%7D%0Avar%20EMPTY_STACK;%0Afunction%20emptyStack()%20%7B%0A%20%20return%20EMPTY_STACK%20%7C%7C%20(EMPTY_STACK%20=%20makeStack(0));%0A%7D%0Avar%20IS_SET_SYMBOL%20=%20'@@__IMMUTABLE_SET__@@';%0A/**%0A%20*%20True%20if%20%60maybeSet%60%20is%20a%20Set.%0A%20*%0A%20*%20Also%20true%20for%20OrderedSets.%0A%20*/%0Afunction%20isSet(maybeSet)%20%7B%0A%20%20return%20Boolean(maybeSet%20&&%0A%20%20//%20@ts-expect-error:%20maybeSet%20is%20typed%20as%20%60%7B%7D%60,%20%20need%20to%20change%20in%206.0%20to%20%60maybeSeq%20&&%20typeof%20maybeSet%20===%20'object'%20&&%20MAYBE_SET_SYMBOL%20in%20maybeSet%60%0A%20%20maybeSet%5BIS_SET_SYMBOL%5D);%0A%7D%0A%0A/**%0A%20*%20True%20if%20%60maybeOrderedSet%60%20is%20an%20OrderedSet.%0A%20*/%0Afunction%20isOrderedSet(maybeOrderedSet)%20%7B%0A%20%20return%20isSet(maybeOrderedSet)%20&&%20isOrdered(maybeOrderedSet);%0A%7D%0Afunction%20deepEqual(a,%20b)%20%7B%0A%20%20if%20(a%20===%20b)%20%7B%0A%20%20%20%20return%20true;%0A%20%20%7D%0A%20%20if%20(!isCollection(b)%20%7C%7C%0A%20%20//%20@ts-expect-error%20size%20should%20exists%20on%20Collection%0A%20%20a.size%20!==%20undefined%20&&%20b.size%20!==%20undefined%20&&%20a.size%20!==%20b.size%20%7C%7C%0A%20%20//%20@ts-expect-error%20__hash%20exists%20on%20Collection%0A%20%20a.__hash%20!==%20undefined%20&&%0A%20%20//%20@ts-expect-error%20__hash%20exists%20on%20Collection%0A%20%20b.__hash%20!==%20undefined%20&&%0A%20%20//%20@ts-expect-error%20__hash%20exists%20on%20Collection%0A%20%20a.__hash%20!==%20b.__hash%20%7C%7C%20isKeyed(a)%20!==%20isKeyed(b)%20%7C%7C%20isIndexed(a)%20!==%20isIndexed(b)%20%7C%7C%0A%20%20//%20@ts-expect-error%20Range%20extends%20Collection,%20which%20implements%20%5BSymbol.iterator%5D,%20so%20it%20is%20valid%0A%20%20isOrdered(a)%20!==%20isOrdered(b))%20%7B%0A%20%20%20%20return%20false;%0A%20%20%7D%0A%20%20//%20@ts-expect-error%20size%20should%20exists%20on%20Collection%0A%20%20if%20(a.size%20===%200%20&&%20b.size%20===%200)%20%7B%0A%20%20%20%20return%20true;%0A%20%20%7D%0A%20%20var%20notAssociative%20=%20!isAssociative(a);%0A%20%20//%20@ts-expect-error%20Range%20extends%20Collection,%20which%20implements%20%5BSymbol.iterator%5D,%20so%20it%20is%20valid%0A%20%20if%20(isOrdered(a))%20%7B%0A%20%20%20%20var%20entries%20=%20a.entries();%0A%20%20%20%20//%20@ts-expect-error%20need%20to%20cast%20as%20boolean%0A%20%20%20%20return%20b.every(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20var%20entry%20=%20entries.next().value;%0A%20%20%20%20%20%20return%20entry%20&&%20is(entry%5B1%5D,%20v)%20&&%20(notAssociative%20%7C%7C%20is(entry%5B0%5D,%20k));%0A%20%20%20%20%7D)%20&&%20entries.next().done;%0A%20%20%7D%0A%20%20var%20flipped%20=%20false;%0A%20%20if%20(a.size%20===%20undefined)%20%7B%0A%20%20%20%20//%20@ts-expect-error%20size%20should%20exists%20on%20Collection%0A%20%20%20%20if%20(b.size%20===%20undefined)%20%7B%0A%20%20%20%20%20%20if%20(typeof%20a.cacheResult%20===%20'function')%20%7B%0A%20%20%20%20%20%20%20%20a.cacheResult();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20flipped%20=%20true;%0A%20%20%20%20%20%20var%20_%20=%20a;%0A%20%20%20%20%20%20a%20=%20b;%0A%20%20%20%20%20%20b%20=%20_;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20var%20allEqual%20=%20true;%0A%20%20var%20bSize%20=%0A%20%20//%20@ts-expect-error%20b%20is%20Range%20%7C%20Repeat%20%7C%20Collection%3Cunknown,%20unknown%3E%20as%20it%20may%20have%20been%20flipped,%20and%20__iterate%20is%20valid%0A%20%20b.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20if%20(notAssociative%20?%0A%20%20%20%20//%20@ts-expect-error%20has%20exists%20on%20Collection%0A%20%20%20%20!a.has(v)%20:%20flipped%20?%0A%20%20%20%20//%20@ts-expect-error%20type%20of%20%60get%60%20does%20not%20%22catch%22%20the%20version%20with%20%60notSetValue%60%0A%20%20%20%20!is(v,%20a.get(k,%20NOT_SET))%20:%0A%20%20%20%20//%20@ts-expect-error%20type%20of%20%60get%60%20does%20not%20%22catch%22%20the%20version%20with%20%60notSetValue%60%0A%20%20%20%20!is(a.get(k,%20NOT_SET),%20v))%20%7B%0A%20%20%20%20%20%20allEqual%20=%20false;%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%7D);%0A%20%20return%20allEqual%20&&%0A%20%20//%20@ts-expect-error%20size%20should%20exists%20on%20Collection%0A%20%20a.size%20===%20bSize;%0A%7D%0A%0A/**%0A%20*%20Contributes%20additional%20methods%20to%20a%20constructor%0A%20*/%0Afunction%20mixin(ctor,%0A//%20eslint-disable-next-line%20@typescript-eslint/no-unsafe-function-type%0Amethods)%20%7B%0A%20%20var%20keyCopier%20=%20function%20keyCopier(key)%20%7B%0A%20%20%20%20//%20@ts-expect-error%20how%20to%20handle%20symbol%20?%0A%20%20%20%20ctor.prototype%5Bkey%5D%20=%20methods%5Bkey%5D;%0A%20%20%7D;%0A%20%20Object.keys(methods).forEach(keyCopier);%0A%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20Object.getOwnPropertySymbols%20&&%20Object.getOwnPropertySymbols(methods).forEach(keyCopier);%0A%20%20return%20ctor;%0A%7D%0Afunction%20toJS(value)%20%7B%0A%20%20if%20(!value%20%7C%7C%20_typeof(value)%20!==%20'object')%20%7B%0A%20%20%20%20return%20value;%0A%20%20%7D%0A%20%20if%20(!isCollection(value))%20%7B%0A%20%20%20%20if%20(!isDataStructure(value))%20%7B%0A%20%20%20%20%20%20return%20value;%0A%20%20%20%20%7D%0A%20%20%20%20value%20=%20Seq(value);%0A%20%20%7D%0A%20%20if%20(isKeyed(value))%20%7B%0A%20%20%20%20var%20result$1%20=%20%7B%7D;%0A%20%20%20%20value.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20result$1%5Bk%5D%20=%20toJS(v);%0A%20%20%20%20%7D);%0A%20%20%20%20return%20result$1;%0A%20%20%7D%0A%20%20var%20result%20=%20%5B%5D;%0A%20%20value.__iterate(function%20(v)%20%7B%0A%20%20%20%20result.push(toJS(v));%0A%20%20%7D);%0A%20%20return%20result;%0A%7D%0Avar%20Set%20=%20/*@__PURE__*/function%20(SetCollection)%20%7B%0A%20%20function%20Set(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptySet()%20:%20isSet(value)%20&&%20!isOrdered(value)%20?%20value%20:%20emptySet().withMutations(function%20(set)%20%7B%0A%20%20%20%20%20%20var%20iter%20=%20SetCollection(value);%0A%20%20%20%20%20%20assertNotInfinite(iter.size);%0A%20%20%20%20%20%20iter.forEach(function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20return%20set.add(v);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D%0A%20%20if%20(SetCollection)%20Set.__proto__%20=%20SetCollection;%0A%20%20Set.prototype%20=%20Object.create(SetCollection%20&&%20SetCollection.prototype);%0A%20%20Set.prototype.constructor%20=%20Set;%0A%20%20Set.of%20=%20function%20of(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20return%20this(arguments);%0A%20%20%7D;%0A%20%20Set.fromKeys%20=%20function%20fromKeys(value)%20%7B%0A%20%20%20%20return%20this(KeyedCollection(value).keySeq());%0A%20%20%7D;%0A%20%20Set.intersect%20=%20function%20intersect(sets)%20%7B%0A%20%20%20%20sets%20=%20Collection(sets).toArray();%0A%20%20%20%20return%20sets.length%20?%20SetPrototype.intersect.apply(Set(sets.pop()),%20sets)%20:%20emptySet();%0A%20%20%7D;%0A%20%20Set.union%20=%20function%20union(sets)%20%7B%0A%20%20%20%20sets%20=%20Collection(sets).toArray();%0A%20%20%20%20return%20sets.length%20?%20SetPrototype.union.apply(Set(sets.pop()),%20sets)%20:%20emptySet();%0A%20%20%7D;%0A%20%20Set.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('Set%20%7B',%20'%7D');%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Access%0A%0A%20%20Set.prototype.has%20=%20function%20has(value)%20%7B%0A%20%20%20%20return%20this._map.has(value);%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Modification%0A%0A%20%20Set.prototype.add%20=%20function%20add(value)%20%7B%0A%20%20%20%20return%20updateSet(this,%20this._map.set(value,%20value));%0A%20%20%7D;%0A%20%20Set.prototype.remove%20=%20function%20remove(value)%20%7B%0A%20%20%20%20return%20updateSet(this,%20this._map.remove(value));%0A%20%20%7D;%0A%20%20Set.prototype.clear%20=%20function%20clear()%20%7B%0A%20%20%20%20return%20updateSet(this,%20this._map.clear());%0A%20%20%7D;%0A%0A%20%20//%20@pragma%20Composition%0A%0A%20%20Set.prototype.map%20=%20function%20map(mapper,%20context)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%0A%20%20%20%20//%20keep%20track%20if%20the%20set%20is%20altered%20by%20the%20map%20function%0A%20%20%20%20var%20didChanges%20=%20false;%0A%20%20%20%20var%20newMap%20=%20updateSet(this,%20this._map.mapEntries(function%20(ref)%20%7B%0A%20%20%20%20%20%20var%20v%20=%20ref%5B1%5D;%0A%20%20%20%20%20%20var%20mapped%20=%20mapper.call(context,%20v,%20v,%20this$1$1);%0A%20%20%20%20%20%20if%20(mapped%20!==%20v)%20%7B%0A%20%20%20%20%20%20%20%20didChanges%20=%20true;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%5Bmapped,%20mapped%5D;%0A%20%20%20%20%7D,%20context));%0A%20%20%20%20return%20didChanges%20?%20newMap%20:%20this;%0A%20%20%7D;%0A%20%20Set.prototype.union%20=%20function%20union()%20%7B%0A%20%20%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20%20%20len%20=%20arguments.length;%0A%20%20%20%20while%20(len--)%20iters%5Blen%5D%20=%20arguments%5Blen%5D;%0A%20%20%20%20iters%20=%20iters.filter(function%20(x)%20%7B%0A%20%20%20%20%20%20return%20x.size%20!==%200;%0A%20%20%20%20%7D);%0A%20%20%20%20if%20(iters.length%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(this.size%20===%200%20&&%20!this.__ownerID%20&&%20iters.length%20===%201)%20%7B%0A%20%20%20%20%20%20return%20this.constructor(iters%5B0%5D);%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.withMutations(function%20(set)%20%7B%0A%20%20%20%20%20%20for%20(var%20ii%20=%200;%20ii%20%3C%20iters.length;%20ii++)%20%7B%0A%20%20%20%20%20%20%20%20if%20(typeof%20iters%5Bii%5D%20===%20'string')%20%7B%0A%20%20%20%20%20%20%20%20%20%20set.add(iters%5Bii%5D);%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20SetCollection(iters%5Bii%5D).forEach(function%20(value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20set.add(value);%0A%20%20%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20Set.prototype.intersect%20=%20function%20intersect()%20%7B%0A%20%20%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20%20%20len%20=%20arguments.length;%0A%20%20%20%20while%20(len--)%20iters%5Blen%5D%20=%20arguments%5Blen%5D;%0A%20%20%20%20if%20(iters.length%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20iters%20=%20iters.map(function%20(iter)%20%7B%0A%20%20%20%20%20%20return%20SetCollection(iter);%0A%20%20%20%20%7D);%0A%20%20%20%20var%20toRemove%20=%20%5B%5D;%0A%20%20%20%20this.forEach(function%20(value)%20%7B%0A%20%20%20%20%20%20if%20(!iters.every(function%20(iter)%20%7B%0A%20%20%20%20%20%20%20%20return%20iter.includes(value);%0A%20%20%20%20%20%20%7D))%20%7B%0A%20%20%20%20%20%20%20%20toRemove.push(value);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20return%20this.withMutations(function%20(set)%20%7B%0A%20%20%20%20%20%20toRemove.forEach(function%20(value)%20%7B%0A%20%20%20%20%20%20%20%20set.remove(value);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20Set.prototype.subtract%20=%20function%20subtract()%20%7B%0A%20%20%20%20var%20iters%20=%20%5B%5D,%0A%20%20%20%20%20%20len%20=%20arguments.length;%0A%20%20%20%20while%20(len--)%20iters%5Blen%5D%20=%20arguments%5Blen%5D;%0A%20%20%20%20if%20(iters.length%20===%200)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20iters%20=%20iters.map(function%20(iter)%20%7B%0A%20%20%20%20%20%20return%20SetCollection(iter);%0A%20%20%20%20%7D);%0A%20%20%20%20var%20toRemove%20=%20%5B%5D;%0A%20%20%20%20this.forEach(function%20(value)%20%7B%0A%20%20%20%20%20%20if%20(iters.some(function%20(iter)%20%7B%0A%20%20%20%20%20%20%20%20return%20iter.includes(value);%0A%20%20%20%20%20%20%7D))%20%7B%0A%20%20%20%20%20%20%20%20toRemove.push(value);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20return%20this.withMutations(function%20(set)%20%7B%0A%20%20%20%20%20%20toRemove.forEach(function%20(value)%20%7B%0A%20%20%20%20%20%20%20%20set.remove(value);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20Set.prototype.sort%20=%20function%20sort(comparator)%20%7B%0A%20%20%20%20//%20Late%20binding%0A%20%20%20%20return%20OrderedSet(sortFactory(this,%20comparator));%0A%20%20%7D;%0A%20%20Set.prototype.sortBy%20=%20function%20sortBy(mapper,%20comparator)%20%7B%0A%20%20%20%20//%20Late%20binding%0A%20%20%20%20return%20OrderedSet(sortFactory(this,%20comparator,%20mapper));%0A%20%20%7D;%0A%20%20Set.prototype.wasAltered%20=%20function%20wasAltered()%20%7B%0A%20%20%20%20return%20this._map.wasAltered();%0A%20%20%7D;%0A%20%20Set.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20this._map.__iterate(function%20(k)%20%7B%0A%20%20%20%20%20%20return%20fn(k,%20k,%20this$1$1);%0A%20%20%20%20%7D,%20reverse);%0A%20%20%7D;%0A%20%20Set.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20return%20this._map.__iterator(type,%20reverse);%0A%20%20%7D;%0A%20%20Set.prototype.__ensureOwner%20=%20function%20__ensureOwner(ownerID)%20%7B%0A%20%20%20%20if%20(ownerID%20===%20this.__ownerID)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20var%20newMap%20=%20this._map.__ensureOwner(ownerID);%0A%20%20%20%20if%20(!ownerID)%20%7B%0A%20%20%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20%20%20return%20this.__empty();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.__ownerID%20=%20ownerID;%0A%20%20%20%20%20%20this._map%20=%20newMap;%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.__make(newMap,%20ownerID);%0A%20%20%7D;%0A%20%20return%20Set;%0A%7D(SetCollection);%0ASet.isSet%20=%20isSet;%0Avar%20SetPrototype%20=%20Set.prototype;%0ASetPrototype%5BIS_SET_SYMBOL%5D%20=%20true;%0ASetPrototype%5BDELETE%5D%20=%20SetPrototype.remove;%0ASetPrototype.merge%20=%20SetPrototype.concat%20=%20SetPrototype.union;%0ASetPrototype.withMutations%20=%20withMutations;%0ASetPrototype.asImmutable%20=%20asImmutable;%0ASetPrototype%5B'@@transducer/init'%5D%20=%20SetPrototype.asMutable%20=%20asMutable;%0ASetPrototype%5B'@@transducer/step'%5D%20=%20function%20(result,%20arr)%20%7B%0A%20%20return%20result.add(arr);%0A%7D;%0ASetPrototype%5B'@@transducer/result'%5D%20=%20function%20(obj)%20%7B%0A%20%20return%20obj.asImmutable();%0A%7D;%0ASetPrototype.__empty%20=%20emptySet;%0ASetPrototype.__make%20=%20makeSet;%0Afunction%20updateSet(set,%20newMap)%20%7B%0A%20%20if%20(set.__ownerID)%20%7B%0A%20%20%20%20set.size%20=%20newMap.size;%0A%20%20%20%20set._map%20=%20newMap;%0A%20%20%20%20return%20set;%0A%20%20%7D%0A%20%20return%20newMap%20===%20set._map%20?%20set%20:%20newMap.size%20===%200%20?%20set.__empty()%20:%20set.__make(newMap);%0A%7D%0Afunction%20makeSet(map,%20ownerID)%20%7B%0A%20%20var%20set%20=%20Object.create(SetPrototype);%0A%20%20set.size%20=%20map%20?%20map.size%20:%200;%0A%20%20set._map%20=%20map;%0A%20%20set.__ownerID%20=%20ownerID;%0A%20%20return%20set;%0A%7D%0Avar%20EMPTY_SET;%0Afunction%20emptySet()%20%7B%0A%20%20return%20EMPTY_SET%20%7C%7C%20(EMPTY_SET%20=%20makeSet(emptyMap()));%0A%7D%0A%0A/**%0A%20*%20Returns%20a%20lazy%20seq%20of%20nums%20from%20start%20(inclusive)%20to%20end%0A%20*%20(exclusive),%20by%20step,%20where%20start%20defaults%20to%200,%20step%20to%201,%20and%20end%20to%0A%20*%20infinity.%20When%20start%20is%20equal%20to%20end,%20returns%20empty%20list.%0A%20*/%0Avar%20Range%20=%20/*@__PURE__*/function%20(IndexedSeq)%20%7B%0A%20%20function%20Range(start,%20end,%20step)%20%7B%0A%20%20%20%20if%20(step%20===%20void%200)%20step%20=%201;%0A%20%20%20%20if%20(!(this%20instanceof%20Range))%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20return%20new%20Range(start,%20end,%20step);%0A%20%20%20%20%7D%0A%20%20%20%20invariant(step%20!==%200,%20'Cannot%20step%20a%20Range%20by%200');%0A%20%20%20%20invariant(start%20!==%20undefined,%20'You%20must%20define%20a%20start%20value%20when%20using%20Range');%0A%20%20%20%20invariant(end%20!==%20undefined,%20'You%20must%20define%20an%20end%20value%20when%20using%20Range');%0A%20%20%20%20step%20=%20Math.abs(step);%0A%20%20%20%20if%20(end%20%3C%20start)%20%7B%0A%20%20%20%20%20%20step%20=%20-step;%0A%20%20%20%20%7D%0A%20%20%20%20this._start%20=%20start;%0A%20%20%20%20this._end%20=%20end;%0A%20%20%20%20this._step%20=%20step;%0A%20%20%20%20this.size%20=%20Math.max(0,%20Math.ceil((end%20-%20start)%20/%20step%20-%201)%20+%201);%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20if%20(EMPTY_RANGE)%20%7B%0A%20%20%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20%20%20return%20EMPTY_RANGE;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-this-alias%0A%20%20%20%20%20%20EMPTY_RANGE%20=%20this;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20(IndexedSeq)%20Range.__proto__%20=%20IndexedSeq;%0A%20%20Range.prototype%20=%20Object.create(IndexedSeq%20&&%20IndexedSeq.prototype);%0A%20%20Range.prototype.constructor%20=%20Range;%0A%20%20Range.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.size%20===%200%20?%20'Range%20%5B%5D'%20:%20%22Range%20%5B%20%22%20+%20this._start%20+%20%22...%22%20+%20this._end%20+%20(this._step%20!==%201%20?%20'%20by%20'%20+%20this._step%20:%20'')%20+%20%22%20%5D%22;%0A%20%20%7D;%0A%20%20Range.prototype.get%20=%20function%20get(index,%20notSetValue)%20%7B%0A%20%20%20%20return%20this.has(index)%20?%20this._start%20+%20wrapIndex(this,%20index)%20*%20this._step%20:%20notSetValue;%0A%20%20%7D;%0A%20%20Range.prototype.includes%20=%20function%20includes(searchValue)%20%7B%0A%20%20%20%20var%20possibleIndex%20=%20(searchValue%20-%20this._start)%20/%20this._step;%0A%20%20%20%20return%20possibleIndex%20%3E=%200%20&&%20possibleIndex%20%3C%20this.size%20&&%20possibleIndex%20===%20Math.floor(possibleIndex);%0A%20%20%7D;%0A%20%20Range.prototype.slice%20=%20function%20slice(begin,%20end)%20%7B%0A%20%20%20%20if%20(wholeSlice(begin,%20end,%20this.size))%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20begin%20=%20resolveBegin(begin,%20this.size);%0A%20%20%20%20end%20=%20resolveEnd(end,%20this.size);%0A%20%20%20%20if%20(end%20%3C=%20begin)%20%7B%0A%20%20%20%20%20%20return%20new%20Range(0,%200);%0A%20%20%20%20%7D%0A%20%20%20%20return%20new%20Range(this.get(begin,%20this._end),%20this.get(end,%20this._end),%20this._step);%0A%20%20%7D;%0A%20%20Range.prototype.indexOf%20=%20function%20indexOf(searchValue)%20%7B%0A%20%20%20%20var%20offsetValue%20=%20searchValue%20-%20this._start;%0A%20%20%20%20if%20(offsetValue%20%25%20this._step%20===%200)%20%7B%0A%20%20%20%20%20%20var%20index%20=%20offsetValue%20/%20this._step;%0A%20%20%20%20%20%20if%20(index%20%3E=%200%20&&%20index%20%3C%20this.size)%20%7B%0A%20%20%20%20%20%20%20%20return%20index;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20-1;%0A%20%20%7D;%0A%20%20Range.prototype.lastIndexOf%20=%20function%20lastIndexOf(searchValue)%20%7B%0A%20%20%20%20return%20this.indexOf(searchValue);%0A%20%20%7D;%0A%20%20Range.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20size%20=%20this.size;%0A%20%20%20%20var%20step%20=%20this._step;%0A%20%20%20%20var%20value%20=%20reverse%20?%20this._start%20+%20(size%20-%201)%20*%20step%20:%20this._start;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20while%20(i%20!==%20size)%20%7B%0A%20%20%20%20%20%20if%20(fn(value,%20reverse%20?%20size%20-%20++i%20:%20i++,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20value%20+=%20reverse%20?%20-step%20:%20step;%0A%20%20%20%20%7D%0A%20%20%20%20return%20i;%0A%20%20%7D;%0A%20%20Range.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20size%20=%20this.size;%0A%20%20%20%20var%20step%20=%20this._step;%0A%20%20%20%20var%20value%20=%20reverse%20?%20this._start%20+%20(size%20-%201)%20*%20step%20:%20this._start;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20if%20(i%20===%20size)%20%7B%0A%20%20%20%20%20%20%20%20return%20iteratorDone();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20v%20=%20value;%0A%20%20%20%20%20%20value%20+=%20reverse%20?%20-step%20:%20step;%0A%20%20%20%20%20%20return%20iteratorValue(type,%20reverse%20?%20size%20-%20++i%20:%20i++,%20v);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20Range.prototype.equals%20=%20function%20equals(other)%20%7B%0A%20%20%20%20return%20other%20instanceof%20Range%20?%20this._start%20===%20other._start%20&&%20this._end%20===%20other._end%20&&%20this._step%20===%20other._step%20:%20deepEqual(this,%20other);%0A%20%20%7D;%0A%20%20return%20Range;%0A%7D(IndexedSeq);%0Avar%20EMPTY_RANGE;%0A%0A/**%0A%20*%20Returns%20the%20value%20at%20the%20provided%20key%20path%20starting%20at%20the%20provided%0A%20*%20collection,%20or%20notSetValue%20if%20the%20key%20path%20is%20not%20defined.%0A%20*%0A%20*%20A%20functional%20alternative%20to%20%60collection.getIn(keypath)%60%20which%20will%20also%0A%20*%20work%20with%20plain%20Objects%20and%20Arrays.%0A%20*%0A%20*%20%3C!--%20runkit:activate%20--%3E%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20getIn%20%7D%20from%20'immutable';%0A%20*%0A%20*%20getIn(%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D,%20%5B'x',%20'y',%20'z'%5D)%20//%20123%0A%20*%20getIn(%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D,%20%5B'x',%20'q',%20'p'%5D,%20'ifNotSet')%20//%20'ifNotSet'%0A%20*%20%60%60%60%0A%20*/%0Afunction%20getIn$1(collection,%20searchKeyPath,%20notSetValue)%20%7B%0A%20%20var%20keyPath%20=%20coerceKeyPath(searchKeyPath);%0A%20%20var%20i%20=%200;%0A%20%20while%20(i%20!==%20keyPath.length)%20%7B%0A%20%20%20%20//%20@ts-expect-error%20keyPath%5Bi++%5D%20can%20not%20be%20undefined%20by%20design%0A%20%20%20%20collection%20=%20get(collection,%20keyPath%5Bi++%5D,%20NOT_SET);%0A%20%20%20%20if%20(collection%20===%20NOT_SET)%20%7B%0A%20%20%20%20%20%20return%20notSetValue;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20collection;%0A%7D%0Afunction%20getIn(searchKeyPath,%20notSetValue)%20%7B%0A%20%20return%20getIn$1(this,%20searchKeyPath,%20notSetValue);%0A%7D%0A%0A/**%0A%20*%20Returns%20true%20if%20the%20key%20path%20is%20defined%20in%20the%20provided%20collection.%0A%20*%0A%20*%20A%20functional%20alternative%20to%20%60collection.hasIn(keypath)%60%20which%20will%20also%0A%20*%20work%20with%20plain%20Objects%20and%20Arrays.%0A%20*%0A%20*%20%3C!--%20runkit:activate%20--%3E%0A%20*%20%60%60%60js%0A%20*%20import%20%7B%20hasIn%20%7D%20from%20'immutable';%0A%20*%0A%20*%20hasIn(%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D,%20%5B'x',%20'y',%20'z'%5D)%20//%20true%0A%20*%20hasIn(%7B%20x:%20%7B%20y:%20%7B%20z:%20123%20%7D%7D%7D,%20%5B'x',%20'q',%20'p'%5D)%20//%20false%0A%20*%20%60%60%60%0A%20*/%0Afunction%20hasIn$1(collection,%20keyPath)%20%7B%0A%20%20return%20getIn$1(collection,%20keyPath,%20NOT_SET)%20!==%20NOT_SET;%0A%7D%0Afunction%20hasIn(searchKeyPath)%20%7B%0A%20%20return%20hasIn$1(this,%20searchKeyPath);%0A%7D%0Afunction%20toObject()%20%7B%0A%20%20assertNotInfinite(this.size);%0A%20%20var%20object%20=%20%7B%7D;%0A%20%20this.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20object%5Bk%5D%20=%20v;%0A%20%20%7D);%0A%20%20return%20object;%0A%7D%0ACollection.Iterator%20=%20Iterator;%0Amixin(Collection,%20%7B%0A%20%20//%20###%20Conversion%20to%20other%20types%0A%0A%20%20toArray:%20function%20toArray()%20%7B%0A%20%20%20%20assertNotInfinite(this.size);%0A%20%20%20%20var%20array%20=%20new%20Array(this.size%20%7C%7C%200);%0A%20%20%20%20var%20useTuples%20=%20isKeyed(this);%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20this.__iterate(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20//%20Keyed%20collections%20produce%20an%20array%20of%20tuples.%0A%20%20%20%20%20%20array%5Bi++%5D%20=%20useTuples%20?%20%5Bk,%20v%5D%20:%20v;%0A%20%20%20%20%7D);%0A%20%20%20%20return%20array;%0A%20%20%7D,%0A%20%20toIndexedSeq:%20function%20toIndexedSeq()%20%7B%0A%20%20%20%20return%20new%20ToIndexedSequence(this);%0A%20%20%7D,%0A%20%20toJS:%20function%20toJS$1()%20%7B%0A%20%20%20%20return%20toJS(this);%0A%20%20%7D,%0A%20%20toKeyedSeq:%20function%20toKeyedSeq()%20%7B%0A%20%20%20%20return%20new%20ToKeyedSequence(this,%20true);%0A%20%20%7D,%0A%20%20toMap:%20function%20toMap()%20%7B%0A%20%20%20%20//%20Use%20Late%20Binding%20here%20to%20solve%20the%20circular%20dependency.%0A%20%20%20%20return%20Map(this.toKeyedSeq());%0A%20%20%7D,%0A%20%20toObject:%20toObject,%0A%20%20toOrderedMap:%20function%20toOrderedMap()%20%7B%0A%20%20%20%20//%20Use%20Late%20Binding%20here%20to%20solve%20the%20circular%20dependency.%0A%20%20%20%20return%20OrderedMap(this.toKeyedSeq());%0A%20%20%7D,%0A%20%20toOrderedSet:%20function%20toOrderedSet()%20%7B%0A%20%20%20%20//%20Use%20Late%20Binding%20here%20to%20solve%20the%20circular%20dependency.%0A%20%20%20%20return%20OrderedSet(isKeyed(this)%20?%20this.valueSeq()%20:%20this);%0A%20%20%7D,%0A%20%20toSet:%20function%20toSet()%20%7B%0A%20%20%20%20//%20Use%20Late%20Binding%20here%20to%20solve%20the%20circular%20dependency.%0A%20%20%20%20return%20Set(isKeyed(this)%20?%20this.valueSeq()%20:%20this);%0A%20%20%7D,%0A%20%20toSetSeq:%20function%20toSetSeq()%20%7B%0A%20%20%20%20return%20new%20ToSetSequence(this);%0A%20%20%7D,%0A%20%20toSeq:%20function%20toSeq()%20%7B%0A%20%20%20%20return%20isIndexed(this)%20?%20this.toIndexedSeq()%20:%20isKeyed(this)%20?%20this.toKeyedSeq()%20:%20this.toSetSeq();%0A%20%20%7D,%0A%20%20toStack:%20function%20toStack()%20%7B%0A%20%20%20%20//%20Use%20Late%20Binding%20here%20to%20solve%20the%20circular%20dependency.%0A%20%20%20%20return%20Stack(isKeyed(this)%20?%20this.valueSeq()%20:%20this);%0A%20%20%7D,%0A%20%20toList:%20function%20toList()%20%7B%0A%20%20%20%20//%20Use%20Late%20Binding%20here%20to%20solve%20the%20circular%20dependency.%0A%20%20%20%20return%20List(isKeyed(this)%20?%20this.valueSeq()%20:%20this);%0A%20%20%7D,%0A%20%20//%20###%20Common%20JavaScript%20methods%20and%20properties%0A%0A%20%20toString:%20function%20toString()%20%7B%0A%20%20%20%20return%20'%5BCollection%5D';%0A%20%20%7D,%0A%20%20__toString:%20function%20__toString(head,%20tail)%20%7B%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20head%20+%20tail;%0A%20%20%20%20%7D%0A%20%20%20%20return%20head%20+%20'%20'%20+%20this.toSeq().map(this.__toStringMapper).join(',%20')%20+%20'%20'%20+%20tail;%0A%20%20%7D,%0A%20%20//%20###%20ES6%20Collection%20methods%20(ES6%20Array%20and%20Map)%0A%0A%20%20concat:%20function%20concat()%20%7B%0A%20%20%20%20var%20values%20=%20%5B%5D,%0A%20%20%20%20%20%20len%20=%20arguments.length;%0A%20%20%20%20while%20(len--)%20values%5Blen%5D%20=%20arguments%5Blen%5D;%0A%20%20%20%20return%20reify(this,%20concatFactory(this,%20values));%0A%20%20%7D,%0A%20%20includes:%20function%20includes(searchValue)%20%7B%0A%20%20%20%20return%20this.some(function%20(value)%20%7B%0A%20%20%20%20%20%20return%20is(value,%20searchValue);%0A%20%20%20%20%7D);%0A%20%20%7D,%0A%20%20entries:%20function%20entries()%20%7B%0A%20%20%20%20return%20this.__iterator(ITERATE_ENTRIES);%0A%20%20%7D,%0A%20%20every:%20function%20every(predicate,%20context)%20%7B%0A%20%20%20%20assertNotInfinite(this.size);%0A%20%20%20%20var%20returnValue%20=%20true;%0A%20%20%20%20this.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20%20%20if%20(!predicate.call(context,%20v,%20k,%20c))%20%7B%0A%20%20%20%20%20%20%20%20returnValue%20=%20false;%0A%20%20%20%20%20%20%20%20return%20false;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20return%20returnValue;%0A%20%20%7D,%0A%20%20filter:%20function%20filter(predicate,%20context)%20%7B%0A%20%20%20%20return%20reify(this,%20filterFactory(this,%20predicate,%20context,%20true));%0A%20%20%7D,%0A%20%20partition:%20function%20partition(predicate,%20context)%20%7B%0A%20%20%20%20return%20partitionFactory(this,%20predicate,%20context);%0A%20%20%7D,%0A%20%20find:%20function%20find(predicate,%20context,%20notSetValue)%20%7B%0A%20%20%20%20var%20entry%20=%20this.findEntry(predicate,%20context);%0A%20%20%20%20return%20entry%20?%20entry%5B1%5D%20:%20notSetValue;%0A%20%20%7D,%0A%20%20forEach:%20function%20forEach(sideEffect,%20context)%20%7B%0A%20%20%20%20assertNotInfinite(this.size);%0A%20%20%20%20return%20this.__iterate(context%20?%20sideEffect.bind(context)%20:%20sideEffect);%0A%20%20%7D,%0A%20%20join:%20function%20join(separator)%20%7B%0A%20%20%20%20assertNotInfinite(this.size);%0A%20%20%20%20separator%20=%20separator%20!==%20undefined%20?%20''%20+%20separator%20:%20',';%0A%20%20%20%20var%20joined%20=%20'';%0A%20%20%20%20var%20isFirst%20=%20true;%0A%20%20%20%20this.__iterate(function%20(v)%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20%20%20isFirst%20?%20isFirst%20=%20false%20:%20joined%20+=%20separator;%0A%20%20%20%20%20%20joined%20+=%20v%20!==%20null%20&&%20v%20!==%20undefined%20?%20v.toString()%20:%20'';%0A%20%20%20%20%7D);%0A%20%20%20%20return%20joined;%0A%20%20%7D,%0A%20%20keys:%20function%20keys()%20%7B%0A%20%20%20%20return%20this.__iterator(ITERATE_KEYS);%0A%20%20%7D,%0A%20%20map:%20function%20map(mapper,%20context)%20%7B%0A%20%20%20%20return%20reify(this,%20mapFactory(this,%20mapper,%20context));%0A%20%20%7D,%0A%20%20reduce:%20function%20reduce$1(reducer,%20initialReduction,%20context)%20%7B%0A%20%20%20%20return%20reduce(this,%20reducer,%20initialReduction,%20context,%20arguments.length%20%3C%202,%20false);%0A%20%20%7D,%0A%20%20reduceRight:%20function%20reduceRight(reducer,%20initialReduction,%20context)%20%7B%0A%20%20%20%20return%20reduce(this,%20reducer,%20initialReduction,%20context,%20arguments.length%20%3C%202,%20true);%0A%20%20%7D,%0A%20%20reverse:%20function%20reverse()%20%7B%0A%20%20%20%20return%20reify(this,%20reverseFactory(this,%20true));%0A%20%20%7D,%0A%20%20slice:%20function%20slice(begin,%20end)%20%7B%0A%20%20%20%20return%20reify(this,%20sliceFactory(this,%20begin,%20end,%20true));%0A%20%20%7D,%0A%20%20some:%20function%20some(predicate,%20context)%20%7B%0A%20%20%20%20assertNotInfinite(this.size);%0A%20%20%20%20var%20returnValue%20=%20false;%0A%20%20%20%20this.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20%20%20if%20(predicate.call(context,%20v,%20k,%20c))%20%7B%0A%20%20%20%20%20%20%20%20returnValue%20=%20true;%0A%20%20%20%20%20%20%20%20return%20false;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20return%20returnValue;%0A%20%20%7D,%0A%20%20sort:%20function%20sort(comparator)%20%7B%0A%20%20%20%20return%20reify(this,%20sortFactory(this,%20comparator));%0A%20%20%7D,%0A%20%20values:%20function%20values()%20%7B%0A%20%20%20%20return%20this.__iterator(ITERATE_VALUES);%0A%20%20%7D,%0A%20%20//%20###%20More%20sequential%20methods%0A%0A%20%20butLast:%20function%20butLast()%20%7B%0A%20%20%20%20return%20this.slice(0,%20-1);%0A%20%20%7D,%0A%20%20isEmpty:%20function%20isEmpty()%20%7B%0A%20%20%20%20return%20this.size%20!==%20undefined%20?%20this.size%20===%200%20:%20!this.some(function%20()%20%7B%0A%20%20%20%20%20%20return%20true;%0A%20%20%20%20%7D);%0A%20%20%7D,%0A%20%20count:%20function%20count(predicate,%20context)%20%7B%0A%20%20%20%20return%20ensureSize(predicate%20?%20this.toSeq().filter(predicate,%20context)%20:%20this);%0A%20%20%7D,%0A%20%20countBy:%20function%20countBy(grouper,%20context)%20%7B%0A%20%20%20%20return%20countByFactory(this,%20grouper,%20context);%0A%20%20%7D,%0A%20%20equals:%20function%20equals(other)%20%7B%0A%20%20%20%20return%20deepEqual(this,%20other);%0A%20%20%7D,%0A%20%20entrySeq:%20function%20entrySeq()%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-this-alias%0A%20%20%20%20var%20collection%20=%20this;%0A%20%20%20%20if%20(collection._cache)%20%7B%0A%20%20%20%20%20%20//%20We%20cache%20as%20an%20entries%20array,%20so%20we%20can%20just%20return%20the%20cache!%0A%20%20%20%20%20%20return%20new%20ArraySeq(collection._cache);%0A%20%20%20%20%7D%0A%20%20%20%20var%20entriesSequence%20=%20collection.toSeq().map(entryMapper).toIndexedSeq();%0A%20%20%20%20entriesSequence.fromEntrySeq%20=%20function%20()%20%7B%0A%20%20%20%20%20%20return%20collection.toSeq();%0A%20%20%20%20%7D;%0A%20%20%20%20return%20entriesSequence;%0A%20%20%7D,%0A%20%20filterNot:%20function%20filterNot(predicate,%20context)%20%7B%0A%20%20%20%20return%20this.filter(not(predicate),%20context);%0A%20%20%7D,%0A%20%20findEntry:%20function%20findEntry(predicate,%20context,%20notSetValue)%20%7B%0A%20%20%20%20var%20found%20=%20notSetValue;%0A%20%20%20%20this.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20%20%20if%20(predicate.call(context,%20v,%20k,%20c))%20%7B%0A%20%20%20%20%20%20%20%20found%20=%20%5Bk,%20v%5D;%0A%20%20%20%20%20%20%20%20return%20false;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20return%20found;%0A%20%20%7D,%0A%20%20findKey:%20function%20findKey(predicate,%20context)%20%7B%0A%20%20%20%20var%20entry%20=%20this.findEntry(predicate,%20context);%0A%20%20%20%20return%20entry%20&&%20entry%5B0%5D;%0A%20%20%7D,%0A%20%20findLast:%20function%20findLast(predicate,%20context,%20notSetValue)%20%7B%0A%20%20%20%20return%20this.toKeyedSeq().reverse().find(predicate,%20context,%20notSetValue);%0A%20%20%7D,%0A%20%20findLastEntry:%20function%20findLastEntry(predicate,%20context,%20notSetValue)%20%7B%0A%20%20%20%20return%20this.toKeyedSeq().reverse().findEntry(predicate,%20context,%20notSetValue);%0A%20%20%7D,%0A%20%20findLastKey:%20function%20findLastKey(predicate,%20context)%20%7B%0A%20%20%20%20return%20this.toKeyedSeq().reverse().findKey(predicate,%20context);%0A%20%20%7D,%0A%20%20first:%20function%20first(notSetValue)%20%7B%0A%20%20%20%20return%20this.find(returnTrue,%20null,%20notSetValue);%0A%20%20%7D,%0A%20%20flatMap:%20function%20flatMap(mapper,%20context)%20%7B%0A%20%20%20%20return%20reify(this,%20flatMapFactory(this,%20mapper,%20context));%0A%20%20%7D,%0A%20%20flatten:%20function%20flatten(depth)%20%7B%0A%20%20%20%20return%20reify(this,%20flattenFactory(this,%20depth,%20true));%0A%20%20%7D,%0A%20%20fromEntrySeq:%20function%20fromEntrySeq()%20%7B%0A%20%20%20%20return%20new%20FromEntriesSequence(this);%0A%20%20%7D,%0A%20%20get:%20function%20get(searchKey,%20notSetValue)%20%7B%0A%20%20%20%20return%20this.find(function%20(_,%20key)%20%7B%0A%20%20%20%20%20%20return%20is(key,%20searchKey);%0A%20%20%20%20%7D,%20undefined,%20notSetValue);%0A%20%20%7D,%0A%20%20getIn:%20getIn,%0A%20%20groupBy:%20function%20groupBy(grouper,%20context)%20%7B%0A%20%20%20%20return%20groupByFactory(this,%20grouper,%20context);%0A%20%20%7D,%0A%20%20has:%20function%20has(searchKey)%20%7B%0A%20%20%20%20return%20this.get(searchKey,%20NOT_SET)%20!==%20NOT_SET;%0A%20%20%7D,%0A%20%20hasIn:%20hasIn,%0A%20%20isSubset:%20function%20isSubset(iter)%20%7B%0A%20%20%20%20iter%20=%20typeof%20iter.includes%20===%20'function'%20?%20iter%20:%20Collection(iter);%0A%20%20%20%20return%20this.every(function%20(value)%20%7B%0A%20%20%20%20%20%20return%20iter.includes(value);%0A%20%20%20%20%7D);%0A%20%20%7D,%0A%20%20isSuperset:%20function%20isSuperset(iter)%20%7B%0A%20%20%20%20iter%20=%20typeof%20iter.isSubset%20===%20'function'%20?%20iter%20:%20Collection(iter);%0A%20%20%20%20return%20iter.isSubset(this);%0A%20%20%7D,%0A%20%20keyOf:%20function%20keyOf(searchValue)%20%7B%0A%20%20%20%20return%20this.findKey(function%20(value)%20%7B%0A%20%20%20%20%20%20return%20is(value,%20searchValue);%0A%20%20%20%20%7D);%0A%20%20%7D,%0A%20%20keySeq:%20function%20keySeq()%20%7B%0A%20%20%20%20return%20this.toSeq().map(keyMapper).toIndexedSeq();%0A%20%20%7D,%0A%20%20last:%20function%20last(notSetValue)%20%7B%0A%20%20%20%20return%20this.toSeq().reverse().first(notSetValue);%0A%20%20%7D,%0A%20%20lastKeyOf:%20function%20lastKeyOf(searchValue)%20%7B%0A%20%20%20%20return%20this.toKeyedSeq().reverse().keyOf(searchValue);%0A%20%20%7D,%0A%20%20max:%20function%20max(comparator)%20%7B%0A%20%20%20%20return%20maxFactory(this,%20comparator);%0A%20%20%7D,%0A%20%20maxBy:%20function%20maxBy(mapper,%20comparator)%20%7B%0A%20%20%20%20return%20maxFactory(this,%20comparator,%20mapper);%0A%20%20%7D,%0A%20%20min:%20function%20min(comparator)%20%7B%0A%20%20%20%20return%20maxFactory(this,%20comparator%20?%20neg(comparator)%20:%20defaultNegComparator);%0A%20%20%7D,%0A%20%20minBy:%20function%20minBy(mapper,%20comparator)%20%7B%0A%20%20%20%20return%20maxFactory(this,%20comparator%20?%20neg(comparator)%20:%20defaultNegComparator,%20mapper);%0A%20%20%7D,%0A%20%20rest:%20function%20rest()%20%7B%0A%20%20%20%20return%20this.slice(1);%0A%20%20%7D,%0A%20%20skip:%20function%20skip(amount)%20%7B%0A%20%20%20%20return%20amount%20===%200%20?%20this%20:%20this.slice(Math.max(0,%20amount));%0A%20%20%7D,%0A%20%20skipLast:%20function%20skipLast(amount)%20%7B%0A%20%20%20%20return%20amount%20===%200%20?%20this%20:%20this.slice(0,%20-Math.max(0,%20amount));%0A%20%20%7D,%0A%20%20skipWhile:%20function%20skipWhile(predicate,%20context)%20%7B%0A%20%20%20%20return%20reify(this,%20skipWhileFactory(this,%20predicate,%20context,%20true));%0A%20%20%7D,%0A%20%20skipUntil:%20function%20skipUntil(predicate,%20context)%20%7B%0A%20%20%20%20return%20this.skipWhile(not(predicate),%20context);%0A%20%20%7D,%0A%20%20sortBy:%20function%20sortBy(mapper,%20comparator)%20%7B%0A%20%20%20%20return%20reify(this,%20sortFactory(this,%20comparator,%20mapper));%0A%20%20%7D,%0A%20%20take:%20function%20take(amount)%20%7B%0A%20%20%20%20return%20this.slice(0,%20Math.max(0,%20amount));%0A%20%20%7D,%0A%20%20takeLast:%20function%20takeLast(amount)%20%7B%0A%20%20%20%20return%20this.slice(-Math.max(0,%20amount));%0A%20%20%7D,%0A%20%20takeWhile:%20function%20takeWhile(predicate,%20context)%20%7B%0A%20%20%20%20return%20reify(this,%20takeWhileFactory(this,%20predicate,%20context));%0A%20%20%7D,%0A%20%20takeUntil:%20function%20takeUntil(predicate,%20context)%20%7B%0A%20%20%20%20return%20this.takeWhile(not(predicate),%20context);%0A%20%20%7D,%0A%20%20update:%20function%20update(fn)%20%7B%0A%20%20%20%20return%20fn(this);%0A%20%20%7D,%0A%20%20valueSeq:%20function%20valueSeq()%20%7B%0A%20%20%20%20return%20this.toIndexedSeq();%0A%20%20%7D,%0A%20%20//%20###%20Hashable%20Object%0A%0A%20%20hashCode:%20function%20hashCode()%20%7B%0A%20%20%20%20return%20this.__hash%20%7C%7C%20(this.__hash%20=%20hashCollection(this));%0A%20%20%7D%0A%0A%20%20//%20###%20Internal%0A%0A%20%20//%20abstract%20__iterate(fn,%20reverse)%0A%0A%20%20//%20abstract%20__iterator(type,%20reverse)%0A%7D);%0Avar%20CollectionPrototype%20=%20Collection.prototype;%0ACollectionPrototype%5BIS_COLLECTION_SYMBOL%5D%20=%20true;%0ACollectionPrototype%5BITERATOR_SYMBOL%5D%20=%20CollectionPrototype.values;%0ACollectionPrototype.toJSON%20=%20CollectionPrototype.toArray;%0ACollectionPrototype.__toStringMapper%20=%20quoteString;%0ACollectionPrototype.inspect%20=%20CollectionPrototype.toSource%20=%20function%20()%20%7B%0A%20%20return%20this.toString();%0A%7D;%0ACollectionPrototype.chain%20=%20CollectionPrototype.flatMap;%0ACollectionPrototype.contains%20=%20CollectionPrototype.includes;%0Amixin(KeyedCollection,%20%7B%0A%20%20//%20###%20More%20sequential%20methods%0A%0A%20%20flip:%20function%20flip()%20%7B%0A%20%20%20%20return%20reify(this,%20flipFactory(this));%0A%20%20%7D,%0A%20%20mapEntries:%20function%20mapEntries(mapper,%20context)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20iterations%20=%200;%0A%20%20%20%20return%20reify(this,%20this.toSeq().map(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20return%20mapper.call(context,%20%5Bk,%20v%5D,%20iterations++,%20this$1$1);%0A%20%20%20%20%7D).fromEntrySeq());%0A%20%20%7D,%0A%20%20mapKeys:%20function%20mapKeys(mapper,%20context)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20return%20reify(this,%20this.toSeq().flip().map(function%20(k,%20v)%20%7B%0A%20%20%20%20%20%20return%20mapper.call(context,%20k,%20v,%20this$1$1);%0A%20%20%20%20%7D).flip());%0A%20%20%7D%0A%7D);%0Avar%20KeyedCollectionPrototype%20=%20KeyedCollection.prototype;%0AKeyedCollectionPrototype%5BIS_KEYED_SYMBOL%5D%20=%20true;%0AKeyedCollectionPrototype%5BITERATOR_SYMBOL%5D%20=%20CollectionPrototype.entries;%0AKeyedCollectionPrototype.toJSON%20=%20toObject;%0AKeyedCollectionPrototype.__toStringMapper%20=%20function%20(v,%20k)%20%7B%0A%20%20return%20quoteString(k)%20+%20':%20'%20+%20quoteString(v);%0A%7D;%0Amixin(IndexedCollection,%20%7B%0A%20%20//%20###%20Conversion%20to%20other%20types%0A%0A%20%20toKeyedSeq:%20function%20toKeyedSeq()%20%7B%0A%20%20%20%20return%20new%20ToKeyedSequence(this,%20false);%0A%20%20%7D,%0A%20%20//%20###%20ES6%20Collection%20methods%20(ES6%20Array%20and%20Map)%0A%0A%20%20filter:%20function%20filter(predicate,%20context)%20%7B%0A%20%20%20%20return%20reify(this,%20filterFactory(this,%20predicate,%20context,%20false));%0A%20%20%7D,%0A%20%20findIndex:%20function%20findIndex(predicate,%20context)%20%7B%0A%20%20%20%20var%20entry%20=%20this.findEntry(predicate,%20context);%0A%20%20%20%20return%20entry%20?%20entry%5B0%5D%20:%20-1;%0A%20%20%7D,%0A%20%20indexOf:%20function%20indexOf(searchValue)%20%7B%0A%20%20%20%20var%20key%20=%20this.keyOf(searchValue);%0A%20%20%20%20return%20key%20===%20undefined%20?%20-1%20:%20key;%0A%20%20%7D,%0A%20%20lastIndexOf:%20function%20lastIndexOf(searchValue)%20%7B%0A%20%20%20%20var%20key%20=%20this.lastKeyOf(searchValue);%0A%20%20%20%20return%20key%20===%20undefined%20?%20-1%20:%20key;%0A%20%20%7D,%0A%20%20reverse:%20function%20reverse()%20%7B%0A%20%20%20%20return%20reify(this,%20reverseFactory(this,%20false));%0A%20%20%7D,%0A%20%20slice:%20function%20slice(begin,%20end)%20%7B%0A%20%20%20%20return%20reify(this,%20sliceFactory(this,%20begin,%20end,%20false));%0A%20%20%7D,%0A%20%20splice:%20function%20splice(index,%20removeNum%20/*,%20...values*/)%20%7B%0A%20%20%20%20var%20numArgs%20=%20arguments.length;%0A%20%20%20%20removeNum%20=%20Math.max(removeNum%20%7C%7C%200,%200);%0A%20%20%20%20if%20(numArgs%20===%200%20%7C%7C%20numArgs%20===%202%20&&%20!removeNum)%20%7B%0A%20%20%20%20%20%20return%20this;%0A%20%20%20%20%7D%0A%20%20%20%20//%20If%20index%20is%20negative,%20it%20should%20resolve%20relative%20to%20the%20size%20of%20the%0A%20%20%20%20//%20collection.%20However%20size%20may%20be%20expensive%20to%20compute%20if%20not%20cached,%20so%0A%20%20%20%20//%20only%20call%20count()%20if%20the%20number%20is%20in%20fact%20negative.%0A%20%20%20%20index%20=%20resolveBegin(index,%20index%20%3C%200%20?%20this.count()%20:%20this.size);%0A%20%20%20%20var%20spliced%20=%20this.slice(0,%20index);%0A%20%20%20%20return%20reify(this,%20numArgs%20===%201%20?%20spliced%20:%20spliced.concat(arrCopy(arguments,%202),%20this.slice(index%20+%20removeNum)));%0A%20%20%7D,%0A%20%20//%20###%20More%20collection%20methods%0A%0A%20%20findLastIndex:%20function%20findLastIndex(predicate,%20context)%20%7B%0A%20%20%20%20var%20entry%20=%20this.findLastEntry(predicate,%20context);%0A%20%20%20%20return%20entry%20?%20entry%5B0%5D%20:%20-1;%0A%20%20%7D,%0A%20%20first:%20function%20first(notSetValue)%20%7B%0A%20%20%20%20return%20this.get(0,%20notSetValue);%0A%20%20%7D,%0A%20%20flatten:%20function%20flatten(depth)%20%7B%0A%20%20%20%20return%20reify(this,%20flattenFactory(this,%20depth,%20false));%0A%20%20%7D,%0A%20%20get:%20function%20get(index,%20notSetValue)%20%7B%0A%20%20%20%20index%20=%20wrapIndex(this,%20index);%0A%20%20%20%20return%20index%20%3C%200%20%7C%7C%20this.size%20===%20Infinity%20%7C%7C%20this.size%20!==%20undefined%20&&%20index%20%3E%20this.size%20?%20notSetValue%20:%20this.find(function%20(_,%20key)%20%7B%0A%20%20%20%20%20%20return%20key%20===%20index;%0A%20%20%20%20%7D,%20undefined,%20notSetValue);%0A%20%20%7D,%0A%20%20has:%20function%20has(index)%20%7B%0A%20%20%20%20index%20=%20wrapIndex(this,%20index);%0A%20%20%20%20return%20index%20%3E=%200%20&&%20(this.size%20!==%20undefined%20?%20this.size%20===%20Infinity%20%7C%7C%20index%20%3C%20this.size%20:%20this.indexOf(index)%20!==%20-1);%0A%20%20%7D,%0A%20%20interpose:%20function%20interpose(separator)%20%7B%0A%20%20%20%20return%20reify(this,%20interposeFactory(this,%20separator));%0A%20%20%7D,%0A%20%20interleave:%20function%20interleave(/*...collections*/%0A%20%20)%20%7B%0A%20%20%20%20var%20collections%20=%20%5Bthis%5D.concat(arrCopy(arguments));%0A%20%20%20%20var%20zipped%20=%20zipWithFactory(this.toSeq(),%20IndexedSeq.of,%20collections);%0A%20%20%20%20var%20interleaved%20=%20zipped.flatten(true);%0A%20%20%20%20if%20(zipped.size)%20%7B%0A%20%20%20%20%20%20interleaved.size%20=%20zipped.size%20*%20collections.length;%0A%20%20%20%20%7D%0A%20%20%20%20return%20reify(this,%20interleaved);%0A%20%20%7D,%0A%20%20keySeq:%20function%20keySeq()%20%7B%0A%20%20%20%20return%20Range(0,%20this.size);%0A%20%20%7D,%0A%20%20last:%20function%20last(notSetValue)%20%7B%0A%20%20%20%20return%20this.get(-1,%20notSetValue);%0A%20%20%7D,%0A%20%20skipWhile:%20function%20skipWhile(predicate,%20context)%20%7B%0A%20%20%20%20return%20reify(this,%20skipWhileFactory(this,%20predicate,%20context,%20false));%0A%20%20%7D,%0A%20%20zip:%20function%20zip(/*,%20...collections%20*/%0A%20%20)%20%7B%0A%20%20%20%20var%20collections%20=%20%5Bthis%5D.concat(arrCopy(arguments));%0A%20%20%20%20return%20reify(this,%20zipWithFactory(this,%20defaultZipper,%20collections));%0A%20%20%7D,%0A%20%20zipAll:%20function%20zipAll(/*,%20...collections%20*/%0A%20%20)%20%7B%0A%20%20%20%20var%20collections%20=%20%5Bthis%5D.concat(arrCopy(arguments));%0A%20%20%20%20return%20reify(this,%20zipWithFactory(this,%20defaultZipper,%20collections,%20true));%0A%20%20%7D,%0A%20%20zipWith:%20function%20zipWith(zipper%20/*,%20...collections%20*/)%20%7B%0A%20%20%20%20var%20collections%20=%20arrCopy(arguments);%0A%20%20%20%20collections%5B0%5D%20=%20this;%0A%20%20%20%20return%20reify(this,%20zipWithFactory(this,%20zipper,%20collections));%0A%20%20%7D%0A%7D);%0Avar%20IndexedCollectionPrototype%20=%20IndexedCollection.prototype;%0AIndexedCollectionPrototype%5BIS_INDEXED_SYMBOL%5D%20=%20true;%0AIndexedCollectionPrototype%5BIS_ORDERED_SYMBOL%5D%20=%20true;%0Amixin(SetCollection,%20%7B%0A%20%20//%20###%20ES6%20Collection%20methods%20(ES6%20Array%20and%20Map)%0A%0A%20%20get:%20function%20get(value,%20notSetValue)%20%7B%0A%20%20%20%20return%20this.has(value)%20?%20value%20:%20notSetValue;%0A%20%20%7D,%0A%20%20includes:%20function%20includes(value)%20%7B%0A%20%20%20%20return%20this.has(value);%0A%20%20%7D,%0A%20%20//%20###%20More%20sequential%20methods%0A%0A%20%20keySeq:%20function%20keySeq()%20%7B%0A%20%20%20%20return%20this.valueSeq();%0A%20%20%7D%0A%7D);%0Avar%20SetCollectionPrototype%20=%20SetCollection.prototype;%0ASetCollectionPrototype.has%20=%20CollectionPrototype.includes;%0ASetCollectionPrototype.contains%20=%20SetCollectionPrototype.includes;%0ASetCollectionPrototype.keys%20=%20SetCollectionPrototype.values;%0A%0A//%20Mixin%20subclasses%0A%0Amixin(KeyedSeq,%20KeyedCollectionPrototype);%0Amixin(IndexedSeq,%20IndexedCollectionPrototype);%0Amixin(SetSeq,%20SetCollectionPrototype);%0A%0A//%20#pragma%20Helper%20functions%0A%0Afunction%20reduce(collection,%20reducer,%20reduction,%20context,%20useFirst,%20reverse)%20%7B%0A%20%20assertNotInfinite(collection.size);%0A%20%20collection.__iterate(function%20(v,%20k,%20c)%20%7B%0A%20%20%20%20if%20(useFirst)%20%7B%0A%20%20%20%20%20%20useFirst%20=%20false;%0A%20%20%20%20%20%20reduction%20=%20v;%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20reduction%20=%20reducer.call(context,%20reduction,%20v,%20k,%20c);%0A%20%20%20%20%7D%0A%20%20%7D,%20reverse);%0A%20%20return%20reduction;%0A%7D%0Afunction%20keyMapper(v,%20k)%20%7B%0A%20%20return%20k;%0A%7D%0Afunction%20entryMapper(v,%20k)%20%7B%0A%20%20return%20%5Bk,%20v%5D;%0A%7D%0Afunction%20not(predicate)%20%7B%0A%20%20return%20function%20()%20%7B%0A%20%20%20%20return%20!predicate.apply(this,%20arguments);%0A%20%20%7D;%0A%7D%0Afunction%20neg(predicate)%20%7B%0A%20%20return%20function%20()%20%7B%0A%20%20%20%20return%20-predicate.apply(this,%20arguments);%0A%20%20%7D;%0A%7D%0Afunction%20defaultZipper()%20%7B%0A%20%20return%20arrCopy(arguments);%0A%7D%0Afunction%20defaultNegComparator(a,%20b)%20%7B%0A%20%20return%20a%20%3C%20b%20?%201%20:%20a%20%3E%20b%20?%20-1%20:%200;%0A%7D%0Afunction%20hashCollection(collection)%20%7B%0A%20%20if%20(collection.size%20===%20Infinity)%20%7B%0A%20%20%20%20return%200;%0A%20%20%7D%0A%20%20var%20ordered%20=%20isOrdered(collection);%0A%20%20var%20keyed%20=%20isKeyed(collection);%0A%20%20var%20h%20=%20ordered%20?%201%20:%200;%0A%20%20collection.__iterate(keyed%20?%20ordered%20?%20function%20(v,%20k)%20%7B%0A%20%20%20%20h%20=%2031%20*%20h%20+%20hashMerge(hash(v),%20hash(k))%20%7C%200;%0A%20%20%7D%20:%20function%20(v,%20k)%20%7B%0A%20%20%20%20h%20=%20h%20+%20hashMerge(hash(v),%20hash(k))%20%7C%200;%0A%20%20%7D%20:%20ordered%20?%20function%20(v)%20%7B%0A%20%20%20%20h%20=%2031%20*%20h%20+%20hash(v)%20%7C%200;%0A%20%20%7D%20:%20function%20(v)%20%7B%0A%20%20%20%20h%20=%20h%20+%20hash(v)%20%7C%200;%0A%20%20%7D);%0A%20%20return%20murmurHashOfSize(collection.size,%20h);%0A%7D%0Afunction%20murmurHashOfSize(size,%20h)%20%7B%0A%20%20h%20=%20imul(h,%200xcc9e2d51);%0A%20%20h%20=%20imul(h%20%3C%3C%2015%20%7C%20h%20%3E%3E%3E%20-15,%200x1b873593);%0A%20%20h%20=%20imul(h%20%3C%3C%2013%20%7C%20h%20%3E%3E%3E%20-13,%205);%0A%20%20h%20=%20(h%20+%200xe6546b64%20%7C%200)%20%5E%20size;%0A%20%20h%20=%20imul(h%20%5E%20h%20%3E%3E%3E%2016,%200x85ebca6b);%0A%20%20h%20=%20imul(h%20%5E%20h%20%3E%3E%3E%2013,%200xc2b2ae35);%0A%20%20h%20=%20smi(h%20%5E%20h%20%3E%3E%3E%2016);%0A%20%20return%20h;%0A%7D%0Afunction%20hashMerge(a,%20b)%20%7B%0A%20%20return%20a%20%5E%20b%20+%200x9e3779b9%20+%20(a%20%3C%3C%206)%20+%20(a%20%3E%3E%202)%20%7C%200;%20//%20int%0A%7D%0Avar%20OrderedSet%20=%20/*@__PURE__*/function%20(Set)%20%7B%0A%20%20function%20OrderedSet(value)%20%7B%0A%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20return%20value%20===%20undefined%20%7C%7C%20value%20===%20null%20?%20emptyOrderedSet()%20:%20isOrderedSet(value)%20?%20value%20:%20emptyOrderedSet().withMutations(function%20(set)%20%7B%0A%20%20%20%20%20%20var%20iter%20=%20SetCollection(value);%0A%20%20%20%20%20%20assertNotInfinite(iter.size);%0A%20%20%20%20%20%20iter.forEach(function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20return%20set.add(v);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%7D%0A%20%20if%20(Set)%20OrderedSet.__proto__%20=%20Set;%0A%20%20OrderedSet.prototype%20=%20Object.create(Set%20&&%20Set.prototype);%0A%20%20OrderedSet.prototype.constructor%20=%20OrderedSet;%0A%20%20OrderedSet.of%20=%20function%20of(/*...values*/%0A%20%20)%20%7B%0A%20%20%20%20return%20this(arguments);%0A%20%20%7D;%0A%20%20OrderedSet.fromKeys%20=%20function%20fromKeys(value)%20%7B%0A%20%20%20%20return%20this(KeyedCollection(value).keySeq());%0A%20%20%7D;%0A%20%20OrderedSet.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20return%20this.__toString('OrderedSet%20%7B',%20'%7D');%0A%20%20%7D;%0A%20%20return%20OrderedSet;%0A%7D(Set);%0AOrderedSet.isOrderedSet%20=%20isOrderedSet;%0Avar%20OrderedSetPrototype%20=%20OrderedSet.prototype;%0AOrderedSetPrototype%5BIS_ORDERED_SYMBOL%5D%20=%20true;%0AOrderedSetPrototype.zip%20=%20IndexedCollectionPrototype.zip;%0AOrderedSetPrototype.zipWith%20=%20IndexedCollectionPrototype.zipWith;%0AOrderedSetPrototype.zipAll%20=%20IndexedCollectionPrototype.zipAll;%0AOrderedSetPrototype.__empty%20=%20emptyOrderedSet;%0AOrderedSetPrototype.__make%20=%20makeOrderedSet;%0Afunction%20makeOrderedSet(map,%20ownerID)%20%7B%0A%20%20var%20set%20=%20Object.create(OrderedSetPrototype);%0A%20%20set.size%20=%20map%20?%20map.size%20:%200;%0A%20%20set._map%20=%20map;%0A%20%20set.__ownerID%20=%20ownerID;%0A%20%20return%20set;%0A%7D%0Avar%20EMPTY_ORDERED_SET;%0Afunction%20emptyOrderedSet()%20%7B%0A%20%20return%20EMPTY_ORDERED_SET%20%7C%7C%20(EMPTY_ORDERED_SET%20=%20makeOrderedSet(emptyOrderedMap()));%0A%7D%0Avar%20PairSorting%20=%20%7B%0A%20%20LeftThenRight:%20-1,%0A%20%20RightThenLeft:%201%0A%7D;%0Afunction%20throwOnInvalidDefaultValues(defaultValues)%20%7B%0A%20%20if%20(isRecord(defaultValues))%20%7B%0A%20%20%20%20throw%20new%20Error('Can%20not%20call%20%60Record%60%20with%20an%20immutable%20Record%20as%20default%20values.%20Use%20a%20plain%20javascript%20object%20instead.');%0A%20%20%7D%0A%20%20if%20(isImmutable(defaultValues))%20%7B%0A%20%20%20%20throw%20new%20Error('Can%20not%20call%20%60Record%60%20with%20an%20immutable%20Collection%20as%20default%20values.%20Use%20a%20plain%20javascript%20object%20instead.');%0A%20%20%7D%0A%20%20if%20(defaultValues%20===%20null%20%7C%7C%20_typeof(defaultValues)%20!==%20'object')%20%7B%0A%20%20%20%20throw%20new%20Error('Can%20not%20call%20%60Record%60%20with%20a%20non-object%20as%20default%20values.%20Use%20a%20plain%20javascript%20object%20instead.');%0A%20%20%7D%0A%7D%0Avar%20Record%20=%20function%20Record(defaultValues,%20name)%20%7B%0A%20%20var%20hasInitialized;%0A%20%20throwOnInvalidDefaultValues(defaultValues);%0A%20%20var%20RecordType%20=%20function%20Record(values)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20if%20(values%20instanceof%20RecordType)%20%7B%0A%20%20%20%20%20%20return%20values;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!(this%20instanceof%20RecordType))%20%7B%0A%20%20%20%20%20%20return%20new%20RecordType(values);%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!hasInitialized)%20%7B%0A%20%20%20%20%20%20hasInitialized%20=%20true;%0A%20%20%20%20%20%20var%20keys%20=%20Object.keys(defaultValues);%0A%20%20%20%20%20%20var%20indices%20=%20RecordTypePrototype._indices%20=%20%7B%7D;%0A%20%20%20%20%20%20//%20Deprecated:%20left%20to%20attempt%20not%20to%20break%20any%20external%20code%20which%0A%20%20%20%20%20%20//%20relies%20on%20a%20._name%20property%20existing%20on%20record%20instances.%0A%20%20%20%20%20%20//%20Use%20Record.getDescriptiveName()%20instead%0A%20%20%20%20%20%20RecordTypePrototype._name%20=%20name;%0A%20%20%20%20%20%20RecordTypePrototype._keys%20=%20keys;%0A%20%20%20%20%20%20RecordTypePrototype._defaultValues%20=%20defaultValues;%0A%20%20%20%20%20%20for%20(var%20i%20=%200;%20i%20%3C%20keys.length;%20i++)%20%7B%0A%20%20%20%20%20%20%20%20var%20propName%20=%20keys%5Bi%5D;%0A%20%20%20%20%20%20%20%20indices%5BpropName%5D%20=%20i;%0A%20%20%20%20%20%20%20%20if%20(RecordTypePrototype%5BpropName%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20/*%20eslint-disable%20no-console%20*/%0A%20%20%20%20%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20%20%20%20%20%20%20(typeof%20console%20===%20%22undefined%22%20?%20%22undefined%22%20:%20_typeof(console))%20===%20'object'%20&&%20console.warn%20&&%20console.warn('Cannot%20define%20'%20+%20recordName(this)%20+%20'%20with%20property%20%22'%20+%20propName%20+%20'%22%20since%20that%20property%20name%20is%20part%20of%20the%20Record%20API.');%0A%20%20%20%20%20%20%20%20%20%20/*%20eslint-enable%20no-console%20*/%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20setProp(RecordTypePrototype,%20propName);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.__ownerID%20=%20undefined;%0A%20%20%20%20this._values%20=%20List().withMutations(function%20(l)%20%7B%0A%20%20%20%20%20%20l.setSize(this$1$1._keys.length);%0A%20%20%20%20%20%20KeyedCollection(values).forEach(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20%20%20l.set(this$1$1._indices%5Bk%5D,%20v%20===%20this$1$1._defaultValues%5Bk%5D%20?%20undefined%20:%20v);%0A%20%20%20%20%20%20%7D);%0A%20%20%20%20%7D);%0A%20%20%20%20return%20this;%0A%20%20%7D;%0A%20%20var%20RecordTypePrototype%20=%20RecordType.prototype%20=%20Object.create(RecordPrototype);%0A%20%20RecordTypePrototype.constructor%20=%20RecordType;%0A%20%20if%20(name)%20%7B%0A%20%20%20%20RecordType.displayName%20=%20name;%0A%20%20%7D%0A%0A%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20return%20RecordType;%0A%7D;%0ARecord.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20var%20str%20=%20recordName(this)%20+%20'%20%7B%20';%0A%20%20var%20keys%20=%20this._keys;%0A%20%20var%20k;%0A%20%20for%20(var%20i%20=%200,%20l%20=%20keys.length;%20i%20!==%20l;%20i++)%20%7B%0A%20%20%20%20k%20=%20keys%5Bi%5D;%0A%20%20%20%20str%20+=%20(i%20?%20',%20'%20:%20'')%20+%20k%20+%20':%20'%20+%20quoteString(this.get(k));%0A%20%20%7D%0A%20%20return%20str%20+%20'%20%7D';%0A%7D;%0ARecord.prototype.equals%20=%20function%20equals(other)%20%7B%0A%20%20return%20this%20===%20other%20%7C%7C%20isRecord(other)%20&&%20recordSeq(this).equals(recordSeq(other));%0A%7D;%0ARecord.prototype.hashCode%20=%20function%20hashCode()%20%7B%0A%20%20return%20recordSeq(this).hashCode();%0A%7D;%0A%0A//%20@pragma%20Access%0A%0ARecord.prototype.has%20=%20function%20has(k)%20%7B%0A%20%20return%20this._indices.hasOwnProperty(k);%0A%7D;%0ARecord.prototype.get%20=%20function%20get(k,%20notSetValue)%20%7B%0A%20%20if%20(!this.has(k))%20%7B%0A%20%20%20%20return%20notSetValue;%0A%20%20%7D%0A%20%20var%20index%20=%20this._indices%5Bk%5D;%0A%20%20var%20value%20=%20this._values.get(index);%0A%20%20return%20value%20===%20undefined%20?%20this._defaultValues%5Bk%5D%20:%20value;%0A%7D;%0A%0A//%20@pragma%20Modification%0A%0ARecord.prototype.set%20=%20function%20set(k,%20v)%20%7B%0A%20%20if%20(this.has(k))%20%7B%0A%20%20%20%20var%20newValues%20=%20this._values.set(this._indices%5Bk%5D,%20v%20===%20this._defaultValues%5Bk%5D%20?%20undefined%20:%20v);%0A%20%20%20%20if%20(newValues%20!==%20this._values%20&&%20!this.__ownerID)%20%7B%0A%20%20%20%20%20%20return%20makeRecord(this,%20newValues);%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20this;%0A%7D;%0ARecord.prototype.remove%20=%20function%20remove(k)%20%7B%0A%20%20return%20this.set(k);%0A%7D;%0ARecord.prototype.clear%20=%20function%20clear()%20%7B%0A%20%20var%20newValues%20=%20this._values.clear().setSize(this._keys.length);%0A%20%20return%20this.__ownerID%20?%20this%20:%20makeRecord(this,%20newValues);%0A%7D;%0ARecord.prototype.wasAltered%20=%20function%20wasAltered()%20%7B%0A%20%20return%20this._values.wasAltered();%0A%7D;%0ARecord.prototype.toSeq%20=%20function%20toSeq()%20%7B%0A%20%20return%20recordSeq(this);%0A%7D;%0ARecord.prototype.toJS%20=%20function%20toJS$1()%20%7B%0A%20%20return%20toJS(this);%0A%7D;%0ARecord.prototype.entries%20=%20function%20entries()%20%7B%0A%20%20return%20this.__iterator(ITERATE_ENTRIES);%0A%7D;%0ARecord.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20return%20recordSeq(this).__iterator(type,%20reverse);%0A%7D;%0ARecord.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20return%20recordSeq(this).__iterate(fn,%20reverse);%0A%7D;%0ARecord.prototype.__ensureOwner%20=%20function%20__ensureOwner(ownerID)%20%7B%0A%20%20if%20(ownerID%20===%20this.__ownerID)%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20var%20newValues%20=%20this._values.__ensureOwner(ownerID);%0A%20%20if%20(!ownerID)%20%7B%0A%20%20%20%20this.__ownerID%20=%20ownerID;%0A%20%20%20%20this._values%20=%20newValues;%0A%20%20%20%20return%20this;%0A%20%20%7D%0A%20%20return%20makeRecord(this,%20newValues,%20ownerID);%0A%7D;%0ARecord.isRecord%20=%20isRecord;%0ARecord.getDescriptiveName%20=%20recordName;%0Avar%20RecordPrototype%20=%20Record.prototype;%0ARecordPrototype%5BIS_RECORD_SYMBOL%5D%20=%20true;%0ARecordPrototype%5BDELETE%5D%20=%20RecordPrototype.remove;%0ARecordPrototype.deleteIn%20=%20RecordPrototype.removeIn%20=%20deleteIn;%0ARecordPrototype.getIn%20=%20getIn;%0ARecordPrototype.hasIn%20=%20CollectionPrototype.hasIn;%0ARecordPrototype.merge%20=%20merge$1;%0ARecordPrototype.mergeWith%20=%20mergeWith$1;%0ARecordPrototype.mergeIn%20=%20mergeIn;%0ARecordPrototype.mergeDeep%20=%20mergeDeep;%0ARecordPrototype.mergeDeepWith%20=%20mergeDeepWith;%0ARecordPrototype.mergeDeepIn%20=%20mergeDeepIn;%0ARecordPrototype.setIn%20=%20setIn;%0ARecordPrototype.update%20=%20update;%0ARecordPrototype.updateIn%20=%20updateIn;%0ARecordPrototype.withMutations%20=%20withMutations;%0ARecordPrototype.asMutable%20=%20asMutable;%0ARecordPrototype.asImmutable%20=%20asImmutable;%0ARecordPrototype%5BITERATOR_SYMBOL%5D%20=%20RecordPrototype.entries;%0ARecordPrototype.toJSON%20=%20RecordPrototype.toObject%20=%20CollectionPrototype.toObject;%0ARecordPrototype.inspect%20=%20RecordPrototype.toSource%20=%20function%20()%20%7B%0A%20%20return%20this.toString();%0A%7D;%0Afunction%20makeRecord(likeRecord,%20values,%20ownerID)%20%7B%0A%20%20var%20record%20=%20Object.create(Object.getPrototypeOf(likeRecord));%0A%20%20record._values%20=%20values;%0A%20%20record.__ownerID%20=%20ownerID;%0A%20%20return%20record;%0A%7D%0Afunction%20recordName(record)%20%7B%0A%20%20return%20record.constructor.displayName%20%7C%7C%20record.constructor.name%20%7C%7C%20'Record';%0A%7D%0Afunction%20recordSeq(record)%20%7B%0A%20%20return%20keyedSeqFromValue(record._keys.map(function%20(k)%20%7B%0A%20%20%20%20return%20%5Bk,%20record.get(k)%5D;%0A%20%20%7D));%0A%7D%0Afunction%20setProp(prototype,%20name)%20%7B%0A%20%20try%20%7B%0A%20%20%20%20Object.defineProperty(prototype,%20name,%20%7B%0A%20%20%20%20%20%20get:%20function%20get()%20%7B%0A%20%20%20%20%20%20%20%20return%20this.get(name);%0A%20%20%20%20%20%20%7D,%0A%20%20%20%20%20%20set:%20function%20set(value)%20%7B%0A%20%20%20%20%20%20%20%20invariant(this.__ownerID,%20'Cannot%20set%20on%20an%20immutable%20record.');%0A%20%20%20%20%20%20%20%20this.set(name,%20value);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D);%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-vars%20--%20TODO%20enable%20eslint%20here%0A%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20//%20Object.defineProperty%20failed.%20Probably%20IE8.%0A%20%20%7D%0A%7D%0A%0A/**%0A%20*%20Returns%20a%20lazy%20Seq%20of%20%60value%60%20repeated%20%60times%60%20times.%20When%20%60times%60%20is%0A%20*%20undefined,%20returns%20an%20infinite%20sequence%20of%20%60value%60.%0A%20*/%0Avar%20Repeat%20=%20/*@__PURE__*/function%20(IndexedSeq)%20%7B%0A%20%20function%20Repeat(value,%20times)%20%7B%0A%20%20%20%20if%20(!(this%20instanceof%20Repeat))%20%7B%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20return%20new%20Repeat(value,%20times);%0A%20%20%20%20%7D%0A%20%20%20%20this._value%20=%20value;%0A%20%20%20%20this.size%20=%20times%20===%20undefined%20?%20Infinity%20:%20Math.max(0,%20times);%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20if%20(EMPTY_REPEAT)%20%7B%0A%20%20%20%20%20%20%20%20//%20eslint-disable-next-line%20no-constructor-return%0A%20%20%20%20%20%20%20%20return%20EMPTY_REPEAT;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-this-alias%0A%20%20%20%20%20%20EMPTY_REPEAT%20=%20this;%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20(IndexedSeq)%20Repeat.__proto__%20=%20IndexedSeq;%0A%20%20Repeat.prototype%20=%20Object.create(IndexedSeq%20&&%20IndexedSeq.prototype);%0A%20%20Repeat.prototype.constructor%20=%20Repeat;%0A%20%20Repeat.prototype.toString%20=%20function%20toString()%20%7B%0A%20%20%20%20if%20(this.size%20===%200)%20%7B%0A%20%20%20%20%20%20return%20'Repeat%20%5B%5D';%0A%20%20%20%20%7D%0A%20%20%20%20return%20'Repeat%20%5B%20'%20+%20this._value%20+%20'%20'%20+%20this.size%20+%20'%20times%20%5D';%0A%20%20%7D;%0A%20%20Repeat.prototype.get%20=%20function%20get(index,%20notSetValue)%20%7B%0A%20%20%20%20return%20this.has(index)%20?%20this._value%20:%20notSetValue;%0A%20%20%7D;%0A%20%20Repeat.prototype.includes%20=%20function%20includes(searchValue)%20%7B%0A%20%20%20%20return%20is(this._value,%20searchValue);%0A%20%20%7D;%0A%20%20Repeat.prototype.slice%20=%20function%20slice(begin,%20end)%20%7B%0A%20%20%20%20var%20size%20=%20this.size;%0A%20%20%20%20return%20wholeSlice(begin,%20end,%20size)%20?%20this%20:%20new%20Repeat(this._value,%20resolveEnd(end,%20size)%20-%20resolveBegin(begin,%20size));%0A%20%20%7D;%0A%20%20Repeat.prototype.reverse%20=%20function%20reverse()%20%7B%0A%20%20%20%20return%20this;%0A%20%20%7D;%0A%20%20Repeat.prototype.indexOf%20=%20function%20indexOf(searchValue)%20%7B%0A%20%20%20%20if%20(is(this._value,%20searchValue))%20%7B%0A%20%20%20%20%20%20return%200;%0A%20%20%20%20%7D%0A%20%20%20%20return%20-1;%0A%20%20%7D;%0A%20%20Repeat.prototype.lastIndexOf%20=%20function%20lastIndexOf(searchValue)%20%7B%0A%20%20%20%20if%20(is(this._value,%20searchValue))%20%7B%0A%20%20%20%20%20%20return%20this.size;%0A%20%20%20%20%7D%0A%20%20%20%20return%20-1;%0A%20%20%7D;%0A%20%20Repeat.prototype.__iterate%20=%20function%20__iterate(fn,%20reverse)%20%7B%0A%20%20%20%20var%20size%20=%20this.size;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20while%20(i%20!==%20size)%20%7B%0A%20%20%20%20%20%20if%20(fn(this._value,%20reverse%20?%20size%20-%20++i%20:%20i++,%20this)%20===%20false)%20%7B%0A%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20i;%0A%20%20%7D;%0A%20%20Repeat.prototype.__iterator%20=%20function%20__iterator(type,%20reverse)%20%7B%0A%20%20%20%20var%20this$1$1%20=%20this;%0A%20%20%20%20var%20size%20=%20this.size;%0A%20%20%20%20var%20i%20=%200;%0A%20%20%20%20return%20new%20Iterator(function%20()%20%7B%0A%20%20%20%20%20%20return%20i%20===%20size%20?%20iteratorDone()%20:%20iteratorValue(type,%20reverse%20?%20size%20-%20++i%20:%20i++,%20this$1$1._value);%0A%20%20%20%20%7D);%0A%20%20%7D;%0A%20%20Repeat.prototype.equals%20=%20function%20equals(other)%20%7B%0A%20%20%20%20return%20other%20instanceof%20Repeat%20?%20is(this._value,%20other._value)%20:%20deepEqual(this,%20other);%0A%20%20%7D;%0A%20%20return%20Repeat;%0A%7D(IndexedSeq);%0Avar%20EMPTY_REPEAT;%0Afunction%20fromJS(value,%20converter)%20%7B%0A%20%20return%20fromJSWith(%5B%5D,%20converter%20%7C%7C%20defaultConverter,%20value,%20'',%20converter%20&&%20converter.length%20%3E%202%20?%20%5B%5D%20:%20undefined,%20%7B%0A%20%20%20%20'':%20value%0A%20%20%7D);%0A%7D%0Afunction%20fromJSWith(stack,%20converter,%20value,%20key,%20keyPath,%20parentValue)%20%7B%0A%20%20if%20(typeof%20value%20!==%20'string'%20&&%20!isImmutable(value)%20&&%20(isArrayLike(value)%20%7C%7C%20hasIterator(value)%20%7C%7C%20isPlainObject(value)))%20%7B%0A%20%20%20%20if%20(~stack.indexOf(value))%20%7B%0A%20%20%20%20%20%20throw%20new%20TypeError('Cannot%20convert%20circular%20structure%20to%20Immutable');%0A%20%20%20%20%7D%0A%20%20%20%20stack.push(value);%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20keyPath%20&&%20key%20!==%20''%20&&%20keyPath.push(key);%0A%20%20%20%20var%20converted%20=%20converter.call(parentValue,%20key,%20Seq(value).map(function%20(v,%20k)%20%7B%0A%20%20%20%20%20%20return%20fromJSWith(stack,%20converter,%20v,%20k,%20keyPath,%20value);%0A%20%20%20%20%7D),%20keyPath%20&&%20keyPath.slice());%0A%20%20%20%20stack.pop();%0A%20%20%20%20//%20eslint-disable-next-line%20@typescript-eslint/no-unused-expressions%20--%20TODO%20enable%20eslint%20here%0A%20%20%20%20keyPath%20&&%20keyPath.pop();%0A%20%20%20%20return%20converted;%0A%20%20%7D%0A%20%20return%20value;%0A%7D%0Afunction%20defaultConverter(k,%20v)%20%7B%0A%20%20//%20Effectively%20the%20opposite%20of%20%22Collection.toSeq()%22%0A%20%20return%20isIndexed(v)%20?%20v.toList()%20:%20isKeyed(v)%20?%20v.toMap()%20:%20v.toSet();%0A%7D%0Avar%20version%20=%20%225.1.2%22;%0A%0A//%20Note:%20Iterable%20is%20deprecated%0Avar%20Iterable%20=%20Collection;%0A%0Avar%20Immutable$1%20=%20/*#__PURE__*/Object.freeze(%7B%0A%20%20__proto__:%20null,%0A%20%20Collection:%20Collection,%0A%20%20Iterable:%20Iterable,%0A%20%20List:%20List,%0A%20%20Map:%20Map,%0A%20%20OrderedMap:%20OrderedMap,%0A%20%20OrderedSet:%20OrderedSet,%0A%20%20PairSorting:%20PairSorting,%0A%20%20Range:%20Range,%0A%20%20Record:%20Record,%0A%20%20Repeat:%20Repeat,%0A%20%20Seq:%20Seq,%0A%20%20Set:%20Set,%0A%20%20Stack:%20Stack,%0A%20%20fromJS:%20fromJS,%0A%20%20get:%20get,%0A%20%20getIn:%20getIn$1,%0A%20%20has:%20has,%0A%20%20hasIn:%20hasIn$1,%0A%20%20hash:%20hash,%0A%20%20is:%20is,%0A%20%20isAssociative:%20isAssociative,%0A%20%20isCollection:%20isCollection,%0A%20%20isImmutable:%20isImmutable,%0A%20%20isIndexed:%20isIndexed,%0A%20%20isKeyed:%20isKeyed,%0A%20%20isList:%20isList,%0A%20%20isMap:%20isMap,%0A%20%20isOrdered:%20isOrdered,%0A%20%20isOrderedMap:%20isOrderedMap,%0A%20%20isOrderedSet:%20isOrderedSet,%0A%20%20isPlainObject:%20isPlainObject,%0A%20%20isRecord:%20isRecord,%0A%20%20isSeq:%20isSeq,%0A%20%20isSet:%20isSet,%0A%20%20isStack:%20isStack,%0A%20%20isValueObject:%20isValueObject,%0A%20%20merge:%20merge,%0A%20%20mergeDeep:%20mergeDeep$1,%0A%20%20mergeDeepWith:%20mergeDeepWith$1,%0A%20%20mergeWith:%20mergeWith,%0A%20%20remove:%20remove,%0A%20%20removeIn:%20removeIn,%0A%20%20set:%20set,%0A%20%20setIn:%20setIn$1,%0A%20%20update:%20update$1,%0A%20%20updateIn:%20updateIn$1,%0A%20%20version:%20version%0A%7D);%0A%0Aif%20(!window.__ImmutableJSDevToolsFormattersInstalled%20===%20true)%20%7B%0A%20%20install(Immutable$1);%0A%20%20window.__ImmutableJSDevToolsFormattersInstalled%20=%20true;%0A%7D%0A")
var parentNode = (document.head || document.documentElement)
parentNode.appendChild(s);
parentNode.removeChild(s);